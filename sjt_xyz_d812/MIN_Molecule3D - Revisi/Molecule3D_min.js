function Molecule3D(){var bv;var T;var ag=new Array({name:"PE3D_min.js"},{name:"AdaptiveFontSize_min.js"});var aq=ag.length;var aC;var an=new Array();var aL=an.length;var N=new Array(aL);var ce="en";var m;this.setLanguage=function(co){ce=co};var a1=false;this.resetStorage=function(co){a1=co};var bZ=true;this.showLoading=function(co){bZ=co};var bf=true;this.setGradasiBola=function(co){bf=co};var bv;var T;this.start=function(cq,cp){bv=cq;T=cp;switch(ce){case"id":m={title:"Geometri Molekul Berdasarkan Teori VSEPR",loadingLibrary:"Sebentar... sedang memuat library ",loadingImage:"Sebentar... sedang memuat gambar/audio ",domainPE:"Domain pasangan elektron (PE):",domainPEB:"Domain pasangan elektron bebas (PEB):",domainPEI:"Domain pasangan elektron terikat (PEI):",geomElektron:"Geometri domain elektron:",geomMolekul:"Geometri molekul:",tampilPEB:"Tampilkan PEB",linear:"Linier|(Linear)",trigonalPlanar:"Segitiga datar|(Trigonal-planar)",bent:"Sudut|(Bent)",tetrahedral:"Tetrahedral|(Tetrahedral)",trigonalPyramidal:"Piramida segitiga|(Trigonal-pyramidal)",bipyramidal:"Bipiramida|(Bipyramidal)",trigonalBipyramidal:"Bipiramida segitiga|(Trigonal-bipyramidal)",seesaw:"Jungkat-jangkit|(Seesaw)",tShaped:"Bentuk T|(T-shaped)",octahedral:"Oktahedral|(Octahedral)",squarePyramidal:"Piramida segiempat|(Square-pyramidal)",squarePlanar:"Segi empat datar|(Square-planar)"};break;case"en":default:m={title:"Molecular Geometry Based on VSEPR Theory",loadingLibrary:"A moment... loading library ",loadingImage:"A moment... loading image/audio ",domainPE:"Electron pair domain:",domainPEB:"Lone pair domain:",domainPEI:"Bonden pair domain:",geomElektron:"Electron domain geometry:",geomMolekul:"Molecular geometry:",linear:"Linear",trigonalPlanar:"Trigonal-planar",bent:"Bent",tetrahedral:"Tetrahedral",trigonalPyramidal:"Trigonal-pyramidal",bipyramidal:"Bipyramidal",trigonalBipyramidal:"Trigonal-bipyramidal",seesaw:"Seesaw",tShaped:"T-shaped",octahedral:"Octahedral",squarePyramidal:"Square-pyramidal",squarePlanar:"Square-planar"};break;case"zh":case"zh-cn":case"zh-sg":m={title:"VSEPR 分子的几何结构",loadingLibrary:"稍等... 函式库装载中 ",loadingImage:"稍等... 图桉档装载中 ",domainPE:"原子总电子对数目:",domainPEB:"未键结电子对数目:",domainPEI:"键结电子对数目:",geomElektron:"电子排列:",geomMolekul:"分子几何结构:",linear:"直线型|(Linear)",trigonalPlanar:"平面三角型|(Trigonal-planar)",bent:"角型|(Bent)",tetrahedral:"四面体|(Tetrahedral)",trigonalPyramidal:"三角锥|(Trigonal-pyramidal)",bipyramidal:"双角锥|(Bipyramidal)",trigonalBipyramidal:"双三角锥|(Trigonal-bipyramidal)",seesaw:"跷跷板形|(Seesaw)",tShaped:"T 字型|(T-shaped)",octahedral:"八面体|(Octahedral)",squarePyramidal:"四角锥|(Square-pyramidal)",squarePlanar:"平面四方型|(Square-planar)"};break;case"zh-tw":case"zh-hk":m={title:"VSEPR 分子的幾何結構",loadingLibrary:"稍等... 函式庫裝載中 ",loadingImage:"稍等... 圖案檔裝載中 ",domainPE:"原子總電子對數目:",domainPEB:"未鍵結電子對數目:",domainPEI:"鍵結電子對數目:",geomElektron:"電子排列:",geomMolekul:"分子幾何結構:",linear:"直線型|(Linear)",trigonalPlanar:"平面三角型|(Trigonal-planar)",bent:"角型|(Bent)",tetrahedral:"四面體|(Tetrahedral)",trigonalPyramidal:"三角錐",bipyramidal:"雙角錐|(Bipyramidal)",trigonalBipyramidal:"雙三角錐|(Trigonal-bipyramidal)",seesaw:"蹺蹺板形|(Seesaw)",tShaped:"T 字型|(T-shaped)",octahedral:"八面體|(Octahedral)",squarePyramidal:"四角錐",squarePlanar:"平面四方型"};break}if(bZ){b2()}if(ag.length==0){bl()}else{for(var co=0;co<ag.length;co++){cl(m.loadingLibrary+(co+1)+"/"+ag.length);bQ(ag[co].name)}}};function bQ(co){var cq=document.createElement("script");cq.type="text/javascript";cq.src=co;cq.onreadystatechange=Q;cq.onload=Q;var cp=document.getElementsByTagName("head").item(0);cp.appendChild(cq)}function Q(){aq--;if(aq==0){bl()}}var ay;var a4;function b2(){var co=document.createElement("style");co.type="text/css";co.innerHTML=".modalDialog { position: fixed; font-family: Arial, Helvetica, sans-serif; top: 0; right: 0; bottom: 0; left: 0; z-index: 99999; opacity:1; -webkit-transition: opacity 400ms ease-in; -moz-transition: opacity 400ms ease-in; transition: opacity 400ms ease-in;} .modalDialog > div { display: table; color:#000000;  width: 60vmin; height: 12vmin; position: absolute; top:0;  bottom:0; left:0; right:0; margin:auto; padding: 0px 2vmin 0px 2vmin; border-radius: 2vmin; border:2px solid #303030; background: #ffffff; text-align:center; box-shadow: 0.3vmin 0.3vmin 0.3vmin rgba(0,0,0,0.5);}";document.body.appendChild(co);ay=document.createElement("div");ay.id="openModal";ay.className="modalDialog";var cp=document.createElement("div");ay.appendChild(cp);a4=document.createElement("p");a4.style.fontSize="2.5vmin";a4.style.display="table-cell";a4.style.verticalAlign="middle";a4.textContent="?";cp.appendChild(a4);document.body.appendChild(ay)}function cl(co){if(typeof a4=="object"){a4.textContent=co}}function S(){if(ay){document.body.removeChild(ay)}}var bX="AE_????????????????";const aJ=Math.PI/2;const W=3*Math.PI/2;const bq=900;const aK=768;var b3;var a8;var ba=1;var bR=1;var w,r;var bB;var cm,bi;var s,cd;var bh,by;var bT=340;var az=340;var U=340;var C=340;var ab=142;var a9=true;function bl(){container=document.getElementById(bv);w=document.createElement("canvas");w.unselectable="on";w.style.zIndex="0";container.appendChild(w);r=w.getContext("2d");w.style.backgroundColor="#000000";s=document.createElement("canvas");s.unselectable="on";s.style.pointerEvents="none";s.style.zIndex="1";container.appendChild(s);cd=s.getContext("2d");bh=document.createElement("canvas");bh.unselectable="on";bh.style.pointerEvents="none";bh.style.zIndex="2";container.appendChild(bh);by=bh.getContext("2d");bB=document.createElement("canvas");bB.unselectable="on";bB.style.pointerEvents="none";bB.width=bT;bB.height=az;buffContext=bB.getContext("2d");cm=document.createElement("canvas");cm.unselectable="on";cm.style.pointerEvents="none";cm.width=U;cm.height=C;bi=cm.getContext("2d");canvasList=[{canvas:w,x:0,y:0,width:bq,height:aK},{canvas:s,x:0,y:aK-ab,width:bq,height:ab},{canvas:bh,x:0,y:aK-ab,width:bq,height:ab}];F(canvasList);if(aL==0){aZ()}else{aC=aL;for(var co=0;co<aL;co++){cl(m.loadingImage+(co+1)+"/"+aL);switch(an[co].type){case"image":N[an[co].index]=new Image();N[an[co].index].addEventListener("load",aF,false);N[an[co].index].src="images/"+an[co].name;break;case"audio":N[an[co].index]=new Audio();N[an[co].index].addEventListener("loadeddata",aF,false);N[an[co].index].src="audios/"+an[co].name;N[an[co].index].type="audio/mpeg";break}}}}function aF(){aC--;if(aC==0){aZ()}}var cj=0;var O=0;var aD=0;var k=false;var ca=false;var aG=2;var aa=0;var f=bq/2;var c=aK/2+20;const B=Math.PI/180;function aZ(){S();a9=false;try{var co=r.globalCompositeOperation;r.globalCompositeOperation="screen";a9=(r.globalCompositeOperation=="screen");r.globalCompositeOperation=co}catch(cp){}window.addEventListener("resize",bW,false);container.addEventListener("touchstart",I,false);w.addEventListener("mousedown",aX,true);w.addEventListener("touchstart",bN,true);aI();t();b9();am(aG,aa);ak();e();bo();ap(aG,aa);k=true;bA()}function br(co){}function I(cp){if(!cp){var cp=window.event}var cr=cp.targetTouches[0];var co=(cr.pageX-b3.x)/ba;var cq=(cr.pageY-b3.y)/bR;if(co>=0&&co<bq&&cq>=0&&cq<aK){cp.preventDefault();cp.stopPropagation()}}function b4(co,cq){try{if(typeof(Storage)!=="undefined"){localStorage.setItem(co,cq)}}catch(cp){}}window.requestAnimFrame=(function(co){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(cp){window.setTimeout(cp,1000/60)}})();window.cancelRequestAnimFrame=(function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout})();var aj=0;var g;function bA(){if(k){aY()}if(!ca&&!(b8||bL)&&(cj!=0||O!=0||aD!=0)){sxRot=cj;syRot=O;szRot=aD;cj=0;O=0;aD=0;var cq=Math.max(sxRot,syRot,szRot);var cr=Math.abs(Math.min(sxRot,syRot,szRot));tMax=Math.min(1500,1000*(cr>cq?cr:cq));aj=new Date().getTime();ca=true}if(ca){var co=new Date().getTime()-aj;if(co>tMax){cj=0;O=0;aD=0;ca=false}else{var cp=Math.sin(aJ*co/tMax);cj=sxRot-cp*sxRot;O=syRot-cp*syRot;aD=szRot-cp*szRot;aY()}}cj=ac(cj);O=ac(O);aD=ac(aD);g=requestAnimFrame(bA)}function ac(co){co=co/2;if(Math.abs(co)<0.0001){co=0}return co}function ak(){var co=r;var cp=40;co.beginPath();co.rect(0,0,bq,cp);co.fillStyle="#404040";co.fill();co.font=AdaptiveFontSize.fix("18pt serif");co.textBaseline="middle";co.textAlign="center";co.fillStyle="#ffffff";co.fillText(m.title,bq/2,cp/2)}function ap(co,cr){var cq=r;var cu=aK-205;var ct=30;cq.clearRect(0,cu,bq,ct+20);const cp="₀₁₂₃₄₅₆₇₈₉";PEI=co-cr;var cs;if(cr==0){cs="AX"+cp[PEI]}else{cs="AX"+cp[PEI]+"E"+cp[cr]}cq.font=AdaptiveFontSize.fix("26pt serif");cq.textBaseline="middle";cq.textAlign="center";cq.fillStyle="#ffffff";cq.fillText(cs,bq/2,cu+ct/2)}var b6;var aO;function e(){var co=r;var cp=bq/2;var cx=65;var cv=35;var cs=35;co.clearRect(0,cx-4,bq,cs*3+20);b6=new Array();aO=new Array();var cq=aG-2;var cw;var cu,ct;ct=cx;co.font=AdaptiveFontSize.fix("16pt serif");co.textBaseline="middle";co.textAlign="center";for(var cr=0;cr<5;cr++){cu=cp+cv*cr;co.beginPath();if(cr==cq){co.rect(cu,ct,cv-1,cs);co.moveTo(cu,ct);co.lineTo(cu+cv-1,ct);co.lineTo(cu+cv-1,ct+cs);co.lineTo(cu+cv/2,ct+cs+8);co.lineTo(cu,ct+cs);co.closePath();co.fillStyle="#ffb000"}else{co.rect(cu,ct,cv-1,cs);co.fillStyle="#606060"}co.fill();co.fillStyle=(cr==cq)?"#000000":"#a0a0a0";co.fillText(cr+2,cu+cv/2,ct+cs/2);b6.push({x1:cu,y1:ct,x2:cu+cv,y2:ct+cs,peb:au[cr].length})}ct=cx+cs+13;var cy=(cq+0.5)*cv-cv*au[cq].length/2;for(var cr=0;cr<au[cq].length;cr++){cw=au[cq][cr].PEB;cu=cp+cv*cr+cy;if(cw==(aa)){co.beginPath();co.rect(cu,ct,cv-1,cs+1);co.fillStyle="#5080a0";co.fill();co.beginPath();co.rect(cu,ct+cs,cv-1,cs);co.fillStyle="#c0c0c0";co.fill()}else{co.beginPath();co.rect(cu,ct,cv-1,2*cs);co.fillStyle="#606060";co.fill()}co.fillStyle=(cw==(aa))?"#000000":"#a0a0a0";co.fillText(cw,cu+cv/2,ct+cs/2);co.fillText(aG-cw,cu+cv/2,ct+cs+cs/2);aO.push({x1:cu,y1:ct,x2:cu+cv,y2:ct+2*cs,peb:cw})}var ct=cx+cs/2;co.font=AdaptiveFontSize.fix("16pt serif");co.textBaseline="middle";co.textAlign="right";co.fillStyle="#b0b0b0";co.fillText(m.domainPE,cp-20,ct);ct=cx+cs/2+cs+13;co.fillText(m.domainPEB,cp-20+cy,ct);ct+=cs;co.fillText(m.domainPEI,cp-20+cy,ct)}var ad=new Array();function bG(cq,co,ct,cr,cp,cs){cq.clearRect(co-12,ct-12,24,24);if(cr){cq.lineWidth=2;cq.strokeStyle="#ffffff";cq.beginPath();cq.moveTo(co-10+4,ct-1);cq.lineTo(co-10+8,ct+5);cq.lineTo(co-10+16,ct-6);cq.stroke()}cq.beginPath();cq.rect(co-10,ct-10,20,20);cq.fillStyle="rgba(255,200,0,0.8)";if(cr){cq.fill()}cq.lineWidth=1.5;cq.strokeStyle="#ffffff";cq.stroke();ad[cp]={x1:co-10,y1:ct-10,x2:co+10+cs,y2:ct+10,value:cr}}function bo(){var cq=cd;var cs=20;var co;cq.clearRect(0,0,bq,ab);cq.textBaseline="middle";cq.textAlign="left";y=cs;cq.font=AdaptiveFontSize.fix("16pt serif");co=cq.measureText(m.geomElektron).width;cq.fillStyle="#b0b0b0";xs=bq/4-co/2;x=xs;cq.fillText(m.geomElektron,x,y);x-=20;bG(cq,x,y,o,0,co+10);if(o){cq.textBaseline="alphabetic";cq.textAlign="left";var cu=bS.split("|");x+=75;y+=38;cq.font=AdaptiveFontSize.fix("16pt serif");cq.fillStyle="#77aaff";cq.fillText(cu[0],x,y);if(cu.length>1){y+=22;cq.font=AdaptiveFontSize.fix("14pt serif");cq.fillStyle="#5588dd";cq.fillText(cu[1],x,y)}geomelectPosY=y+60}ci=xs;cg=cs+56;cq.textBaseline="middle";cq.textAlign="left";y=cs;cq.font=AdaptiveFontSize.fix("16pt serif");co=cq.measureText(m.geomMolekul).width;cq.fillStyle="#b0b0b0";xs=2.5*bq/4-co/2;x=xs;cq.fillText(m.geomMolekul,x,y);x-=20;bG(cq,x,y,n,1,co+10);if(n){cq.textBaseline="alphabetic";cq.textAlign="left";var cu=bO.split("|");x+=75;y+=38;cq.font=AdaptiveFontSize.fix("16pt serif");cq.fillStyle="#77aaff";cq.fillText(cu[0],x,y);if(cu.length>1){y+=22;cq.font=AdaptiveFontSize.fix("14pt serif");cq.fillStyle="#5588dd";cq.fillText(cu[1],x,y)}}geomMolPosX=xs;bp=cs+56;xs=bq-130;x=xs;y=cs;bG(cq,x,y,cb,2,40);x+=33;y+=13;cq.beginPath();cq.moveTo(x-4,y);cq.bezierCurveTo(x-25,y-34,x+25,y-34,x+4,y);cq.closePath();cq.fillStyle="#202020";cq.fill();cq.beginPath();cq.moveTo(x-4,y);cq.bezierCurveTo(x-25,y-34,x+25,y-34,x+4,y);cq.lineWidth=1.5;cq.strokeStyle="#b0b0b0";cq.stroke();cq.beginPath();cq.arc(x-3,y-17,2,0,2*Math.PI,false);cq.arc(x+3,y-17,2,0,2*Math.PI,false);cq.fillStyle="#b0b0b0";cq.fill();xs=bq-130;x=xs;y=cs+40;bG(cq,x,y,aR,3,40);var cr=25*B;x+=22;cq.beginPath();cq.moveTo(x,y);cq.arc(x,y,20,-cr,cr,false);cq.fillStyle="#202020";cq.fill();cq.beginPath();cq.arc(x,y,20,-cr,cr,false);cq.lineWidth=1;cq.strokeStyle="#b0b0b0";cq.stroke();var cp=Math.sin(cr);var ct=Math.cos(cr);cq.beginPath();cq.moveTo(x,y);cq.lineTo(x+28*ct,y-28*cp);cq.moveTo(x,y);cq.lineTo(x+28*ct,y+28*cp);cq.lineWidth=1.5;cq.strokeStyle="#b0b0b0";cq.stroke();if(a9){xs=bq-130;x=xs;y=cs+80;bG(cq,x,y,at,4,40);x+=20;bs(cq,x,y-5,12,10,3);cq.fillStyle="#bb0000";cq.fill();bs(cq,x+17,y-5,12,10,3);cq.fillStyle="#005588";cq.fill()}}function bs(cr,cq,ct,cs,cp,co){cr.beginPath();cr.moveTo(cq+co,ct);cr.lineTo(cq+cs-co,ct);cr.arcTo(cq+cs,ct,cq+cs,ct+co,co);cr.lineTo(cq+cs,ct+cp-co);cr.arcTo(cq+cs,ct+cp,cq+cs-co,ct+cp,co);cr.lineTo(cq+co,ct+cp);cr.arcTo(cq,ct+cp,cq,ct+cp-co,co);cr.lineTo(cq,ct+co);cr.arcTo(cq,ct,cq+co,ct,co);cr.closePath()}var o=true;var n=true;var cb=true;var aR=false;var at=false;var ci,be,cg,bp;function aY(){bd.CalcRotateMatrix(cj,O,aD,P);converter3D_BC1.CalcRotateMatrix(cj,O,aD,P);aV.CalcRotateMatrix(cj,O,aD,P);if(at){bE(converter3D_BC1,r,f,c-30,1);bE(aV,buffContext,bT/2,az/2,2);r.globalCompositeOperation="screen";r.drawImage(bB,0,0,bT,az,f-bT/2,c-30-az/2,bT,az);r.globalCompositeOperation="source-over"}else{bE(bd,r,f,c-30,0)}b0(bd,by,ci,cg);J(bd,by,geomMolPosX,bp);k=false}function aA(){ak();e();bo();ap(aG,aa);k=true}function bP(cr,cB,cz,co,cu){cr.beginPath();cr.arc(cB,cz,Math.round(co),0,2*Math.PI,false);if(bf){var cx="rgb("+cu.r+","+cu.g+","+cu.b+")";var cw="rgb("+Math.round(0.5*cu.r)+","+Math.round(0.5*cu.g)+","+Math.round(0.5*cu.b)+")";var cv="rgb("+Math.round(0.45*cu.r)+","+Math.round(0.45*cu.g)+","+Math.round(0.45*cu.b)+")";var cq=Math.round(cB-0.45*co);var cA=Math.round(cz-0.45*co);var ct=Math.round(0.2*co);var cp=Math.round(cB-0.2*co);var cy=Math.round(cz-0.2*co);var cs=Math.round(co);var cC=cr.createRadialGradient(cq,cA,ct,cp,cy,cs);cC.addColorStop(0,cx);cC.addColorStop(0.9,cw);cC.addColorStop(1,cv);cr.fillStyle=cC}else{cr.fillStyle="rgb("+cu.r+","+cu.g+","+cu.b+")"}cr.fill()}function bH(cq,co,cs,cr,cp){cq.beginPath();cq.arc(co,cs,cr,0,2*Math.PI,false);cq.fillStyle=cp;cq.fill()}var bd,aV;var P=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];function aI(){bd=new PesonaEdu3D(30,70,190,120);converter3D_BC1=new PesonaEdu3D(30-2,70,190,120);aV=new PesonaEdu3D(30+2,70,190,120)}var K;var Y=40;var bU=140;var bx=0.4*bU;var bw=bU-bx;var aw=16;var bm=16;var aP=48;var aH=40;var A=0.57*bU;var cf=60*B;var bu=Math.PI/2;var cc=109.5*B;var bJ=120*B;var al=Math.PI;var D=240*Math.PI;var i;var au;var bt;var R;var Z,G;var bF,ck;var b7,u;var bD,b1;var b5,b;var aM;var aT,j;var a0,M;var a3,v;var bM;var ae,bI;const a2={PUSAT:0,TERIKAT:1,BEBAS:2,BINGKAI:3,STICK:4,APIT:5};var V={r:255,g:0,b:100};var a6={r:255,g:255,b:255};var av={r:50,g:150,b:200};var L={r:255,g:200,b:0};var ax={r:255,g:255,b:255};var aN;var H;var bb;var ch;var bc;var bn=40;var bj;var E;function t(){bj=new Array();bj[0]={sides:[]};bj[1]={sides:[[1,2,3],[3,2,1]]};bj[2]={sides:[[1,2,3],[1,3,4],[1,4,2],[2,4,3]]};bj[3]={sides:[[1,2,3],[1,3,4],[1,4,2],[2,5,3],[3,5,4],[2,4,5]]};bj[4]={sides:[[1,2,3],[1,3,4],[1,4,5],[1,5,2],[2,6,3],[3,6,4],[4,6,5],[2,5,6]]};var co;E=new Array();E.push(null);co=E.push(new Array())-1;E[co].push({sides:[[1,2,3],[3,2,1]]});E[co].push(null);co=E.push(new Array())-1;E[co].push({sides:[[1,2,3],[1,3,4],[1,4,2],[2,4,3]]});E[co].push({sides:[[0,2,3],[0,3,4],[0,4,2],[2,4,3]]});E[co].push(null);co=E.push(new Array())-1;E[co].push({sides:[[1,2,3],[1,3,4],[1,4,2],[2,5,3],[3,5,4],[2,4,5]]});E[co].push(null);E[co].push(null);E[co].push(null);co=E.push(new Array())-1;E[co].push({sides:[[1,2,3],[1,3,4],[1,4,5],[1,5,2],[2,6,3],[3,6,4],[4,6,5],[2,5,6]]});E[co].push({sides:[[2,6,3],[3,6,4],[4,6,5],[2,5,6],[2,3,4,5]]});E[co].push({sides:[[2,3,4,5],[5,4,3,2]]});E[co].push(null);E[co].push(null)}function b9(){au=new Array();au[0]=new Array();au[0][0]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:bU,z:0},type:a2.TERIKAT},{pos:{x:0,y:-bU,z:0},type:a2.TERIKAT}],PEB:0,geomElektron:m.linear,geomMolekul:m.linear,geom:0,apit:[{p1:1,p2:2,label:"180°"},{p1:1,p2:2,label:"180°"}]};au[1]=new Array();au[1][0]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.TERIKAT},{pos:aE(bU,120,90),type:a2.TERIKAT},{pos:aE(bU,120,270),type:a2.TERIKAT}],PEB:0,geomElektron:m.trigonalPlanar,geomMolekul:m.trigonalPlanar,geom:1,apit:[{p1:1,p2:2,label:"120°"},{p1:2,p2:3,label:"120°"},{p1:3,p2:1,label:"120°"}]};au[1][1]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.BEBAS},{pos:aE(bU,130,90),type:a2.TERIKAT},{pos:aE(bU,130,270),type:a2.TERIKAT}],PEB:1,geomElektron:m.trigonalPlanar,geomMolekul:m.bent,geom:1,apit:[{p1:2,p2:3,label:"< 120°"}]};au[2]=new Array();au[2][0]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.TERIKAT},{pos:aE(bU,109.5,60),type:a2.TERIKAT},{pos:aE(bU,-109.5,0),type:a2.TERIKAT},{pos:aE(bU,109.5,-60),type:a2.TERIKAT}],PEB:0,geomElektron:m.tetrahedral,geomMolekul:m.tetrahedral,geom:2,apit:[{p1:1,p2:2,label:"109.5°"},{p1:1,p2:3,label:"109.5°"},{p1:1,p2:4,label:"109.5°"},{p1:2,p2:3,label:"109.5°"},{p1:3,p2:4,label:"109.5°"},{p1:4,p2:2,label:"109.5°"}]};au[2][1]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.BEBAS},{pos:aE(bU,115,60),type:a2.TERIKAT},{pos:aE(bU,-115,0),type:a2.TERIKAT},{pos:aE(bU,115,-60),type:a2.TERIKAT}],PEB:1,geomElektron:m.tetrahedral,geomMolekul:m.trigonalPyramidal,geom:2,apit:[{p1:2,p2:3,label:"< 109.5°"},{p1:3,p2:4,label:"< 109.5°"},{p1:4,p2:2,label:"< 109.5°"}]};au[2][2]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.BEBAS},{pos:aE(bU,112,55),type:a2.TERIKAT},{pos:aE(bU,-120,0),type:a2.BEBAS},{pos:aE(bU,112,-55),type:a2.TERIKAT}],PEB:2,geomElektron:m.tetrahedral,geomMolekul:m.bent,geom:2,apit:[{p1:4,p2:2,label:"< 109.5°"}]};au[3]=new Array();au[3][0]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.TERIKAT},{pos:aE(bU,90,60),type:a2.TERIKAT},{pos:aE(bU,-90,0),type:a2.TERIKAT},{pos:aE(bU,90,-60),type:a2.TERIKAT},{pos:{x:0,y:0,z:-bU},type:a2.TERIKAT}],PEB:0,geomElektron:m.trigonalBipyramidal,geomMolekul:m.trigonalBipyramidal,geom:3,apit:[{p1:1,p2:2,label:"90°"},{p1:1,p2:3,label:"90°"},{p1:1,p2:4,label:"90°"},{p1:5,p2:2,label:"90°"},{p1:5,p2:3,label:"90°"},{p1:5,p2:4,label:"90°"},{p1:2,p2:3,label:"120°"},{p1:3,p2:4,label:"120°"},{p1:4,p2:2,label:"120°"}]};au[3][1]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:aE(bU,-3,60),type:a2.TERIKAT},{pos:aE(bU,90,60),type:a2.BEBAS},{pos:aE(bU,-90,3),type:a2.TERIKAT},{pos:aE(bU,90,-63),type:a2.TERIKAT},{pos:aE(bU,183,60),type:a2.TERIKAT}],PEB:1,geomElektron:m.trigonalBipyramidal,geomMolekul:m.seesaw,geom:3,apit:[{p1:1,p2:3,label:"< 90°"},{p1:1,p2:4,label:"< 90°"},{p1:5,p2:3,label:"< 90°"},{p1:5,p2:4,label:"< 90°"},{p1:4,p2:3,label:"< 120°"}]};au[3][2]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:aE(bU,-6,0),type:a2.TERIKAT},{pos:aE(bU,90,65),type:a2.BEBAS},{pos:aE(bU,-90,0),type:a2.TERIKAT},{pos:aE(bU,90,-65),type:a2.BEBAS},{pos:aE(bU,186,0),type:a2.TERIKAT}],PEB:2,geomElektron:m.trigonalBipyramidal,geomMolekul:m.tShaped,geom:3,apit:[{p1:1,p2:3,label:"< 90°"},{p1:5,p2:3,label:"< 90°"}]};au[3][3]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.TERIKAT},{pos:aE(bU,90,60),type:a2.BEBAS},{pos:aE(bU,-90,0),type:a2.BEBAS},{pos:aE(bU,90,-60),type:a2.BEBAS},{pos:{x:0,y:0,z:-bU},type:a2.TERIKAT}],PEB:3,geomElektron:m.trigonalBipyramidal,geomMolekul:m.linear,geom:3,apit:[{p1:1,p2:5,label:"180°"},{p1:1,p2:5,label:"180°"},{p1:1,p2:5,label:"180°"}]};au[4]=new Array();au[4][0]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.TERIKAT},{pos:aE(bU,90,0),type:a2.TERIKAT},{pos:aE(bU,90,90),type:a2.TERIKAT},{pos:aE(bU,90,180),type:a2.TERIKAT},{pos:aE(bU,90,270),type:a2.TERIKAT},{pos:{x:0,y:0,z:-bU},type:a2.TERIKAT}],PEB:0,geomElektron:m.octahedral,geomMolekul:m.octahedral,geom:4,apit:[{p1:1,p2:2,label:"90°"},{p1:1,p2:3,label:"90°"},{p1:1,p2:4,label:"90°"},{p1:1,p2:5,label:"90°"},{p1:6,p2:2,label:"90°"},{p1:6,p2:3,label:"90°"},{p1:6,p2:4,label:"90°"},{p1:6,p2:5,label:"90°"},{p1:2,p2:3,label:"90°"},{p1:3,p2:4,label:"90°"},{p1:4,p2:5,label:"90°"},{p1:5,p2:2,label:"90°"}]};au[4][1]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.BEBAS},{pos:aE(bU,105,0),type:a2.TERIKAT},{pos:aE(bU,105,90),type:a2.TERIKAT},{pos:aE(bU,105,180),type:a2.TERIKAT},{pos:aE(bU,105,270),type:a2.TERIKAT},{pos:{x:0,y:0,z:-bU},type:a2.TERIKAT}],PEB:1,geomElektron:m.octahedral,geomMolekul:m.squarePyramidal,geom:4,apit:[{p1:6,p2:2,label:"< 90°"},{p1:6,p2:3,label:"< 90°"},{p1:6,p2:4,label:"< 90°"},{p1:6,p2:5,label:"< 90°"},{p1:2,p2:3,label:"< 90°"},{p1:3,p2:4,label:"< 90°"},{p1:4,p2:5,label:"< 90°"},{p1:5,p2:2,label:"< 90°"}]};au[4][2]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.BEBAS},{pos:aE(bU,90,0),type:a2.TERIKAT},{pos:aE(bU,90,90),type:a2.TERIKAT},{pos:aE(bU,90,180),type:a2.TERIKAT},{pos:aE(bU,90,270),type:a2.TERIKAT},{pos:{x:0,y:0,z:-bU},type:a2.BEBAS}],PEB:2,geomElektron:m.octahedral,geomMolekul:m.squarePlanar,geom:4,apit:[{p1:2,p2:3,label:"90°"},{p1:3,p2:4,label:"90°"},{p1:4,p2:5,label:"90°"},{p1:5,p2:2,label:"90°"}]};au[4][3]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:aE(bU,-15,-90),type:a2.BEBAS},{pos:aE(bU,90,15),type:a2.TERIKAT},{pos:aE(bU,90,90),type:a2.TERIKAT},{pos:aE(bU,90,165),type:a2.TERIKAT},{pos:aE(bU,90,270),type:a2.BEBAS},{pos:aE(-bU,15,-90),type:a2.BEBAS}],PEB:3,geomElektron:m.octahedral,geomMolekul:m.tShaped,geom:4,apit:[{p1:2,p2:3,label:"< 90°"},{p1:3,p2:4,label:"< 90°"}]};au[4][4]={atom:[{pos:{x:0,y:0,z:0},type:a2.PUSAT},{pos:{x:0,y:0,z:bU},type:a2.BEBAS},{pos:aE(bU,90,0),type:a2.TERIKAT},{pos:aE(bU,90,90),type:a2.BEBAS},{pos:aE(bU,90,180),type:a2.TERIKAT},{pos:aE(bU,90,270),type:a2.BEBAS},{pos:{x:0,y:0,z:-bU},type:a2.BEBAS}],PEB:4,geomElektron:m.octahedral,geomMolekul:m.linear,geom:4,apit:[{p1:4,p2:2,label:"180°"}]};aN=new Array();H=new Array();bb=new Array();ch=new Array();bc=new Array();var cq={r:1,g:1,b:1};var cp={r:1,g:0,b:0};var co={r:0,g:1,b:1};aN[0]=aB(V,cq);aN[1]=aB(V,cp);aN[2]=aB(V,co);H[0]=aB(a6,cq);H[1]=aB(a6,cp);H[2]=aB(a6,co);bb[0]=aB(av,cq);bb[1]=aB(av,cp);bb[2]=aB(av,co);ch[0]=aB(L,cq);ch[1]=aB(L,cp);ch[2]=aB(L,co);bc[0]=aB(ax,cq);bc[1]=aB(ax,cp);bc[2]=aB(ax,co)}function aB(co,cp){return{r:Math.round(co.r*cp.r),g:Math.round(co.g*cp.g),b:Math.round(co.b*cp.b)}}function aS(cu,ct){var cz,cx,cv,cs;cz=cu.x;cx=cu.y;cv=cu.z;cs=Math.sqrt(cz*cz+cx*cx+cv*cv);var cp=cz/cs;var cy=cx/cs;var cr=cv/cs;cz=ct.x;cx=ct.y;cv=ct.z;cs=Math.sqrt(cz*cz+cx*cx+cv*cv);var co=cz/cs;var cw=cx/cs;var cq=cv/cs;return Math.acos(cp*co+cy*cw+cr*cq)}var ai;var ah;var bS,bO;function am(cB,co){var cM,cR,cE,cC;var cQ=cB-2;var cU=Math.min(co,au[cQ].length);var cw=au[cQ][cU];bt=new Array();for(var cS=0;cS<cw.atom.length;cS++){Ma=cw.atom[cS];bt.push({pos:{x:Ma.pos.x,y:Ma.pos.y,z:Ma.pos.z},type:Ma.type})}if(cw.geom!=null){ai=cw.geom}else{ai=-1}ah=co;bS=cw.geomElektron;bO=cw.geomMolekul;Z=new Array();G=new Array();bF=new Array();b7=new Array();ck=new Array();u=new Array();aM=new Array();bD=new Array();b5=new Array();b1=new Array();b=new Array();stickAR=new Array();for(var cS=0;cS<bt.length;cS++){Z.push(bt[cS].pos);G.push({x:0,y:0,z:0});bF.push({x:0,y:0,z:0});b7.push({x:0,y:0,z:0});bD.push({x:0,y:0,z:0});b5.push({x:0,y:0,z:0});aM.push({x:0,y:0,z:0});ck.push({x:0,y:0,z:0});u.push({x:0,y:0,z:0});b1.push({x:0,y:0,z:0});b.push({x:0,y:0,z:0});stickAR.push({x:0,y:0,z:0});switch(bt[cS].type){case a2.TERIKAT:cR=bd.distanceBetween(bt[0].pos,bt[cS].pos);cM=aP-Math.sqrt(aP*aP-aw*aw);cE=aP-cM;cM=aH-Math.sqrt(aH*aH-aw*aw);cC=cR-aH+cM;bF[cS]=h(bt[0].pos,bt[cS].pos,cE);b7[cS]=h(bt[0].pos,bt[cS].pos,cE+(cC-cE)/2);bD[cS]=h(bt[0].pos,bt[cS].pos,cE+(cC-cE)/2);b5[cS]=h(bt[0].pos,bt[cS].pos,cC);aM[cS]=h(bt[0].pos,bt[cS].pos,A);break;case a2.BEBAS:cR=bd.distanceBetween(bt[0].pos,bt[cS].pos)-20;cM=aP-Math.sqrt(aP*aP-bm*bm);cE=aP-cM;bF[cS]=h(bt[0].pos,bt[cS].pos,cE);b7[cS]=h(bt[0].pos,bt[cS].pos,bU+aH-20);var cP={x:(bt[0].pos.x+bt[cS].pos.x)/2+10,y:(bt[0].pos.y+bt[cS].pos.y)/2+10,z:(bt[0].pos.z+bt[cS].pos.z)/2+10};var cv,ct,cr,cT;var cM;cv=bt[0].pos.x-bt[cS].pos.x;ct=bt[0].pos.y-bt[cS].pos.y;cr=bt[0].pos.z-bt[cS].pos.z;cT=Math.sqrt(cv*cv+ct*ct+cr*cr);var cI={x:-cv/cT,y:-ct/cT,z:-cr/cT};cv=bt[0].pos.x-cP.x;ct=bt[0].pos.y-cP.y;cr=bt[0].pos.z-cP.z;cT=Math.sqrt(cv*cv+ct*ct+cr*cr);var cK={x:-cv/cT,y:-ct/cT,z:-cr/cT};cv=bt[0].pos.x-bt[cS].pos.x;ct=bt[0].pos.y-bt[cS].pos.y;cr=bt[0].pos.z-bt[cS].pos.z;cT=Math.sqrt(cv*cv+ct*ct+cr*cr);var cJ={x:cv/cT,y:ct/cT,z:cr/cT};var cH={x:cK.y*cJ.z-cK.z*cJ.y,y:cK.z*cJ.x-cK.x*cJ.z,z:cK.x*cJ.y-cK.y*cJ.x};cT=Math.sqrt(cH.x*cH.x+cH.y*cH.y+cH.z*cH.z);cH.x/=cT;cH.y/=cT;cH.z/=cT;var cG={x:cH.y*cJ.z-cH.z*cJ.y,y:cH.z*cJ.x-cH.x*cJ.z,z:cH.x*cJ.y-cH.y*cJ.x};cT=Math.sqrt(cG.x*cG.x+cG.y*cG.y+cG.z*cG.z);cG.x/=cT;cG.y/=cT;cG.z/=cT;cM=cR+aH/5;var cD={x:0,y:0,z:0};cD.x=bt[0].pos.x+cI.x*cM;cD.y=bt[0].pos.y+cI.y*cM;cD.z=bt[0].pos.z+cI.z*cM;var cO=[{x:0,y:0,z:0},{x:0,y:0,z:0}];bD[cS].x=cD.x+cG.x*0.3*aH;bD[cS].y=cD.y+cG.y*0.3*aH;bD[cS].z=cD.z+cG.z*0.3*aH;b5[cS].x=cD.x-cG.x*0.3*aH;b5[cS].y=cD.y-cG.y*0.3*aH;b5[cS].z=cD.z-cG.z*0.3*aH;break;default:break}}var cx=0.25;a3=new Array();v=new Array();cw=au[cQ][0];for(var cS=0;cS<bt.length;cS++){a3.push({x:cw.atom[cS].pos.x*cx,y:cw.atom[cS].pos.y*cx,z:cw.atom[cS].pos.z*cx});v.push({x:0,y:0,z:0})}bM=new Array();cw=au[cQ][cU];for(var cS=0;cS<bt.length;cS++){bM.push({x:cw.atom[cS].pos.x*cx,y:cw.atom[cS].pos.y*cx,z:cw.atom[cS].pos.z*cx})}R=new Array;ae=new Array();bI=new Array();var cL,cN,cA,cz,cW,cV;var cF={x:0,y:0,z:0};var cs={x:0,y:0,z:0};var cq={x:0,y:0,z:0};var cp={x:0,y:0,z:0};var cY={x:0,y:0,z:0};var cX={x:0,y:0,z:0};var cu=aw*Math.cos(aJ);var cy=aw*Math.sin(aJ);if(cw.apit!=null){for(var cS=0;cS<cw.apit.length;cS++){Ma=cw.apit[cS];cp.x=(cw.atom[Ma.p1].pos.x+cw.atom[Ma.p2].pos.x)/2;cp.y=(cw.atom[Ma.p1].pos.y+cw.atom[Ma.p2].pos.y)/2;cp.z=(cw.atom[Ma.p1].pos.z+cw.atom[Ma.p2].pos.z)/2;if(cp.x==0&&cp.y==0&&cp.z==0){cp=aE(bU,90,cS*360/cw.apit.length)}cq.x=cw.atom[Ma.p1].pos.x;cq.y=cw.atom[Ma.p1].pos.y;cq.z=cw.atom[Ma.p1].pos.z;cv=(cq.x-cs.x);ct=(cq.y-cs.y);cr=(cq.z-cs.z);cN=((cp.x-cs.x)*cv+(cp.y-cs.y)*ct+(cp.z-cs.z)*cr)/(cv*cv+ct*ct+cr*cr);cF.x=cs.x+cN*(cq.x-cs.x);cF.y=cs.y+cN*(cq.y-cs.y);cF.z=cs.z+cN*(cq.z-cs.z);cv=cp.x-cF.x;ct=cp.y-cF.y;cr=cp.z-cF.z;cT=Math.sqrt(cv*cv+ct*ct+cr*cr);cW={x:cv/cT,y:ct/cT,z:cr/cT};cv=cw.atom[Ma.p1].pos.x;ct=cw.atom[Ma.p1].pos.y;cr=cw.atom[Ma.p1].pos.z;cT=Math.sqrt(cv*cv+ct*ct+cr*cr);cA={x:cv/cT,y:ct/cT,z:cr/cT};cY.x=aM[Ma.p1].x+cu*cA.x+cy*cW.x;cY.y=aM[Ma.p1].y+cu*cA.y+cy*cW.y;cY.z=aM[Ma.p1].z+cu*cA.z+cy*cW.z;cq.x=cw.atom[Ma.p2].pos.x;cq.y=cw.atom[Ma.p2].pos.y;cq.z=cw.atom[Ma.p2].pos.z;cv=(cq.x-cs.x);ct=(cq.y-cs.y);cr=(cq.z-cs.z);cN=((cp.x-cs.x)*cv+(cp.y-cs.y)*ct+(cp.z-cs.z)*cr)/(cv*cv+ct*ct+cr*cr);cF.x=cs.x+cN*(cq.x-cs.x);cF.y=cs.y+cN*(cq.y-cs.y);cF.z=cs.z+cN*(cq.z-cs.z);cv=cp.x-cF.x;ct=cp.y-cF.y;cr=cp.z-cF.z;cT=Math.sqrt(cv*cv+ct*ct+cr*cr);cW={x:cv/cT,y:ct/cT,z:cr/cT};cv=cw.atom[Ma.p2].pos.x;ct=cw.atom[Ma.p2].pos.y;cr=cw.atom[Ma.p2].pos.z;cT=Math.sqrt(cv*cv+ct*ct+cr*cr);cA={x:cv/cT,y:ct/cT,z:cr/cT};cX.x=aM[Ma.p2].x+cu*cA.x+cy*cW.x;cX.y=aM[Ma.p2].y+cu*cA.y+cy*cW.y;cX.z=aM[Ma.p2].z+cu*cA.z+cy*cW.z;ae.push({x:cY.x,y:cY.y,z:cY.z});bI.push({x:0,y:0,z:0});ae.push({x:cX.x,y:cX.y,z:cX.z});bI.push({x:0,y:0,z:0});cv=cp.x;ct=cp.y;cr=cp.z;cT=Math.sqrt(cv*cv+ct*ct+cr*cr);cN={x:cv/cT,y:ct/cT,z:cr/cT};ae.push({x:0.75*bU*cN.x,y:0.75*bU*cN.y,z:0.75*bU*cN.z});bI.push({x:0,y:0,z:0});cL=aS(cY,cX);R.push({p1:ae.length-3,p2:ae.length-2,pm:ae.length-1,ang:cL,label:Ma.label})}}}function aE(cr,cp,cq){var co=cp*B;var cs=cq*B;return{x:cr*Math.sin(co)*Math.cos(cs),y:cr*Math.sin(co)*Math.sin(cs),z:cr*Math.cos(co)}}function h(co,cr,cp){var cq=bd.vectorBetween(co,cr);return{x:co.x+cp*cq.Ax,y:co.y+cp*cq.Ay,z:co.z+cp*cq.Az}}Array.prototype.insert=function(co,cp){this.splice(co,0,cp)};function J(cz,cq,ct,cr){var cC=90;cq.clearRect(ct-cC/2,cr-cC/2,cC,cC);if(n&&ai>=0){var cB;var cp;var cv=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}];cz.RotateByMatrix(bM,v,P);var cA=cz.Convert(v[0].x,v[0].y,v[0].z);if(E[ai]!=null){var cy=E[ai][ah];if(cy!=null){var cs=cy.sides;var co,cu;cq.lineCap="round";cq.lineJoin="round";cq.lineWidth=1;cq.strokeStyle="#303030";for(var cx=0;cx<cs.length;cx++){co=cs[cx];cv[0].x=v[co[0]].x;cv[0].y=v[co[0]].y;cv[0].z=v[co[0]].z;cv[1].x=v[co[1]].x;cv[1].y=v[co[1]].y;cv[1].z=v[co[1]].z;cv[2].x=v[co[2]].x;cv[2].y=v[co[2]].y;cv[2].z=v[co[2]].z;cp=cz.Visible2(cv);if(!cp.appear){cq.beginPath();for(var cw=0;cw<co.length;cw++){cu=co[cw];cB=cz.Convert(v[cu].x,v[cu].y,v[cu].z);if(cw==0){cq.moveTo(ct+cB.x,cr+cB.y)}else{cq.lineTo(ct+cB.x,cr+cB.y)}}cq.closePath();cq.stroke()}}}}cq.fillStyle="#ffffff";for(var cx=1;cx<v.length;cx++){if(bt[cx].type==a2.TERIKAT){cB=cz.Convert(v[cx].x,v[cx].y,v[cx].z);if(cB.s<cA.s){cq.beginPath();cq.arc(ct+cB.x,cr+cB.y,3,0,2*Math.PI,false);cq.fill()}}}cq.lineWidth=1;cq.strokeStyle="#880000";for(var cx=1;cx<v.length;cx++){cq.beginPath();cq.moveTo(ct+cA.x,cr+cA.y);cB=cz.Convert(v[cx].x,v[cx].y,v[cx].z);cq.lineTo(ct+cB.x,cr+cB.y);if(bt[cx].type==a2.BEBAS){}else{cq.lineWidth=2;cq.strokeStyle="#ffffff";cq.stroke()}}cq.beginPath();cq.arc(ct+cA.x,cr+cA.y,4,2*Math.PI,false);cq.fillStyle="#bb0000";cq.fill();if(E[ai]!=null){var cy=E[ai][ah];if(cy!=null){var cs=cy.sides;var co,cu;cq.lineWidth=1;cq.strokeStyle="#b0b0b0";for(var cx=0;cx<cs.length;cx++){co=cs[cx];cv[0].x=v[co[0]].x;cv[0].y=v[co[0]].y;cv[0].z=v[co[0]].z;cv[1].x=v[co[1]].x;cv[1].y=v[co[1]].y;cv[1].z=v[co[1]].z;cv[2].x=v[co[2]].x;cv[2].y=v[co[2]].y;cv[2].z=v[co[2]].z;cp=cz.Visible2(cv);if(cp.appear){cq.beginPath();for(var cw=0;cw<co.length;cw++){cu=co[cw];cB=cz.Convert(v[cu].x,v[cu].y,v[cu].z);if(cw==0){cq.moveTo(ct+cB.x,cr+cB.y)}else{cq.lineTo(ct+cB.x,cr+cB.y)}}cq.closePath();vr=Math.round(255*(cp.angle)/180);cq.fillStyle="rgba("+vr+","+vr+","+vr+",0.6)";cq.fill();cq.stroke()}}}}cq.fillStyle="#ffffff";for(var cx=1;cx<v.length;cx++){if(bt[cx].type==a2.TERIKAT){cB=cz.Convert(v[cx].x,v[cx].y,v[cx].z);if(cB.s>=cA.s){cq.beginPath();cq.arc(ct+cB.x,cr+cB.y,3,0,2*Math.PI,false);cq.fill()}}}}}function b0(cz,cq,ct,cr){var cC=90;cq.clearRect(ct-cC/2,cr-cC/2,cC,cC);if(o&&ai>=0){var cB;var cp,cD;var cv=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}];cz.RotateByMatrix(a3,v,P);var cy=bj[ai];var cs=cy.sides;var co,cu;cq.lineCap="round";cq.lineJoin="round";cq.lineWidth=1;cq.strokeStyle="#303030";for(var cx=0;cx<cs.length;cx++){co=cs[cx];cv[0].x=v[co[0]].x;cv[0].y=v[co[0]].y;cv[0].z=v[co[0]].z;cv[1].x=v[co[1]].x;cv[1].y=v[co[1]].y;cv[1].z=v[co[1]].z;cv[2].x=v[co[2]].x;cv[2].y=v[co[2]].y;cv[2].z=v[co[2]].z;cp=cz.Visible2(cv);if(!cp.appear){cq.beginPath();for(var cw=0;cw<co.length;cw++){cu=co[cw];cB=cz.Convert(v[cu].x,v[cu].y,v[cu].z);if(cw==0){cq.moveTo(ct+cB.x,cr+cB.y)}else{cq.lineTo(ct+cB.x,cr+cB.y)}}cq.closePath();cq.stroke()}}var cA=cz.Convert(v[0].x,v[0].y,v[0].z);cq.beginPath();for(var cx=1;cx<v.length;cx++){cq.moveTo(ct+cA.x,cr+cA.y);cB=cz.Convert(v[cx].x,v[cx].y,v[cx].z);cq.lineTo(ct+cB.x,cr+cB.y)}cq.lineWidth=1;cq.strokeStyle="#880000";cq.stroke();cq.beginPath();cq.arc(ct+cA.x,cr+cA.y,4,2*Math.PI,false);cq.fillStyle="#880000";cq.fill();cq.lineWidth=1;cq.strokeStyle="#b0b0b0";for(var cx=0;cx<cs.length;cx++){co=cs[cx];cv[0].x=v[co[0]].x;cv[0].y=v[co[0]].y;cv[0].z=v[co[0]].z;cv[1].x=v[co[1]].x;cv[1].y=v[co[1]].y;cv[1].z=v[co[1]].z;cv[2].x=v[co[2]].x;cv[2].y=v[co[2]].y;cv[2].z=v[co[2]].z;cp=cz.Visible2(cv);if(cp.appear){cq.beginPath();for(var cw=0;cw<co.length;cw++){cu=co[cw];cB=cz.Convert(v[cu].x,v[cu].y,v[cu].z);if(cw==0){cq.moveTo(ct+cB.x,cr+cB.y)}else{cq.lineTo(ct+cB.x,cr+cB.y)}}cq.closePath();cD=Math.round(255*(cp.angle)/180);cq.fillStyle="rgba("+cD+","+cD+","+cD+",0.6)";cq.fill();cq.stroke()}}}}function bE(cN,cr,cu,ct,cw){cr.clearRect(cu-bT/2,ct-az/2,bT,az);var cM,cF,cv,cA;var cL;var cq,cp;var cC;cN.RotateByMatrix(Z,G,P);cN.RotateByMatrix(bF,ck,P);cN.RotateByMatrix(b7,u,P);cN.RotateByMatrix(bD,b1,P);cN.RotateByMatrix(b5,b,P);cN.RotateByMatrix(aM,stickAR,P);cN.RotateByMatrix(ae,bI,P);cF=cN.Convert(G[0].x,G[0].y,G[0].z);var cy=new Array();for(var cJ=0;cJ<G.length;cJ++){cy.push({index:cJ,pos:{x:G[cJ].x,y:G[cJ].y,z:G[cJ].z},type:bt[cJ].type})}for(var cJ=0;cJ<G.length;cJ++){if(bt[cJ].type==a2.TERIKAT){cy.push({index:cJ,pos:{x:ck[cJ].x,y:ck[cJ].y,z:ck[cJ].z},type:a2.STICK})}}for(var cJ=0;cJ<R.length;cJ++){cy.push({index:cJ,pos:{x:bI[R[cJ].pm].x,y:bI[R[cJ].pm].y,z:bI[R[cJ].pm].z},type:a2.APIT,p1:R[cJ].p1,p2:R[cJ].p2,ang:R[cJ].ang,pm:R[cJ].pm,label:R[cJ].label})}var cR=cN.sortVerticesPos(cy);var cH,cG,cQ,cx;var cs;var cB,cz,cP,cO;var cK;var cD;var cJ=0;while(cJ<cR.length){cH=cR[cJ].index;cQ=cy[cH].index;if(cy[cH].type==a2.STICK){if(cJ<cR.length-1){for(var cI=cJ+1;cI<cR.length;cI++){cH=cR[cI].index;cx=cy[cH].index;if(cQ==cx&&cy[cH].type==a2.TERIKAT){cM=cN.Convert(G[cx].x,G[cx].y,G[cx].z);if((cM.s/cF.s)<1.1){cA=cN.Convert(ck[cx].x,ck[cx].y,ck[cx].z);cs=z(cN,cu,ct,b1[cx],b[cx],b[cx],aw);cD=bC(G[cx],b1[cx],aH);cv=cN.Convert(cD.x,cD.y,cD.z);cB=cv.x-cA.x;cz=cv.y-cA.y;cP=Math.sqrt(cB*cB+cz*cz);cv=cN.Convert(cs.x,cs.y,cs.z);cB=cv.x-cA.x;cz=cv.y-cA.y;cO=Math.sqrt(cB*cB+cz*cz);cK=(cP<=cO);if(cK){cR.splice(cI+1,0,{index:cR[cJ].index,depth:cR[cJ].depth});cR.splice(cJ,1);cJ--;break}}}}}}cJ++}var cJ=0;var cE;while(cJ<cR.length){cH=cR[cJ].index;cQ=cy[cH].index;if(cy[cH].type==a2.STICK||cy[cH].type==a2.BEBAS){cE=(cy[cH].type==a2.STICK)?aw:bm;if(cJ<cR.length-1){for(var cI=cJ+1;cI<cR.length;cI++){cH=cR[cI].index;if(cy[cH].type==a2.PUSAT){cx=cy[cH].index;cD=bC(G[cx],G[cQ],aP);cs=z(cN,cu,ct,ck[cQ],u[cQ],ck[cQ],cE);cv=cN.Convert(cD.x,cD.y,cD.z);cB=cv.x-cF.x;cz=cv.y-cF.y;cP=Math.sqrt(cB*cB+cz*cz);cv=cN.Convert(cs.x,cs.y,cs.z);cB=cv.x-cF.x;cz=cv.y-cF.y;cO=Math.sqrt(cB*cB+cz*cz);cM=cN.Convert(G[cx].x,G[cx].y,G[cx].z);if(cM.s<=cF.s){cK=(cP<=cO);if(!cK){cR.splice(cI+1,0,{index:cR[cJ].index,depth:cR[cJ].depth});cR.splice(cJ,1);cJ--;break}}}}}}cJ++}var co;for(var cJ=0;cJ<cR.length;cJ++){cH=cR[cJ].index;cG=cy[cH].index;switch(cy[cH].type){case a2.PUSAT:cM=cN.Convert(G[0].x,G[0].y,G[0].z);bP(cr,cu+cM.x,ct+cM.y,aP*cM.s,aN[cw]);break;case a2.TERIKAT:cM=cN.Convert(G[cG].x,G[cG].y,G[cG].z);bP(cr,cu+cM.x,ct+cM.y,aH*cM.s,H[cw]);break;case a2.STICK:cn(cN,cr,cu,ct,ck[cG],u[cG],aN[cw]);cn(cN,cr,cu,ct,b1[cG],b[cG],H[cw]);break;case a2.BEBAS:if(cb){a7(cN,bi,U/2,C/2,cr,cu,ct,ck[cG],u[cG],b1[cG],b[cG],bm,aH,bb[cw])}break;case a2.APIT:if(aR){bk(cN,cr,cu,ct,cy[cH],ch[cw],bc[cw])}}}for(var cJ=0;cJ<bI.length;cJ++){cv=cN.Convert(bI[cJ].x,bI[cJ].y,bI[cJ].z)}}function bk(cI,ct,cy,cx,cA,cH,cG){var cz,cp,cq;var cw={x:0,y:0,z:0};var cv={x:0,y:0,z:0};var cu={x:0,y:0,z:0};var cB={x:0,y:0,z:0};var cD=20;var cJ;var cC,cK;var co,cs;var cE;var cr=cI.GetScale(0,0,0);cp=cI.GetScale(cA.pos.x,cA.pos.y,cA.pos.z);cJ=cA.ang;if(cJ>0.8*Math.PI){cE=1.04}else{cE=1}if((cp/cr)>cE){cq=Math.min(1,20*((cp/cr)-cE));cu.x=bI[cA.pm].x;cu.y=bI[cA.pm].y;cu.z=bI[cA.pm].z;cv.x=bI[cA.p1].x;cv.y=bI[cA.p1].y;cv.z=bI[cA.p1].z;dx=(cv.x-cw.x);dy=(cv.y-cw.y);dz=(cv.z-cw.z);q=((cu.x-cw.x)*dx+(cu.y-cw.y)*dy+(cu.z-cw.z)*dz)/(dx*dx+dy*dy+dz*dz);cB.x=cw.x+q*(cv.x-cw.x);cB.y=cw.y+q*(cv.y-cw.y);cB.z=cw.z+q*(cv.z-cw.z);dx=cu.x-cB.x;dy=cu.y-cB.y;dz=cu.z-cB.z;d=Math.sqrt(dx*dx+dy*dy+dz*dz);v1={x:dx/d,y:dy/d,z:dz/d};dx=(cv.x-cw.x);dy=(cv.y-cw.y);dz=(cv.z-cw.z);d=Math.sqrt(dx*dx+dy*dy+dz*dz);u1={x:dx/d,y:dy/d,z:dz/d};cC=2*A*Math.sin(0.5*cJ/cD);cK=0.5*(Math.PI-cJ/cD);cK=2*(aJ-cK);cs=cC*Math.cos(cK);co=cC*Math.sin(cK);ct.beginPath();cB.x=cv.x;cB.y=cv.y;cB.z=cv.z;cz=cI.Convert(cB.x,cB.y,cB.z);ct.moveTo(cy+cz.x,cx+cz.y);for(var cF=0;cF<=cD;cF++){cs=cC*Math.cos(aJ+cF*cK);co=cC*Math.sin(aJ+cF*cK);cB.x+=cs*u1.x+co*v1.x;cB.y+=cs*u1.y+co*v1.y;cB.z+=cs*u1.z+co*v1.z;cz=cI.Convert(cB.x,cB.y,cB.z);ct.lineTo(cy+cz.x,cx+cz.y)}ct.lineWidth=2;ct.strokeStyle="rgba("+cH.r+","+cH.g+","+cH.b+","+cq+")";ct.stroke();ct.font=AdaptiveFontSize.fix("14pt serif");ct.textBaseline="middle";ct.textAlign="center";ct.fillStyle="rgba("+cG.r+","+cG.g+","+cG.b+","+cq+")";cz=cI.Convert(bI[cA.pm].x,bI[cA.pm].y,bI[cA.pm].z);ct.fillText(cA.label,cy+cz.x,cx+cz.y)}}function bC(cu,cv,cq){var cs=cv.x-cu.x;var cr=cv.y-cu.y;var cp=cv.z-cu.z;d=Math.sqrt(cs*cs+cr*cr+cp*cp);var ct={x:cs/d,y:cr/d,z:cp/d};var co={x:0,y:0,z:0};co.x=cu.x+cq*ct.x;co.y=cu.y+cq*ct.y;co.z=cu.z+cq*ct.z;return co}function z(cN,cu,ct,cI,cH,cL,cO){var cr={x:(cI.x+cH.x)/2+10,y:(cI.y+cH.y)/2+10,z:(cI.z+cH.z)/2+10};var cB,cA,cz,cM;cB=cI.x-cr.x;cA=cI.y-cr.y;cz=cI.z-cr.z;cM=Math.sqrt(cB*cB+cA*cA+cz*cz);var cD={x:-cB/cM,y:-cA/cM,z:-cz/cM};cB=cI.x-cH.x;cA=cI.y-cH.y;cz=cI.z-cH.z;cM=Math.sqrt(cB*cB+cA*cA+cz*cz);var cC={x:cB/cM,y:cA/cM,z:cz/cM};var cy={x:cD.y*cC.z-cD.z*cC.y,y:cD.z*cC.x-cD.x*cC.z,z:cD.x*cC.y-cD.y*cC.x};cM=Math.sqrt(cy.x*cy.x+cy.y*cy.y+cy.z*cy.z);cy.x/=cM;cy.y/=cM;cy.z/=cM;var cx={x:cy.y*cC.z-cy.z*cC.y,y:cy.z*cC.x-cy.x*cC.z,z:cy.x*cC.y-cy.y*cC.x};cM=Math.sqrt(cx.x*cx.x+cx.y*cx.y+cx.z*cx.z);cx.x/=cM;cx.y/=cM;cx.z/=cM;var cF,cq,cp;var cv;var cG=8;var cJ;var cw={x:0,y:0,z:0};var co;var cs=-9999;var cK={x:0,y:0,z:0};for(var cE=0;cE<360;cE+=cG){cF=cE*B;cq=Math.cos(cF);cp=Math.sin(cF);cw.x=cL.x+cO*cq*cy.x+cO*cp*cx.x;cw.y=cL.y+cO*cq*cy.y+cO*cp*cx.y;cw.z=cL.z+cO*cq*cy.z+cO*cp*cx.z;cv=cN.Convert(cw.x,cw.y,cw.z);co=cN.GetScale(cw.x,cw.y,cw.z);if(co>cs){cs=co;cK.x=cw.x;cK.y=cw.y;cK.z=cw.z}}return cK}function cn(cN,cr,ct,cs,cK,cJ,cI){var cq={x:(cK.x+cJ.x)/2+10,y:(cK.y+cJ.y)/2+10,z:(cK.z+cJ.z)/2+10};var cA,cz,cy,cM;cA=cK.x-cq.x;cz=cK.y-cq.y;cy=cK.z-cq.z;cM=Math.sqrt(cA*cA+cz*cz+cy*cy);var cC={x:-cA/cM,y:-cz/cM,z:-cy/cM};cA=cK.x-cJ.x;cz=cK.y-cJ.y;cy=cK.z-cJ.z;cM=Math.sqrt(cA*cA+cz*cz+cy*cy);var cB={x:cA/cM,y:cz/cM,z:cy/cM};var cx={x:cC.y*cB.z-cC.z*cB.y,y:cC.z*cB.x-cC.x*cB.z,z:cC.x*cB.y-cC.y*cB.x};cM=Math.sqrt(cx.x*cx.x+cx.y*cx.y+cx.z*cx.z);cx.x/=cM;cx.y/=cM;cx.z/=cM;var cw={x:cx.y*cB.z-cx.z*cB.y,y:cx.z*cB.x-cx.x*cB.z,z:cx.x*cB.y-cx.y*cB.x};cM=Math.sqrt(cw.x*cw.x+cw.y*cw.y+cw.z*cw.z);cw.x/=cM;cw.y/=cM;cw.z/=cM;var cE,cp,co;var cu;cr.lineWidth=1;cr.lineCap="round";cr.strokeStyle="#000000";var cG=8;var cL;var cH,cO;var cv=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}];var cF;for(var cD=0;cD<360;cD+=cG){cE=cD*B;cL=((cD+cG+3)%360)*B;cp=Math.cos(cE);co=Math.sin(cE);cH=Math.cos(cL);cO=Math.sin(cL);cv[0].x=cK.x+aw*cp*cx.x+aw*co*cw.x;cv[0].y=cK.y+aw*cp*cx.y+aw*co*cw.y;cv[0].z=cK.z+aw*cp*cx.z+aw*co*cw.z;cv[1].x=cK.x+aw*cH*cx.x+aw*cO*cw.x;cv[1].y=cK.y+aw*cH*cx.y+aw*cO*cw.y;cv[1].z=cK.z+aw*cH*cx.z+aw*cO*cw.z;cv[2].x=cJ.x+aw*cH*cx.x+aw*cO*cw.x;cv[2].y=cJ.y+aw*cH*cx.y+aw*cO*cw.y;cv[2].z=cJ.z+aw*cH*cx.z+aw*cO*cw.z;cv[3].x=cJ.x+aw*cp*cx.x+aw*co*cw.x;cv[3].y=cJ.y+aw*cp*cx.y+aw*co*cw.y;cv[3].z=cJ.z+aw*cp*cx.z+aw*co*cw.z;cF=cN.Visible2(cv);if(cF.appear){cr.beginPath();cu=cN.Convert(cv[0].x,cv[0].y,cv[0].z);cr.moveTo(ct+cu.x,cs+cu.y);cu=cN.Convert(cv[1].x,cv[1].y,cv[1].z);cr.lineTo(ct+cu.x,cs+cu.y);cu=cN.Convert(cv[2].x,cv[2].y,cv[2].z);cr.lineTo(ct+cu.x,cs+cu.y);cu=cN.Convert(cv[3].x,cv[3].y,cv[3].z);cr.lineTo(ct+cu.x,cs+cu.y);cr.closePath();vr=(cF.angle)/180;cr.fillStyle="rgb("+Math.round(vr*cI.r)+","+Math.round(vr*cI.g)+","+Math.round(vr*cI.b)+")";cr.fill()}}}function a7(cR,db,cL,cK,cy,cW,cJ,cx,cw,c6,c5,cZ,cz,cM){db.clearRect(0,0,U,C);var cu=cR.distanceBetween(cx,cw);var cD=cZ;var cC=0.2*cz;var cF=cz-cC;var c3={x:(cx.x+cw.x)/2+10,y:(cx.y+cw.y)/2+10,z:(cx.z+cw.z)/2+10};var cs,cq,co,c8;var c1;cs=cx.x-cw.x;cq=cx.y-cw.y;co=cx.z-cw.z;c8=Math.sqrt(cs*cs+cq*cq+co*co);var cU={x:-cs/c8,y:-cq/c8,z:-co/c8};cs=cx.x-c3.x;cq=cx.y-c3.y;co=cx.z-c3.z;c8=Math.sqrt(cs*cs+cq*cq+co*co);var cX={x:-cs/c8,y:-cq/c8,z:-co/c8};cs=cx.x-cw.x;cq=cx.y-cw.y;co=cx.z-cw.z;c8=Math.sqrt(cs*cs+cq*cq+co*co);var cV={x:cs/c8,y:cq/c8,z:co/c8};var cS={x:cX.y*cV.z-cX.z*cV.y,y:cX.z*cV.x-cX.x*cV.z,z:cX.x*cV.y-cX.y*cV.x};c8=Math.sqrt(cS.x*cS.x+cS.y*cS.y+cS.z*cS.z);cS.x/=c8;cS.y/=c8;cS.z/=c8;var cQ={x:cS.y*cV.z-cS.z*cV.y,y:cS.z*cV.x-cS.x*cV.z,z:cS.x*cV.y-cS.y*cV.x};c8=Math.sqrt(cQ.x*cQ.x+cQ.y*cQ.y+cQ.z*cQ.z);cQ.x/=c8;cQ.y/=c8;cQ.z/=c8;c1=cz/5;var cr=cR.Convert(c6.x,c6.y,c6.z);var cp=cR.Convert(c5.x,c5.y,c5.z);if(cr.s<cp.s){bP(cy,cW+cr.x,cJ+cr.y,c1*cr.s,{r:255,g:255,b:255});bP(cy,cW+cp.x,cJ+cp.y,c1*cp.s,{r:255,g:255,b:255})}else{bP(cy,cW+cp.x,cJ+cp.y,c1*cp.s,{r:255,g:255,b:255});bP(cy,cW+cr.x,cJ+cr.y,c1*cr.s,{r:255,g:255,b:255})}var c0,ct,cA;var cP;var cv=8;var cG;var cI,cH;var cN=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}];var c4;var c7,cO,cT;var c2={x:0,y:0,z:0};var cE={x:0,y:0,z:0};var cB=4;var da;da=-(cz-cD)/((cu-cF)*(cu-cF));for(var c9=0;c9<=cu;c9+=cB){c7=c9;if(c9<=(cu-cF)){c1=cD+da*Math.pow((c7-(cu-cF)),2)+(cz-cD)}else{c1=cC+Math.sqrt(cF*cF-Math.pow(c7-(cu-cF),2))}c2.x=cx.x+cU.x*c7;c2.y=cx.y+cU.y*c7;c2.z=cx.z+cU.z*c7;c7=Math.min((c9+cB+1),cu);if(c7<=(cu-cF)){cT=cD+da*Math.pow((c7-(cu-cF)),2)+(cz-cD)}else{cT=cC+Math.sqrt(cF*cF-Math.pow(c7-(cu-cF),2))}cE.x=cx.x+cU.x*c7;cE.y=cx.y+cU.y*c7;cE.z=cx.z+cU.z*c7;for(var cY=0;cY<360;cY+=cv){c0=cY*Math.PI/180;cG=((cY+cv+1)%360)*Math.PI/180;ct=Math.cos(c0);cA=Math.sin(c0);cI=Math.cos(cG);cH=Math.sin(cG);cN[0].x=c2.x+c1*ct*cS.x+c1*cA*cQ.x;cN[0].y=c2.y+c1*ct*cS.y+c1*cA*cQ.y;cN[0].z=c2.z+c1*ct*cS.z+c1*cA*cQ.z;cN[1].x=c2.x+c1*cI*cS.x+c1*cH*cQ.x;cN[1].y=c2.y+c1*cI*cS.y+c1*cH*cQ.y;cN[1].z=c2.z+c1*cI*cS.z+c1*cH*cQ.z;cN[2].x=cE.x+cT*cI*cS.x+cT*cH*cQ.x;cN[2].y=cE.y+cT*cI*cS.y+cT*cH*cQ.y;cN[2].z=cE.z+cT*cI*cS.z+cT*cH*cQ.z;cN[3].x=cE.x+cT*ct*cS.x+cT*cA*cQ.x;cN[3].y=cE.y+cT*ct*cS.y+cT*cA*cQ.y;cN[3].z=cE.z+cT*ct*cS.z+cT*cA*cQ.z;c4=cR.Visible2(cN);if(c4.appear){db.beginPath();cP=cR.Convert(cN[0].x,cN[0].y,cN[0].z);db.moveTo(cL+cP.x,cK+cP.y);cP=cR.Convert(cN[1].x,cN[1].y,cN[1].z);db.lineTo(cL+cP.x,cK+cP.y);cP=cR.Convert(cN[2].x,cN[2].y,cN[2].z);db.lineTo(cL+cP.x,cK+cP.y);cP=cR.Convert(cN[3].x,cN[3].y,cN[3].z);db.lineTo(cL+cP.x,cK+cP.y);db.closePath();vr=0+1*(c4.angle)/180;db.fillStyle="rgba("+Math.round(vr*cM.r)+","+Math.round(vr*cM.g)+","+Math.round(vr*cM.b)+",1)";db.fill()}}}for(var cY=0;cY<360;cY+=cv){c0=cY*Math.PI/180;cG=((cY+cv+2)%360)*Math.PI/180;ct=Math.cos(c0);cA=Math.sin(c0);cI=Math.cos(cG);cH=Math.sin(cG);cN[0].x=cE.x+cT*ct*cS.x+cT*cA*cQ.x;cN[0].y=cE.y+cT*ct*cS.y+cT*cA*cQ.y;cN[0].z=cE.z+cT*ct*cS.z+cT*cA*cQ.z;cN[1].x=cE.x+cT*cI*cS.x+cT*cH*cQ.x;cN[1].y=cE.y+cT*cI*cS.y+cT*cH*cQ.y;cN[1].z=cE.z+cT*cI*cS.z+cT*cH*cQ.z;cN[2].x=cw.x;cN[2].y=cw.y;cN[2].z=cw.z;c4=cR.Visible2(cN);if(c4.appear){db.beginPath();cP=cR.Convert(cN[0].x,cN[0].y,cN[0].z);db.moveTo(cL+cP.x,cK+cP.y);cP=cR.Convert(cN[1].x,cN[1].y,cN[1].z);db.lineTo(cL+cP.x,cK+cP.y);cP=cR.Convert(cN[2].x,cN[2].y,cN[2].z);db.lineTo(cL+cP.x,cK+cP.y);db.closePath();vr=0+1*(c4.angle)/180;db.fillStyle="rgb("+Math.round(vr*cM.r)+","+Math.round(vr*cM.g)+","+Math.round(vr*cM.b)+",1)";db.fill()}}cy.globalAlpha=0.7;cy.drawImage(db.canvas,0,0,U,C,cW-U/2,cJ-C/2,U,C);cy.globalAlpha=1}CanvasRenderingContext2D.prototype.clearMe=function(){this.clearRect(0,0,this.canvas.width/ba,this.canvas.height/bR)};CanvasRenderingContext2D.prototype.drawShape=function(cp,co,cq){this.drawImage(N[cp.source],cp.x,cp.y,cp.width,cp.height,co-cp.ofsX,cq-cp.ofsY,cp.width,cp.height)};var b8=false;var bL=false;var ao;function aX(co){if(!co){var co=window.event}if(bL){co.preventDefault();co.stopPropagation()}else{downMode="mouse";bz(co,co.pageX,co.pageY)}}function bN(co){if(!co){var co=window.event}if(b8||bL){co.preventDefault();co.stopPropagation()}else{downMode="touch";var cp=co.targetTouches[0];ao=cp.identifier;bz(co,cp.pageX,cp.pageY)}}var aW,aU;var aQ;var ar={NONE:0,ROTATE:1,SELECTMENU:2};function bz(cr,cp,co){var cx=(cp-b3.x)/ba;var cu=(co-b3.y)/bR;const cv=window.devicePixelRatio||1;aW=cx/cv;aU=cu/cv;var cw,ct;aQ=ar.NONE;for(var cq=0;cq<b6.length;cq++){if(cx>=b6[cq].x1&&cx<b6[cq].x2&&cu>b6[cq].y1&&cu<b6[cq].y2){if((cq+2)!=aG){aG=cq+2;aa=0;am(aG,aa);e();bo();ap(aG,aa);k=true}aQ=ar.SELECTMENU;break}}if(aQ==ar.NONE){for(var cq=0;cq<aO.length;cq++){if(cx>=aO[cq].x1&&cx<aO[cq].x2&&cu>aO[cq].y1&&cu<aO[cq].y2){if(aO[cq].peb!=aa){aa=aO[cq].peb;am(aG,aa);e();bo();ap(aG,aa);k=true}aQ=ar.SELECTMENU;break}}}if(aQ==ar.NONE){cw=(cp-a8.x)/ba;ct=(co-a8.y)/bR;var cs=(downMode=="touch")?10:0;for(var cq=0;cq<ad.length;cq++){if(cw>=ad[cq].x1-cs&&cw<ad[cq].x2+cs&&ct>ad[cq].y1-cs&&ct<ad[cq].y2+cs){switch(cq){case 0:o=!o;bo();k=true;break;case 1:n=!n;bo();k=true;break;case 2:cb=!cb;bo();k=true;break;case 3:aR=!aR;bo();k=true;break;case 4:at=!at;bo();k=true;break}aQ=ar.SELECTMENU;break}}}if(aQ==ar.NONE){if(cu>(c-az/2-50)&&cu<(c+az/2+50)){ca=false;document.body.style.cursor="pointer";if(downMode=="mouse"){b8=true;document.addEventListener("mouseup",X);document.addEventListener("mousemove",a5)}else{bL=true;document.addEventListener("touchend",l);document.addEventListener("touchmove",bY)}}}}function X(co){if(!co){var co=window.event}co.preventDefault();co.stopPropagation();document.body.style.cursor="default";document.removeEventListener("mouseup",X);document.removeEventListener("mousemove",a5);a(co,(co.pageX-b3.x)/ba,(co.pageY-b3.y)/bR);b8=false;aQ=ar.PUSAT}function l(co){if(!co){var co=window.event}var cp=co.changedTouches[0];if(cp.identifier==ao){co.preventDefault();co.stopPropagation();document.body.style.cursor="default";document.removeEventListener("touchend",l);document.removeEventListener("touchmove",bY);a(co,(cp.pageX-b3.x)/ba,(cp.pageY-b3.y)/bR);bL=false;aQ=ar.PUSAT}}function a(cp,cq,co){document.body.style.cursor="default"}function a5(cp){if(!cp){var cp=window.event}cp.preventDefault();cp.stopPropagation();const co=window.devicePixelRatio||1;bK((cp.pageX-b3.x)/(ba*co),(cp.pageY-b3.y)/(bR*co))}function bY(cp){if(!cp){var cp=window.event}var cq=cp.changedTouches[0];if(cq.identifier==ao){cp.preventDefault();cp.stopPropagation();const co=window.devicePixelRatio||1;bK((cq.pageX-b3.x)/(ba*co),(cq.pageY-b3.y)/(bR*co))}}function bK(cs,cr){const cq=0.6*Math.pow((window.devicePixelRatio||1),0.05);var cp=(cs-aW)/cq;var co=(cr-aU)/cq;aW=cs;aU=cr;cj=0;O=co;aD=cp;k=true}function bg(cr,cq){var cp,co;co=1;for(cp=cq+1;cp<=cr;cp++){co=co*cp}for(cp=1;cp<=cr-cq;cp++){co=Math.floor(co/cp)}return co}function af(cr,cs,cq){var cp,co;co=bg(cs,cr);for(cp=1;cp<=cr;cp++){co=co*cq}for(cp=1;cp<=cs-cr;cp++){co=co*(1-cq)}return co}function p(cq,cu,cs){var cr,cp,co,ct;co=0;ct=0;for(cr=0;cr<=cu;cr++){cp=af(cr,cu,cq);co=co+cs[cr].x*cp;ct=ct+cs[cr].y*cp}return{x:co,y:ct}}function bV(co){var cp=curtop=0;if(co.offsetParent){do{cp+=co.offsetLeft;curtop+=co.offsetTop}while(co=co.offsetParent)}return{x:cp,y:curtop}}function F(co){var cw=container.offsetWidth;var cs=container.offsetHeight;var ct,cv;var cq,cp;switch(T){case"":case"default":ba=1;bR=1;ct=bq*ba;cv=aK*bR;cq=(cw-ct)/2;cp=(cs-cv)/2;break;case"auto":ba=Math.min(cw/bq,cs/aK);bR=ba;ct=bq*ba;cv=aK*bR;cq=(cw-ct)/2;cp=(cs-cv)/2;break;case"fit":ba=cw/bq;bR=cs/aK;ct=bq*ba;cv=aK*bR;cq=(cw-ct)/2;cp=(cs-cv)/2;break;case"fitwidth":ba=cw/bq;bR=ba;ct=bq*ba;cv=aK*bR;cq=(cw-ct)/2;cp=(cs-cv)/2;break;case"fitheight":bR=cs/aK;ba=bR;ct=bq*ba;cv=aK*bR;cq=(cw-ct)/2;cp=(cs-cv)/2;break}const cu=window.devicePixelRatio||1;for(var cr=0;cr<co.length;cr++){co[cr].canvas.getContext("2d").scale(ba,bR);co[cr].canvas.style.position="absolute";co[cr].canvas.style.left=cq+co[cr].x*ba+"px";co[cr].canvas.style.top=cp+co[cr].y*bR+"px";co[cr].canvas.width=co[cr].width*ba*cu;co[cr].canvas.height=co[cr].height*bR*cu;co[cr].canvas.style.width=co[cr].width*ba+"px";co[cr].canvas.style.height=co[cr].height*bR+"px";co[cr].canvas.getContext("2d").scale(ba*cu,bR*cu)}b3=bV(w);a8=bV(s)}function bW(){var co=/%/;if(co.test(container.style.width)||co.test(container.style.height)){F(canvasList)}b3=bV(w);a8=bV(s);aA()}(function(){function co(cq,cr){cr=cr||{bubbles:false,cancelable:false,detail:undefined};var cp=document.createEvent("CustomEvent");cp.initCustomEvent(cq,cr.bubbles,cr.cancelable,cr.detail);return cp}co.prototype=window.Event.prototype;window.CustomEvent=co})()};