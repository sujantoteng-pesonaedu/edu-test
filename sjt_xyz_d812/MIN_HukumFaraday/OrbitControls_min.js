THREE.OrbitControls=function(R,S,P){if(S===undefined){console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.')}if(S===document){console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.')}this.object=R;this.domElement=S;this.callback=P;this.enabled=false;this.target=new THREE.Vector3();this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=false;this.dampingFactor=0.05;this.enableZoom=true;this.zoomSpeed=1;this.enableRotate=true;this.rotateSpeed=1;this.enablePan=true;this.panSpeed=1;this.screenSpacePanning=false;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.enableKeys=true;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN};this.touches={ONE:THREE.TOUCH.ROTATE,TWO:THREE.TOUCH.DOLLY_PAN};this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this.getPolarAngle=function(){return W.phi};this.getAzimuthalAngle=function(){return W.theta};this.saveState=function(){N.target0.copy(N.target);N.position0.copy(N.object.position);N.zoom0=N.object.zoom};this.reset=function(){N.target.copy(N.target0);N.object.position.copy(N.position0);N.object.zoom=N.zoom0;N.object.updateProjectionMatrix();N.dispatchEvent(af);N.update();an=e.NONE};this.update=function(){var at=new THREE.Vector3();var aq=new THREE.Quaternion().setFromUnitVectors(R.up,new THREE.Vector3(0,1,0));var ar=aq.clone().inverse();var ap=new THREE.Vector3();var ao=new THREE.Quaternion();return function au(){var av=N.object.position;at.copy(av).sub(N.target);at.applyQuaternion(aq);W.setFromVector3(at);if(N.autoRotate&&an===e.NONE){A(f())}if(N.enableDamping){W.theta+=i.theta*N.dampingFactor;W.phi+=i.phi*N.dampingFactor}else{W.theta+=i.theta;W.phi+=i.phi}W.theta=Math.max(N.minAzimuthAngle,Math.min(N.maxAzimuthAngle,W.theta));W.phi=Math.max(N.minPolarAngle,Math.min(N.maxPolarAngle,W.phi));W.makeSafe();W.radius*=J;W.radius=Math.max(N.minDistance,Math.min(N.maxDistance,W.radius));if(N.enableDamping===true){N.target.addScaledVector(X,N.dampingFactor)}else{N.target.add(X)}at.setFromSpherical(W);at.applyQuaternion(ar);av.copy(N.target).add(at);N.object.lookAt(N.target);if(N.enableDamping===true){i.theta*=(1-N.dampingFactor);i.phi*=(1-N.dampingFactor);X.multiplyScalar(1-N.dampingFactor)}else{i.set(0,0,0);X.set(0,0,0)}J=1;if(L||ap.distanceToSquared(N.object.position)>c||8*(1-ao.dot(N.object.quaternion))>c){N.dispatchEvent(af);ap.copy(N.object.position);ao.copy(N.object.quaternion);L=false;return true}return false}}();this.dispose=function(){N.domElement.removeEventListener("contextmenu",H,false);N.domElement.removeEventListener("mousedown",ae,false);N.domElement.removeEventListener("touchstart",ad,false);N.domElement.removeEventListener("touchend",T,false);N.domElement.removeEventListener("touchmove",ag,false);document.removeEventListener("mousemove",a,false);document.removeEventListener("mouseup",ak,false);N.domElement.removeEventListener("keydown",j,false)};var N=this;var af={type:"change"};var V={type:"start"};var F={type:"end"};var e={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};var an=e.NONE;var c=0.000001;var W=new THREE.Spherical();var i=new THREE.Spherical();var J=1;var X=new THREE.Vector3();var L=false;var C=new THREE.Vector2();var u=new THREE.Vector2();var O=new THREE.Vector2();var d=new THREE.Vector2();var x=new THREE.Vector2();var q=new THREE.Vector2();var z=new THREE.Vector2();var b=new THREE.Vector2();var M=new THREE.Vector2();function f(){return 2*Math.PI/60/60*N.autoRotateSpeed}function K(){return Math.pow(0.95,N.zoomSpeed)}function A(ao){i.theta-=ao}function E(ao){i.phi-=ao}var p=function(){var ao=new THREE.Vector3();return function ap(ar,aq){ao.setFromMatrixColumn(aq,0);ao.multiplyScalar(-ar);X.add(ao)}}();var D=function(){var ao=new THREE.Vector3();return function ap(ar,aq){if(N.screenSpacePanning===true){ao.setFromMatrixColumn(aq,1)}else{ao.setFromMatrixColumn(aq,0);ao.crossVectors(N.object.up,ao)}ao.multiplyScalar(ar);X.add(ao)}}();var n=function(){var ap=new THREE.Vector3();return function ao(at,ar){var au=N.domElement;if(N.object.isPerspectiveCamera){var aq=N.object.position;ap.copy(aq).sub(N.target);var av=ap.length();av*=Math.tan((N.object.fov/2)*Math.PI/180);p(2*at*av/au.clientHeight,N.object.matrix);D(2*ar*av/au.clientHeight,N.object.matrix)}else{if(N.object.isOrthographicCamera){p(at*(N.object.right-N.object.left)/N.object.zoom/au.clientWidth,N.object.matrix);D(ar*(N.object.top-N.object.bottom)/N.object.zoom/au.clientHeight,N.object.matrix)}else{console.warn("WARNING: OrbitControls_min.js encountered an unknown camera type - pan disabled.");N.enablePan=false}}}}();function r(ao){if(N.object.isPerspectiveCamera){J/=ao}else{if(N.object.isOrthographicCamera){N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom*ao));N.object.updateProjectionMatrix();L=true}else{console.warn("WARNING: OrbitControls_min.js encountered an unknown camera type - dolly/zoom disabled.");N.enableZoom=false}}}function v(ao){if(N.object.isPerspectiveCamera){J*=ao}else{if(N.object.isOrthographicCamera){N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom/ao));N.object.updateProjectionMatrix();L=true}else{console.warn("WARNING: OrbitControls_min.js encountered an unknown camera type - dolly/zoom disabled.");N.enableZoom=false}}}function w(ao){C.set(ao.clientX,ao.clientY)}function Z(ao){z.set(ao.clientX,ao.clientY)}function I(ao){d.set(ao.clientX,ao.clientY)}function o(ap){u.set(ap.clientX,ap.clientY);O.subVectors(u,C).multiplyScalar(N.rotateSpeed);var ao=N.domElement;A(2*Math.PI*O.x/ao.clientHeight);E(2*Math.PI*O.y/ao.clientHeight);C.copy(u);N.update()}function am(ao){b.set(ao.clientX,ao.clientY);M.subVectors(b,z);if(M.y>0){r(K())}else{if(M.y<0){v(K())}}z.copy(b);N.update()}function l(ao){x.set(ao.clientX,ao.clientY);q.subVectors(x,d).multiplyScalar(N.panSpeed);n(q.x,q.y);d.copy(x);N.update()}function aj(){}function Y(ao){if(ao.deltaY<0){v(K())}else{if(ao.deltaY>0){r(K())}}N.update()}function h(ap){var ao=false;switch(ap.keyCode){case N.keys.UP:n(0,N.keyPanSpeed);ao=true;break;case N.keys.BOTTOM:n(0,-N.keyPanSpeed);ao=true;break;case N.keys.LEFT:n(N.keyPanSpeed,0);ao=true;break;case N.keys.RIGHT:n(-N.keyPanSpeed,0);ao=true;break}if(ao){ap.preventDefault();N.update()}}function k(ap){if(ap.touches.length==1){C.set(ap.touches[0].pageX,ap.touches[0].pageY)}else{var ao=0.5*(ap.touches[0].pageX+ap.touches[1].pageX);var aq=0.5*(ap.touches[0].pageY+ap.touches[1].pageY);C.set(ao,aq)}}function aa(ap){if(ap.touches.length==1){d.set(ap.touches[0].pageX,ap.touches[0].pageY)}else{var ao=0.5*(ap.touches[0].pageX+ap.touches[1].pageX);var aq=0.5*(ap.touches[0].pageY+ap.touches[1].pageY);d.set(ao,aq)}}function t(aq){var ap=aq.touches[0].pageX-aq.touches[1].pageX;var ao=aq.touches[0].pageY-aq.touches[1].pageY;var ar=Math.sqrt(ap*ap+ao*ao);z.set(0,ar)}function ai(ao){if(N.enableZoom){t(ao)}if(N.enablePan){aa(ao)}}function ah(ao){if(N.enableZoom){t(ao)}if(N.enableRotate){k(ao)}}function m(aq){if(aq.touches.length==1){u.set(aq.touches[0].pageX,aq.touches[0].pageY)}else{var ao=0.5*(aq.touches[0].pageX+aq.touches[1].pageX);var ar=0.5*(aq.touches[0].pageY+aq.touches[1].pageY);u.set(ao,ar)}O.subVectors(u,C).multiplyScalar(N.rotateSpeed);var ap=N.domElement;A(2*Math.PI*O.x/ap.clientHeight);E(2*Math.PI*O.y/ap.clientHeight);C.copy(u)}function s(ap){if(ap.touches.length==1){x.set(ap.touches[0].pageX,ap.touches[0].pageY)}else{var ao=0.5*(ap.touches[0].pageX+ap.touches[1].pageX);var aq=0.5*(ap.touches[0].pageY+ap.touches[1].pageY);x.set(ao,aq)}q.subVectors(x,d).multiplyScalar(N.panSpeed);n(q.x,q.y);d.copy(x)}function Q(aq){var ap=aq.touches[0].pageX-aq.touches[1].pageX;var ao=aq.touches[0].pageY-aq.touches[1].pageY;var ar=Math.sqrt(ap*ap+ao*ao);b.set(0,ar);M.set(0,Math.pow(b.y/z.y,N.zoomSpeed));r(M.y);z.copy(b)}function B(ao){if(N.enableZoom){Q(ao)}if(N.enablePan){s(ao)}}function y(ao){if(N.enableZoom){Q(ao)}if(N.enableRotate){m(ao)}}function g(){}var al=false;var ab=new THREE.Vector2();function ae(ao){if(N.enabled===false){return}ao.preventDefault();N.domElement.focus?N.domElement.focus():window.focus();switch(ao.button){case 0:switch(N.mouseButtons.LEFT){case THREE.MOUSE.ROTATE:if(ao.ctrlKey||ao.metaKey||ao.shiftKey){if(N.enablePan===false){return}I(ao);an=e.PAN}else{if(N.enableRotate===false){return}w(ao);al=true;ab.x=ao.clientX;ab.y=ao.clientY;an=e.ROTATE}break;case THREE.MOUSE.PAN:if(ao.ctrlKey||ao.metaKey||ao.shiftKey){if(N.enableRotate===false){return}w(ao);an=e.ROTATE}else{if(N.enablePan===false){return}I(ao);an=e.PAN}break;default:an=e.NONE}break;case 1:switch(N.mouseButtons.MIDDLE){case THREE.MOUSE.DOLLY:if(N.enableZoom===false){return}Z(ao);an=e.DOLLY;break;default:an=e.NONE}break;case 2:switch(N.mouseButtons.RIGHT){case THREE.MOUSE.ROTATE:if(N.enableRotate===false){return}w(ao);an=e.ROTATE;break;case THREE.MOUSE.PAN:if(N.enablePan===false){return}I(ao);an=e.PAN;break;default:an=e.NONE}break}if(an!==e.NONE){document.addEventListener("mousemove",a,false);document.addEventListener("mouseup",ak,false);N.dispatchEvent(V)}}function a(ar){if(N.enabled===false){return}ar.preventDefault();if(al){var ap=ar.clientX-ab.x;var ao=ar.clientY-ab.y;var aq=Math.sqrt(ap*ap+ao*ao);if(aq>5){al=false}}switch(an){case e.ROTATE:if(N.enableRotate===false){return}o(ar);break;case e.DOLLY:if(N.enableZoom===false){return}am(ar);break;case e.PAN:if(N.enablePan===false){return}l(ar);break}}function ak(ao){if(N.enabled===false){return}aj(ao);document.removeEventListener("mousemove",a,false);document.removeEventListener("mouseup",ak,false);N.dispatchEvent(F);an=e.NONE;if(al){al=false;ac()}}function U(ao){if(N.enabled===false||N.enableZoom===false||(an!==e.NONE&&an!==e.ROTATE)){return}ao.preventDefault();ao.stopPropagation();N.dispatchEvent(V);Y(ao);N.dispatchEvent(F)}function j(ao){if(N.enabled===false||N.enableKeys===false||N.enablePan===false){return}h(ao)}function ad(ao){if(N.enabled===false){return}ao.preventDefault();switch(ao.touches.length){case 1:switch(N.touches.ONE){case THREE.TOUCH.ROTATE:if(N.enableRotate===false){return}k(ao);al=true;ab.x=ao.targetTouches[0].clientX;ab.y=ao.targetTouches[0].clientY;an=e.TOUCH_ROTATE;break;case THREE.TOUCH.PAN:if(N.enablePan===false){return}aa(ao);an=e.TOUCH_PAN;break;default:an=e.NONE}break;case 2:switch(N.touches.TWO){case THREE.TOUCH.DOLLY_PAN:if(N.enableZoom===false&&N.enablePan===false){return}ai(ao);an=e.TOUCH_DOLLY_PAN;break;case THREE.TOUCH.DOLLY_ROTATE:if(N.enableZoom===false&&N.enableRotate===false){return}ah(ao);an=e.TOUCH_DOLLY_ROTATE;break;default:an=e.NONE}break;default:an=e.NONE}if(an!==e.NONE){N.dispatchEvent(V)}}function ag(ar){if(N.enabled===false){return}ar.preventDefault();ar.stopPropagation();if(al){var ap=ar.targetTouches[0].clientX-ab.x;var ao=ar.targetTouches[0].clientY-ab.y;var aq=Math.sqrt(ap*ap+ao*ao);if(aq>5){al=false}}switch(an){case e.TOUCH_ROTATE:if(N.enableRotate===false){return}m(ar);N.update();break;case e.TOUCH_PAN:if(N.enablePan===false){return}s(ar);N.update();break;case e.TOUCH_DOLLY_PAN:if(N.enableZoom===false&&N.enablePan===false){return}B(ar);N.update();break;case e.TOUCH_DOLLY_ROTATE:if(N.enableZoom===false&&N.enableRotate===false){return}y(ar);N.update();break;default:an=e.NONE}}function T(ao){if(N.enabled===false){return}g(ao);N.dispatchEvent(F);an=e.NONE;if(al){al=false;ac()}}function ac(){G("click",{mouse:ab})}function G(ap,ao){if(P!=null){P.apply(this,[ap,ao])}}function H(ao){if(N.enabled===false){return}ao.preventDefault()}N.domElement.addEventListener("contextmenu",H,false);N.domElement.addEventListener("mousedown",ae,false);N.domElement.addEventListener("touchstart",ad,false);N.domElement.addEventListener("touchend",T,false);N.domElement.addEventListener("touchmove",ag,false);N.domElement.addEventListener("keydown",j,false);if(N.domElement.tabIndex===-1){N.domElement.tabIndex=0}this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;THREE.MapControls=function(a,b){THREE.OrbitControls.call(this,a,b);this.mouseButtons.LEFT=THREE.MOUSE.PAN;this.mouseButtons.RIGHT=THREE.MOUSE.ROTATE;this.touches.ONE=THREE.TOUCH.PAN;this.touches.TWO=THREE.TOUCH.DOLLY_ROTATE};THREE.MapControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.MapControls.prototype.constructor=THREE.MapControls;