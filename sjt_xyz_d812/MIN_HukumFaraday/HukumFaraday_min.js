function HukumFaraday(){var p_containerName;var containerMode;var jsNames=new Array({name:"Base64Image_min.js"},{name:"Base64Font_min.js"},{name:"AdaptiveFontSize_min.js"},{name:"PesonaEduButton_min.js"},{name:"PesonaTextBlock_min.js"},{name:"fontTabel_min.js"},{name:"Bezier_min.js"},{name:"Faraday3DClass_min.js"},{name:"PesonaSoundGenerator_min.js"},{name:"OrbitControls_min.js"},{name:"TransformControls_R115_Customized_min.js"},{name:"FaradayExperiment_min.js"},{name:"BEOscilloscope_min.js"},{name:"BESnapshot_min.js"},{name:"MagnetMover_min.js"},{name:"gambar_min.js"},{name:"PesonaEduNewSlider_min.js"},{name:"MovingControl_min.js"});var jsLoadedCount;var imageAudioLoadedCount;var imageAudioNames=new Array();var imageAudioTotal=imageAudioNames.length;var imageAudioAssets=new Array(imageAudioTotal);var language="en";var usingLang=language;var speakLang="en-US";var message;this.setLanguage=function(lang){language=lang};var modeSoal=0;this.setMode=function(d){modeSoal=Math.max(0,Math.min(1,d))};var resetOnArrived=false;this.resetStorage=function(resets,suffix){resetOnArrived=resets;if(suffix!==undefined){storagePrefix+=suffix}};var isShowLoading=true;this.showLoading=function(sl){isShowLoading=sl};var p_containerName;var containerMode;var thinSpace="\u2009";var hairSpace="\u200A";var selisih=0;this.start=function(containerName,size){p_containerName=containerName;containerMode=size;const lessThan=thinSpace+"<"+thinSpace;switch(language){case"id":usingLang=language;speakLang="id-ID";message={title:"",loadingLibrary:"Sebentar... sedang memuat library ",loadingImage:"Sebentar... sedang memuat gambar/audio ",intro:"~b~Hukum Faraday~!b~ menyatakan bahwa tegangan listrik (~b~GGL induksi~!b~) muncul pada kumparan|~b~ketika jumlah garis-garis medan magnet yang masuk ke bidangnya berubah~!b~.|^|Semakin cepat perubahannya, semakin besar tegangannya.|^|Prinsip ini digunakan pada generator dan dinamo|untuk ~b~mengubah energi gerak menjadi energi listrik.~b~",U:"U",S:"S",flux:"Φ~s~~i~B~!i~~!s~",emf:"GGL",galvanometer:"Voltmeter",oscilloscope:"Osiloskop",gerak:"Gerak",magnet:"Batang magnet",coil:"Kumparan",bulb:"Bola lampu",strength:"Kuat kutub:",radius:"Radius:",turn:"Lilitan:",yScale:"Skala:",maxScale:"Skala maksimum:",kecepatanRotasi:"Kecepatan berputar:",kecepatanTranslasi:"Kecepatan bergerak:",gerakManual:"Gerakkan batang magnet atau kumparan. Perhatikan ~b~GGL induksi~!b~ yang dihasilkan.",magnetTerhalang:"⚠️ Putaran magnet terhalang kumparan! Ubah diameter kumparan atau pindah magnet.",kumparanTerhalang:"⚠️ Putaran kumparan terhalang magnet! Ubah diameter kumparan atau pindah magnet.",otomatis:"Otomatis",manual:"Manual",reset:"Kembali ke Pengaturan Awal"};break;case"en":default:usingLang="en";speakLang="en-US";message={title:"",loadingLibrary:"A moment... loading library ",loadingImage:"A moment... loading image/audio ",intro:"~b~Faraday’s Law~!b~ states that an electric voltage (~b~induced EMF~!b~) appears in a coil|~b~when the number of magnetic field lines entering its area changes~!b~.|^|The faster the change, the greater the voltage.|^|This principle is used in generators and dynamos|~b~to convert mechanical energy into electrical energy.~b~",U:"U",S:"S",flux:"Φ~s~~i~B~!i~~!s~",emf:"EMF",galvanometer:"Voltmeter",oscilloscope:"Oscilloscope",gerak:"Motion",magnet:"Bar magnet",coil:"Coil",bulb:"Light bulb",strength:"Pole strength:",radius:"Radius:",turn:"Turns:",yScale:"Scale:",maxScale:"Maximum scale:",kecepatanRotasi:"Rotational speed:",kecepatanTranslasi:"Translational speed:",gerakManual:"Move the bar magnet or the coil. Observe the ~b~induced EMF~!b~ produced.",magnetTerhalang:"⚠️ The magnet’s rotation is blocked by the coil! Change the coil diameter or move the magnet.",kumparanTerhalang:"⚠️ The coil’s rotation is blocked by the magnet! Change the coil diameter or move the coil.",otomatis:"Automatic",manual:"Manual",reset:"Reset to Default Settings"};break}if(isShowLoading){initSplashScreen()}letsBegin()};var splashDiv;var loadingLabel;function initSplashScreen(){var sheet=document.createElement("style");sheet.type="text/css";sheet.innerHTML=".modalDialog { position: fixed; font-family: Arial, Helvetica, sans-serif; top: 0; right: 0; bottom: 0; left: 0; z-index: 99999; opacity:1; -webkit-transition: opacity 400ms ease-in; -moz-transition: opacity 400ms ease-in; transition: opacity 400ms ease-in;} .modalDialog > div { display: table; color:#000000;  width: 60vmin; height: 12vmin; position: absolute; top:0;  bottom:0; left:0; right:0; margin:auto; padding: 0px 2vmin 0px 2vmin; border-radius: 2vmin; border:2px solid #303030; background: #ffffff; text-align:center; box-shadow: 0.3vmin 0.3vmin 0.3vmin rgba(0,0,0,0.5);}";document.body.appendChild(sheet);splashDiv=document.createElement("div");splashDiv.id="openModal";splashDiv.className="modalDialog";var mySubDiv=document.createElement("div");splashDiv.appendChild(mySubDiv);loadingLabel=document.createElement("p");loadingLabel.style.fontSize="2.5vmin";loadingLabel.style.display="table-cell";loadingLabel.style.verticalAlign="middle";loadingLabel.textContent="?";mySubDiv.appendChild(loadingLabel);document.body.appendChild(splashDiv)}function splashMessage(msg){if(typeof loadingLabel=="object"){loadingLabel.textContent=msg}}function endSplashScreen(){if(splashDiv){document.body.removeChild(splashDiv)}}var waitRequest;var waitList=new Array();var targetAfterWait;function waitLoop(){var f=true;for(var i=0;i<waitList.length;i++){f=f&&eval(waitList[i])}if(f){cancelAnimationFrame(waitRequest);if(targetAfterWait!=null){targetAfterWait()}}else{waitRequest=requestAnimFrame(waitLoop)}}function startWait(list,target){waitList.length=0;for(var i=0;i<list.length;i++){waitList.push(list[i])}targetAfterWait=target;waitLoop()}function clearWait(){cancelAnimationFrame(waitRequest)}var storagePrefixHead="PEDU_2025_Fisika";var storagePrefix=storagePrefixHead+"_HukumFaraday_GGL_3D";const canvasWidth=1000;const canvasHeight=800;var container;var canvasPos;var xScale=1;var yScale=1;var xGlobal,yGlobal;var mainCanvas,mainContext;var viewCanvas,viewContext;var symbolNCanvas,symbolNContext;var symbolSCanvas,symbolSContext;var waitJs;var waitImageAudio;var waitGetImage;var waitOpenDB;var waitReadDB;var canvasList;function letsBegin(){waitJs=false;jsLoadedCount=1;includeJs("PesonaBasic_min.js");startWait(["waitJs"],letsBegin0)}function letsBegin0(){waitJs=false;jsLoadedCount=1;includeJs("three.min.js");startWait(["waitJs"],letsBegin1)}const batasIntro={x:0,y:550};const batasSoal={x:0,y:400};const menuBentukPos={x:50,y:batasSoal.y+35};var solutionPos={width:canvasWidth,height:canvasHeight-(batasSoal.y+15),x:0,y:batasSoal.y+15};function letsBegin1(){container=document.getElementById(p_containerName);var res=PesonaBasic.setStageMode(container,canvasWidth,canvasHeight,containerMode);xScale=res.scale.x;yScale=res.scale.y;xGlobal=res.pos.x;yGlobal=res.pos.y;mainCanvas=document.createElement("canvas");mainContext=PesonaBasic.addCanvas("main",{canvas:mainCanvas,index:0,x:0,y:0,width:canvasWidth,height:canvasHeight},true);mainCanvas.style.backgroundColor="#f4f4f4";letsBegin2()}function letsBegin2(){if(jsNames.length==0){waitJs=true}else{waitJs=false;jsLoadedCount=jsNames.length;for(var i=0;i<jsNames.length;i++){splashMessage(message.loadingLibrary+(i+1)+"/"+jsNames.length);includeJs(jsNames[i].name)}}window.addEventListener("resize",winResizeOpening,false);startOpeningAnimation(mainContext,canvasWidth/2,canvasHeight/2);startWait(["waitJs"],AyoMulai)}function includeJs(jsFilePath){var js=document.createElement("script");js.type="text/javascript";js.src=jsFilePath;js.onreadystatechange=jsLoad_callback;js.onload=jsLoad_callback;var head=document.getElementsByTagName("head").item(0);head.appendChild(js)}function jsLoad_callback(){jsLoadedCount--;if(jsLoadedCount==0){waitJs=true}}var oShape_0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJcAAAAgCAMAAAAojhqGAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAADbUExURUdwTMzMzMXFxczMzMzMzMzMzMzMzGdnZ66urszMzMzMzMrKysvLy8zMzMzMzGZmZsvLy8fHx8zMzMzMzMvLy8zMzMnJyWBgYLOzs8zMzMzMzMvLy2ZmZmZmZmZmZsrKyszMzEhISGVlZczMzMzMzMfHx8jIyMzMzGVlZWZmZmZmZmJiYmVlZWVlZWVlZWVlZczMzMzMzMzMzMvLy8zMzMzMzGZmZmZmZsvLy8vLy2JiYmVlZWRkZMzMzMvLy8zMzMnJyWVlZWRkZGVlZWZmZmVlZWZmZszMzGZmZk1ifvkAAABHdFJOUwCGDoyV8P0BBeW7MUFtVOQrE/tzUPQeEAqv7F3ul/xKwAVS4p8tGaVFv/UchWFspsXf9nlo04q3ZIIudCz3Otc4jjI5K9PXSQsFUwAAAdZJREFUWMPNmNlygjAUhnFFRcWdVlEFV0Cxi1WrdlHbJu//RO3oDAZIjlwkTv/rb775hZhwIklEtKNpTnaGdC3l91qxW8rchtvsf/AptuVqgERJfKBT3nqFsnDusMJE7CWrmZJDROqJuFDOmHawP+qEZsnE0sifbF4gp61wKB03rInnUCjpgjBOszAt26Dm7gHRUhXEyXNMj+nXyPeInpoYbsaohXXH51kzNCg18nELPpyms3rhuW+TSbE8aCyCm2J2vghPjKlB6RJ/ztCBXm3iL91ke1CSPzcBamFd9jxdQIOa/Lk91AsfPE8C8iCFO2eBvWaepwd61tw5Few19Tx90BPjzulgr8vCT4GeJHfuv/aK+h4fQc8rdy7qus+BnhZ3bgn22kXZnv9S4s6B+6p62QfzkCbLn5OhBbYkzo0s4EkI4LbsWh3yQ+eZrak0BHCaGuXYlqR4NspxzJEzmavLPxQVmauhLIZrM95icCRKMp56XhBnrKi1ZqGpivpBnm4J4wzK5GGblHFvENY8FUVyrh2o9b2hjseLekDzMhTLOW1y4lZd1uVJY1AhV2ghI5xzttb5oalzE7rSGVVz5x/ZH9cyt+Fk53DcaFevhSS5oXwO40K5X4ZVHmW6N5M7AAAAAElFTkSuQmCC";var oShape_1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJcAAAAgCAMAAAAojhqGAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAADbUExURUdwTMzMzMzMzMzMzMrKyiMjI8zMzLGxsczMzMzMzMfHx8vLy8zMzMbGxszMzMzMzMfHx8vLy8zMzGZmZszMzGZmZl1dXczMzLOzs2VlZcvLy0hISGZmZmZmZmRkZMzMzMzMzMvLy8zMzGZmZmJiYszMzMrKymZmZsvLy2VlZczMzGRkZMvLy8zMzGVlZczMzGVlZczMzMvLy8zMzMvLy8zMzMvLy8rKymVlZcrKymVlZWVlZWZmZsvLy8zMzMvLy8zMzMjIyMvLy2VlZcvLy2RkZGZmZszMzGZmZtHRHGQAAABHdFJOUwCGU+IrAfAE/OUNQpkSjPgaTvOIlvoOuwqVaAXx4Syv7DLAvBqiL+hkU5A1uXJmxUHQXG15p4JfbCF0pEtJazrXNxivdF3LcvS4/QAAAj5JREFUWMPNmNtW6jAQhgsUClVO1oII7VZbZVeU7T4pAp7V5P2fyLV0GdI2mfkvvHBu51sf/2pD0onjaNW+61dv3D2Hq8Fsna3jMcuhPpI76dyL9+oe3bYJSRxE8r3CZDEgONRHc4dnQqudjm+xzBKp1SSwJUN9NOdVmiJfrS2TZRyEMl/TCxOH+hjOPxOlav41rKtElipclDl/iPkYbu+XMNVzwVIfv0pTLYs/B/ps3Pnn7/0Q5qoWcj1Jc2UFDvUx3L6lLRq9nGduiSUnaY5DfQzXbtj64r+uSSe2XHKV24xAH8dVhL1czRNIe8UaR/iaLs55B0SuXW2LmBK5RtpfH/RxXJ9oiwNPedZELDmtKw71cdwp1ReHyjOicsmZ4lAfxx2R/Z/Kk5C55opDfRxXI/sV5YnIXIHiUB/HNcj+ZqFOyFybhY/6OO575jplnuflF7/HS5gbkv0rcN2/KA71cVyF7LvQdq9v+KiP47aodmuzX15QsaINh/o4zmsR/Y72VRJBywv2sdw/4vy81s7ZpT1WqH/ooD6O81vIMes4gylybOM+lqta33J+bMqsp3Z+KEJ9LLdreZrFEcZydIfFkQj1bTOcZ/zQbv4pTWnGD/zwpTR9gT6W847L7W7VMD6uDLEyw1gI+nhuf6fQ/u0ax+N58Zh8jY0c6mO53nZX69ZuPcvcno70iTta2C5PUB/PPZ4PP8LXjvsecc+RLpOPhxatMupKB/UBXL138uD67LWQU0/jWTwAONRX5t4AYOEfWNlsmKIAAAAASUVORK5CYII=";var oShape_2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJcAAAAgCAMAAAAojhqGAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAADYUExURUdwTMzMzMzMzMzMzMzMzMbGxiMjI7CwsMzMzMnJyczMzMfHx8vLy2ZmZszMzMzMzMzMzMfHx8vLy8zMzMzMzMzMzGRkZGZmZkhISGZmZmZmZmZmZszMzMzMzMvLy8vLy7W1tczMzGVlZWZmZsvLy8rKyltbW8zMzGFhYWZmZmVlZcvLy2VlZWVlZWJiYmZmZszMzMzMzMzMzGVlZcvLy8zMzGZmZsvLy8zMzMvLy8vLy8vLy8zMzGRkZMvLy8zMzMrKymVlZcvLy2ZmZsvLy8rKyszMzGZmZqICWfQAAABGdFJOUwCX8Ib8DgEE5Sy6E0Lk4Yz4GU3zklQs/AW974hn7F0yCMBtmqEhDW0T9WFTkVQcTNCxrUF0xa1kqINrSWw0Otc0fXjUeW45fb/OAAACHElEQVRYw72Ya1OCQBSGvYJopFgCSFcsQ1Ot7F5WZu3+/39UozO4yO7hhWZ6v55nHs8s6y6HQkFI463deTFOCmlBuXA+HU9t928+o/nOVmmdvjYICcrZoyVfZeAFYW7fcZ0J2WtWFRaUm3tcyMDv5/Lp5QqLp7Yjs6Cc6zs8HnOWw1ets0QqF0kNyvU9nogTZPad3DFZbrc1KCdr6zdBRp92w+S5jGtg7p7LM87mO1CUWcmKeVAuULTFu5MsvkZJVWePsUMG5MKuqi9+n8VXZuoYgofgKiLnK9vijo379EOir6LwlwY5V71cnPdwX5sos0M98qDclGjL6Wqwb5+qs+PIg3IjTmUO+07J+kPkQTmP7GsI+3bJejnyoJxJ9uXDvhJZ32xomtuPuC7Z1wj2ob/3333R6/kErvsT+BwXsK9O1o8iD8qh+z7NVybrBnI8xzif7MuGfTtUubY5B1FuRrVl4j69RtSbwr0BcpoJHRPpvk/i/jwX7lmUWxD3kPii85Xiq9aQ6xjn+iZybQO+jvIpx8cmlBsrd1eYzVdUrOb2qINyPcVTnGX06dfS8lFiqgI5V/qC7wwz+/SzZLnVkYx7IOdKVmwwBn2xKeZgb6t8ZUjHY5DThtvX5NLO57OKLXHnPeuKuR3lJj1x4jYDN7fPuqivm989a+vEdw6UCwNvsG6qN6U+6VjfqT7NMj6MaupnIZyb2HO7n8v3A8O1EhGNxVhmAAAAAElFTkSuQmCC";var oShape_3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJcAAAAgCAMAAAAojhqGAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAADhUExURUdwTAEBAczMzMfHx8zMzMrKyszMzLCwsMzMzMzMzMzMzMvLy8vLy8zMzMzMzMzMzMfHx8zMzMzMzMzMzMvLy2ZmZkhISGZmZmZmZmRkZMvLy8zMzMzMzMzMzGZmZsrKyszMzMfHx2ZmZszMzKampsrKysjIyGZmZltbW2VlZWJiYmVlZWBgYGZmZmRkZMrKyrOzs8zMzMvLy8zMzMrKysvLy8zMzMzMzGRkZMvLy8zMzMvLy8PDw2VlZWZmZmZmZmVlZWZmZmZmZre3t8vLy8zMzGVlZWZmZmZmZszMzGZmZto5h7AAAABJdFJOUwABhg2XK/0D5fG7MGZUcqQS+vbjTogFvvwsQeyRi+VHwBv0bAU4Ge4NUxtwEpM1XwqxXK0hU9DFQ4PfeBVp4UtfmKQHjdev1Hn//h9jAAACDklEQVRYw62Y51rCMBSGwyhTREaXyp5lubdMZ3L/FyRDS0KSU9Tz/c37vD2kKckJIVyOWsVMxXghQcHmBqOpN3Ut9WD69Y2uk682jgAJNueaH2ydut0fyJYU5ZIvRXRPQ+ZGNuNSN7vCaDMco2ISFZUFm7NMh4kp33PDkRSVEjuUNf/iGjLXtZkUp+8Pn99RVaQHYnOqspb5KSx0RdW5ETXo3DtTx9uMH2g0NFkTPNjcWFMW6/RWw89JnYdmeQ02N+jo6mKL1XiY6mNwHoCL/YUztWUxxyWkeQLUFeU+fWTO0k8XY0NCioCGnsR9DzY3BcpinTg5hTw07XuwuSFUFxuRKug58D3YnA3WNSMF0BP2PdjcBKzLJEnQs12o2FwdrGsY4Dnd83m/5zoBdT2Cngffg82B79ExSQr0nPkebC5o3YdBj7HP3/ifOBOsyyXHkCYR8j3Y3D1UVjlE4gnAU9ruG+hcGfybIORJr8ldc/ssNvcJLPvVQSeS2Gebxee6+gmbr4GMdjWI7RU252lX13e7FtXM+vHOeRybm2ve4k9L1LxQHuIupe4LmbOUB3xnthVlZU0+o2gLkTlrIZdV94ReYXdbuzWU7TE2N97dvj9cEahFc5yl0Ghq+nZsrjfnO+7yWL48aR+mNj+ykC02gXsObK7XtzeTNll4miudUDvdMiKB10L4XM8dueKNyRejEDZnH1/mnAAAAABJRU5ErkJggg==";var openingShapes=[oShape_0,oShape_1,oShape_2,oShape_3];var openingSquence=[[{shape:0,x:0,y:0}],[{shape:1,x:0,y:0}],[{shape:2,x:0,y:0}],[{shape:3,x:0,y:0}],[{shape:2,x:0,y:0}],[{shape:1,x:0,y:0}]];var openingImage=new Array();var openingContext;var openingW,openingH;var openingX,openingY;var openingRequest;var openingAnimateTs;var openingInterval=120;var openingWantToStop=false;var openingNextTarget;var openingLama;function startOpeningAnimation(context,xOrg,yOrg){openingWantToStop=false;openingContext=context;openingX=xOrg;openingY=yOrg;var count=openingShapes.length;openingImage.length=0;for(var i=0;i<openingShapes.length;i++){openingImage.push(new Image());openingImage[i].addEventListener("load",function(e){count--;if(count==0){startOpeningAnimation0()}});openingImage[i].src=openingShapes[i]}}function startOpeningAnimation0(){openingW=openingImage[0].width;openingH=openingImage[0].height;openingX-=openingW/2;openingY-=openingH/2;openingAnimateTs=Date.now();openingLoop()}function stopOpeningAnimation(lama,target){openingLama=lama;openingNextTarget=target;openingWantToStop=true}function openingLoop(){var t=Date.now()-openingAnimateTs;openingAnimation(t);if(openingWantToStop){if(t>=openingLama){cancelAnimationFrame(openingRequest);openingContext.clearRect(openingX-3,openingY-3,openingW+6,openingH+6);openingNextTarget.apply(this)}else{openingRequest=requestAnimFrame(openingLoop)}}else{openingRequest=requestAnimFrame(openingLoop)}}function openingAnimation(t){var n=(Math.floor(t/openingInterval))%openingSquence.length;openingContext.clearRect(openingX-3,openingY-3,openingW+6,openingH+6);for(var i=0;i<openingSquence[n].length;i++){openingContext.drawImage(openingImage[openingSquence[n][i].shape],openingX+openingSquence[n][i].x,openingY+openingSquence[n][i].y)}}var base64Image;var imageCount;var sImage=new Array();var imageList=[];var indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB;var storeDB;function AyoMulai(){waitImageAudio=false;if(imageAudioTotal==0){waitImageAudio=true}else{imageAudioLoadedCount=imageAudioTotal;for(var i=0;i<imageAudioTotal;i++){splashMessage(message.loadingImage+(i+1)+"/"+imageAudioTotal);switch(imageAudioNames[i].type){case"image":imageAudioAssets[imageAudioNames[i].index]=new Image();imageAudioAssets[imageAudioNames[i].index].addEventListener("load",eventImageAudioLoaded,false);imageAudioAssets[imageAudioNames[i].index].src="images/"+imageAudioNames[i].name;break;case"audio":imageAudioAssets[imageAudioNames[i].index]=new Audio();imageAudioAssets[imageAudioNames[i].index].innerHTML='<source src="audios/'+imageAudioNames[i].name+'.ogg" type="audio/ogg"><source src="audios/'+imageAudioNames[i].name+'.aac" type="audio/mpeg"><source src="audios/'+imageAudioNames[i].name+'.mp3" type="audio/mp3">';imageAudioAssets[imageAudioNames[i].index].preload="auto";imageAudioLoadedCount--;waitImageAudio=(imageAudioLoadedCount==0);break}}}base64Image=new Base64Image(imageCreated);var imgIdx=Object.keys(imageTable);imageList.length=0;var f;for(var i=0;i<imgIdx.length;i++){if(imageTable[imgIdx[i]].lang){f=(imageTable[imgIdx[i]].lang==usingLang)}else{f=true}if(f){imageList.push({index:imageTable[imgIdx[i]].index,object:imageTable[imgIdx[i]].object,action:imageTable[imgIdx[i]].action})}}imageCount=imageList.length;if(imageCount==0){waitGetImage=true}for(var i=0;i<imageCount;i++){base64Image.getImage(imageList[i].index,imageList[i].object)}waitOpenDB=true;startWait(["waitImageAudio","waitGetImage","waitOpenDB"],Mulai)}function eventImageAudioLoaded(){imageAudioLoadedCount--;if(imageAudioLoadedCount==0){waitImageAudio=true}}function imageCreated(tag,para){if(tag=="created"){sImage[para.id]=para.image;if(sImage[para.id].width==0){sImage[para.id].width=para.width}if(sImage[para.id].height==0){sImage[para.id].height=para.height}imageCount--;if(imageCount==0){waitGetImage=true}}}function Mulai(){Mulai0()}var waitFont=false;var fontCount=0;function Mulai0(){waitFont=(fontTable.length==0);var base64Font=new Base64Font(fontLoaded);fontCount=fontTable.length;for(var i=0;i<fontTable.length;i++){base64Font.load(fontTable[i].index,fontTable[i].object)}startWait(["waitFont"],Mulai1)}function fontLoaded(tag,para){if(tag=="loaded"){fontCount--;if(fontCount==0){waitFont=true}}}function Mulai1(){Mulai2()}function Mulai2(){endSplashScreen();Mulai3()}function Mulai3(){Mulai4()}var buttons=new Array();var butSnapshot=new Array();var butPlug;var butMagnetField;var butElectrons;var butB;var butMagnetTurn;var butMaxMin;var butSpeaker;var butGerakManual,butGerakOtomatis;var butOtomatisMagnetLinier,butOtomatisCoilLinier;var butOtomatisMagnetRotasi,butOtomatisCoilRotasi;var butTipeOtomatis=new Array();var font80;function Mulai4(){butPlug=new PesonaEduButton({name:"plug",stat:true,tag:""},-1,0,0,{width:40,height:48,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},null,false,false,null);buttons.push(butPlug);butMagnetField=new PesonaEduButton({name:"magnetField",stat:true,tag:"magnetField"},-1,0,0,{width:56,height:40,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},null,false,false,null);buttons.push(butMagnetField);butMagnetTurn=new PesonaEduButton({name:"magnetTurn",stat:true},-1,0,0,{width:56,height:40,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},null,false,false,null);buttons.push(butMagnetTurn);butElectrons=new PesonaEduButton({name:"electrons",stat:false,tag:"electrons"},-1,0,0,{width:56,height:40,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},null,false,false,null);buttons.push(butElectrons);butB=new PesonaEduButton({name:"B",stat:false,tag:"B"},-1,0,0,{width:56,height:40,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},null,false,false,null);buttons.push(butB);butGerakManual=new PesonaEduButton({name:"manual",stat:false,label:message.manual},-1,0,0,{width:90,height:40,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},{func:iconFixed,par:[1]},null,false,false,null);buttons.push(butGerakManual);butGerakOtomatis=new PesonaEduButton({name:"otomatis",stat:false,label:message.otomatis},-1,0,0,{width:90,height:40,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},{func:iconFixed,par:[1]},null,false,false,null);buttons.push(butGerakOtomatis);butTipeOtomatis.push(new PesonaEduButton({name:"tipeOtomatis",index:0,stat:false,icon:"icon_TipeAuto_1"},-1,0,0,{width:90,height:32,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},{func:iconFixed,par:[1]},null,false,false,null));buttons.push(butTipeOtomatis[0]);butTipeOtomatis.push(new PesonaEduButton({name:"tipeOtomatis",index:1,stat:false,icon:"icon_TipeAuto_2"},-1,0,0,{width:90,height:32,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},{func:iconFixed,par:[1]},null,false,false,null));buttons.push(butTipeOtomatis[1]);butTipeOtomatis.push(new PesonaEduButton({name:"tipeOtomatis",index:2,stat:false,icon:"icon_TipeAuto_3"},-1,0,0,{width:90,height:32,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},{func:iconFixed,par:[1]},null,false,false,null));buttons.push(butTipeOtomatis[2]);butTipeOtomatis.push(new PesonaEduButton({name:"tipeOtomatis",index:3,stat:false,icon:"icon_TipeAuto_4"},-1,0,0,{width:90,height:32,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},{func:iconFixed,par:[1]},null,false,false,null));buttons.push(butTipeOtomatis[3]);butSpeaker=new PesonaEduButton({name:"speaker",stat:false,tag:""},-1,0,0,{width:40,height:48,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},null,false,false,null);buttons.push(butSpeaker);for(var i=0;i<buttons.length;i++){buttons[i].setCallback(tombolHandler)}window.removeEventListener("resize",winResizeOpening);window.addEventListener("resize",winResize,false);container.addEventListener("touchstart",containerTouchDown,false);mainCanvas.addEventListener("mousedown",canvasMouseDown);mainCanvas.addEventListener("touchstart",canvasTouchDown);mainCanvas.addEventListener("wheel",canvasMouseWheel);window.addEventListener("beforeunload",wantToClose);document.addEventListener("visibilitychange",handleVisibilityChange,false);mulaiMain()}function keyinHandler(e){for(var i=0;i<buttons.length;i++){if(buttons[i].keyin(e.key)){break}}}var haltTime;function handleVisibilityChange(){if(document.hidden){haltTime=Date.now();if(faraday){faraday.pauseSound()}}else{if(haltTime){var dt=Date.now()-haltTime;if(faraday){faraday.afterTimeBreak(dt);faraday.continueSound()}}}}function openDB(callback){var request=indexedDB.open(storagePrefix+"DB",1);request.onerror=function(event){callback(false)};request.onsuccess=function(event){storeDB=request.result;callback(true)};request.onupgradeneeded=function(event){var db=event.target.result;var objectStore=db.createObjectStore(storagePrefix+"hasil",{keyPath:"id"})}}function writeDB(id,isi){if(storeDB){var request=storeDB.transaction(storagePrefix+"hasil","readwrite").objectStore(storagePrefix+"hasil").put({id:id,isi:isi})}}function readDB(id,callback){if(storeDB){var request=storeDB.transaction(storagePrefix+"hasil","readonly").objectStore(storagePrefix+"hasil").get(id);request.onerror=function(event){callback(null,id)};request.onsuccess=function(event){callback(request.result,id)}}else{callback(null,id)}}function openDBCallback(f){if(f){waitOpenDB=true}else{console.log("open db fail")}}function firstLoadResultSuccess(res,id){if(res!=null){uncompressImageData(res.isi,rumahImg[id]);showImage();if(id==nRumah){adaSimpanan=true}}rumahCount--;if(rumahCount<=0){waitReadDB=true}}function wantToClose(e){}function containerTouchDown(e){var res=PesonaBasic.getStage();if(!e){var e=window.event}var touch=e.targetTouches[0];var x=(touch.pageX-res.pos.x)/res.scale.x;var y=(touch.pageY-res.pos.y)/res.scale.y;if(x>=0&&x<canvasWidth&&y>=0&&y<canvasHeight){e.preventDefault();e.stopPropagation()}}function writeLocalStorage(key,val){try{if(typeof(Storage)!=="undefined"){localStorage.setItem(key,val)}}catch(e){}}window.requestAnimFrame=(function(callback){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1000/60)}})();window.cancelRequestAnimFrame=(function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout})();var animRequest;function AnimationLoop(){faraday.loop();magMover.loop();animRequest=requestAnimFrame(AnimationLoop)}function refreshAll(){for(var i=0;i<buttons.length;i++){buttons[i].redraw()}for(var i=0;i<sliders.length;i++){sliders[i].redraw()}for(var i=0;i<BESs.length;i++){BESs[i].redraw()}for(var i=0;i<movingControls.length;i++){movingControls[i].redraw()}BEOsc.redraw();faraday.redraw();magMover.redraw();drawMainMenu()}const D2R=Math.PI/180;const R2D=180/Math.PI;const PI360=2*Math.PI;const PI90=0.5*Math.PI;const PI270=1.5*Math.PI;var faraday;var BEOsc;var BESs=new Array(3);var magMover;var timerHdl;var maxMin=0;var shotN=0;var sliderRadius,sliderTurn;var sliderStrength;var sliderOscScale;var sliderGalvaScale;var sliderKecepatanRotasi;var sliderKeceparanTranslasi;var sliders=new Array();var movingControls=new Array();var CR100Shift,CRL100Shift;var QFTs=0;var QFStart=false;var QFCount=0;var parameterAwal;function mulaiMain(){CR100Shift=AdaptiveFontSize.getVerticalCenteringDelta("100px CRL","A")/100;CRL100Shift=AdaptiveFontSize.getVerticalCenteringDelta("100px CRL","A")/100;sliderRadius=new PesonaEduNewSlider({name:"sRad",label:message.radius},0,0,0,200,56,20,30,160,2*10,8*10,6*10,slider_handler);sliders.push(sliderRadius);sliderTurn=new PesonaEduNewSlider({name:"sTurn",label:message.turn},0,0,0,160,56,20,30,120,1,10,1,slider_handler);sliders.push(sliderTurn);sliderStrength=new PesonaEduNewSlider({name:"sStrength",label:message.strength},0,0,0,200,56,20,30,160,0.5*20,2*20,1*20,slider_handler);sliders.push(sliderStrength);sliderOscScale=new PesonaEduNewSlider({name:"sOscScale",label:message.yScale},0,0,0,200,56,20,30,160,0,100,50,slider_handler);sliders.push(sliderOscScale);sliderGalvaScale=new PesonaEduNewSlider({name:"sGalvaScale",label:message.maxScale},0,0,0,200,56,20,30,160,0,50,30,slider_handler);sliders.push(sliderGalvaScale);var def=Math.log10(2000)*50;sliderKecepatanRotasi=new PesonaEduNewSlider({name:"sRotasi",label:message.kecepatanRotasi},0,0,0,200,56,20,30,160,115,215,def,slider_handler);sliders.push(sliderKecepatanRotasi);var def=Math.log10(2000)*50;sliderKecepatanTranslasi=new PesonaEduNewSlider({name:"sTranslasi",label:message.kecepatanTranslasi},0,0,0,200,56,20,30,160,115,215,def,slider_handler);sliders.push(sliderKecepatanTranslasi);var x=200;var y=678;movingControls.push(new MovingControl("mc_0",0,0,x,y,sImage,{center:{x:3,y:0},amp:12},"#ffaaaa",movingControls_Handle));movingControls.push(new MovingControl("mc_1",1,1,x,y,sImage,{center:{x:-3,y:0},amp:16},"#aaffaa",movingControls_Handle));movingControls.push(new MovingControl("mc_2",2,2,x,y,sImage,{center:{x:1.5,y:0},amp:0},"#aaffff",movingControls_Handle));movingControls.push(new MovingControl("mc_3",3,3,x,y,sImage,{center:{x:0,y:0},amp:0},"#ffffaa",movingControls_Handle));var x=canvasWidth-160-32;var y=22;BEOsc=new BEOscilloscope(x,y,160,120,message);y+=120+60;for(var i=0;i<BESs.length;i++){BESs[i]=new BESnapshot(i,x-5,y,160,120);BESs[i].stat=false;BESs[i].visible(false);y+=137;butSnapshot.push(new PesonaEduButton({name:"snapshot",index:i,stat:true},-1,0,0,{width:38,height:38,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.9]},{func:areaTombol,par:[0.9]},null,false,false,null));buttons.push(butSnapshot[i]);butSnapshot[i].setCallback(tombolHandler)}faraday=new FaradayExperiment("Faraday",16,16,message,sImage,movingControls,faradayHandler);magMover=new MagnetMover(canvasWidth-766,632,750,150,moverHandler);butMaxMin=new PesonaEduButton({name:"maxmin",stat:false},-1,0,0,{width:50,height:36,margin:{left:2,right:2,top:2,bottom:2}},{func:iconTombol,par:[1]},{func:areaTombol,par:[1]},{func:iconTombol,par:[0.95]},{func:areaTombol,par:[0.95]},null,false,false,null,null,true);buttons.push(butMaxMin);butMaxMin.setCallback(tombolHandler)}function baruMulai(){timerHdl=setTimeout(baruMulai1,1000)}function baruMulai1(){stopOpeningAnimation(100,baruMulai2)}function baruMulai2(){clearTimeout(timerHdl);parameterAwal=faraday.getAllParameters();if(parameterAwal){sliderRadius.setValue(10*parameterAwal.coil.rad);sliderTurn.setValue(parameterAwal.coil.turn);sliderStrength.setValue(20*parameterAwal.magnet.strength);sliderOscScale.setValue(10*parameterAwal.scale.oscilloscope);sliderGalvaScale.setValue(50+1-10*parameterAwal.scale.galvanometer);var id=butMagnetTurn.getId();id.stat=parameterAwal.magnet.flipped;butMagnetTurn.setId(id)}faraday.siap();faradayMaxMin(maxMin);butMaxMin.enable(true);butMaxMin.visible(true);drawMainMenu();AnimationLoop()}function switchFaraday(){console.log("switchFaraday");maxMin=!maxMin;faradayMaxMin(maxMin)}function faradayMaxMin(m){if(m==0){var w=faraday.maximize();var id=butMaxMin.getId();id.stat=true;butMaxMin.setId(id);butMaxMin.setPos(w-18,47);BEOsc.visible(false);for(var i=0;i<BESs.length;i++){BESs[i].visible(false);butSnapshot[i].enable(false);butSnapshot[i].visible(false)}}else{var w=faraday.minimize();var id=butMaxMin.getId();id.stat=false;butMaxMin.setId(id);butMaxMin.setPos(w-18,47);BEOsc.visible(true);var pos;for(var i=0;i<BESs.length;i++){BESs[i].visible(BESs[i].stat);pos=BESs[i].getBoundary();butSnapshot[i].setPos(pos.x+0.98*pos.width,pos.y+0.78*pos.height);butSnapshot[i].enable(true);butSnapshot[i].visible(true)}}}function switchToAutomatic(){faraday.setToAutomaticMoving();drawMainMenu()}function switchToManual(){faraday.setToManualMoving();drawMainMenu()}function switchAutoType(n){faraday.setAutomaticType(n);drawMainMenu()}function switchSpeaker(){var stat=faraday.toggleSuara();var id=butSpeaker.getId();id.stat=stat;butSpeaker.setId(id);butSpeaker.redraw()}function faradayHandler(tag,para){switch(tag){case"siap":baruMulai();break;case"data":BEOsc.input(para.t,para.B,para.E);break;case"ambilParameter":if(!resetOnArrived){var pr=ambilParameterTersimpan();return pr}break;case"simpanParameter":simpanParameter(para);break}}function simpanParameter(para){var s=JSON.stringify(para);writeLocalStorage(storagePrefix+"_parameter",JSON.stringify(para))}function ambilParameterTersimpan(){try{if(typeof(Storage)!=="undefined"){var temp;var f=false;temp=localStorage.getItem(storagePrefix+"_parameter");if(temp!=null){return JSON.parse(temp)}}}catch(e){}return null}function moverHandler(tag,para){switch(tag){case"magnetPos":faraday.setMagnetPos(para.pos);break;case"coilPos":faraday.setCoilPos(para.pos);break}}function snapShot(stat,n){if(stat){BESs[n].shot(BEOsc.output());BESs[n].visible(true);BESs[n].stat=true}else{BESs[n].visible(false);BESs[n].stat=false}var id=butSnapshot[n].getId();id.stat=!stat;butSnapshot[n].getId(id);butSnapshot[n].refresh()}function movingControls_Handle(tag,para){switch(tag){case"setMovingParameter":setMovingParameter(para);break;case"movingRelease":faraday.movingRelease();break}}function setMovingParameter(para){faraday.setMovingParameter(para)}function slider_handler(tag,para){switch(tag){case"drawSlider":switch(para.id.name){case"sRad":para.context.clearMe();var fs=16;var shy=fs*CRL100Shift;PesonaTextBlock.print3(para.context,10,10+shy,para.id.label,fs,"left","middle",false,true,"CRL","#000000",0,0);para.context.beginPath();para.context.moveTo(para.x-0.5,para.y);para.context.lineTo(para.x+para.size+1,para.y);para.context.lineCap="butt";para.context.lineWidth=3;para.context.strokeStyle="#444444";para.context.stroke();var x;var stp=10*para.size/(para.maxVal-para.minVal);para.context.beginPath();for(var i=0;i<=para.size/stp;i++){x=para.x+i*stp;para.context.moveTo(x,para.y-5);para.context.lineTo(x,para.y)}para.context.lineWidth=1;para.context.strokeStyle="#444444";para.context.stroke();break;case"sTurn":para.context.clearMe();var fs=16;var shy=fs*CRL100Shift;PesonaTextBlock.print3(para.context,10,10+shy,para.id.label,fs,"left","middle",false,true,"CRL","#000000",0,0);para.context.beginPath();para.context.moveTo(para.x-0.5,para.y);para.context.lineTo(para.x+para.size+1,para.y);para.context.lineCap="butt";para.context.lineWidth=3;para.context.strokeStyle="#444444";para.context.stroke();var x;var stp=para.size/(para.maxVal-para.minVal);para.context.beginPath();for(var i=0;i<=para.size/stp;i++){x=para.x+i*stp;para.context.moveTo(x,para.y-5);para.context.lineTo(x,para.y)}para.context.lineWidth=1;para.context.strokeStyle="#444444";para.context.stroke();break;case"sStrength":para.context.clearMe();var fs=16;var shy=fs*CRL100Shift;PesonaTextBlock.print3(para.context,10,10+shy,para.id.label,fs,"left","middle",false,true,"CRL","#000000",0,0);para.context.beginPath();para.context.moveTo(para.x-0.5,para.y);para.context.lineTo(para.x+para.size+1,para.y);para.context.lineCap="butt";para.context.lineWidth=3;para.context.strokeStyle="#444444";para.context.stroke();var x;var stp=5*para.size/(para.maxVal-para.minVal);para.context.beginPath();for(var i=0;i<=para.size/stp;i++){x=para.x+i*stp;para.context.moveTo(x,para.y-5);para.context.lineTo(x,para.y)}para.context.lineWidth=1;para.context.strokeStyle="#444444";para.context.stroke();break;case"sOscScale":case"sGalvaScale":para.context.clearMe();var fs=16;var shy=fs*CRL100Shift;PesonaTextBlock.print3(para.context,10,10+shy,para.id.label,fs,"left","middle",false,true,"CRL","#000000",0,0);para.context.beginPath();para.context.moveTo(para.x-0.5,para.y);para.context.lineTo(para.x+para.size+1,para.y);para.context.lineCap="butt";para.context.lineWidth=3;para.context.strokeStyle="#444444";para.context.stroke();var x;var stp=10*para.size/(para.maxVal-para.minVal);para.context.beginPath();para.context.moveTo(para.x,para.y);para.context.lineTo(para.x+stp/10,para.y);para.context.strokeStyle="#bbbbbb";para.context.stroke();para.context.beginPath();x=para.x;para.context.moveTo(x,para.y-5);para.context.lineTo(x,para.y);para.context.lineWidth=1;para.context.strokeStyle="#bbbbbb";para.context.stroke();para.context.beginPath();for(var i=1;i<=para.size/stp;i++){x=para.x+i*stp;para.context.moveTo(x,para.y-5);para.context.lineTo(x,para.y)}para.context.strokeStyle="#444444";para.context.stroke();break;case"sRotasi":case"sTranslasi":para.context.clearMe();var fs=16;var shy=fs*CRL100Shift;PesonaTextBlock.print3(para.context,10,10+shy,para.id.label,fs,"left","middle",false,true,"CRL","#000000",0,0);para.context.beginPath();para.context.moveTo(para.x-0.5,para.y);para.context.lineTo(para.x+para.size+1,para.y);para.context.lineCap="butt";para.context.lineWidth=3;para.context.strokeStyle="#444444";para.context.stroke();var x;para.context.beginPath();for(var i=0;i<=20000;i+=1000){x=para.x+para.size-(Math.log10(i)*50-para.minVal)*para.size/(para.maxVal-para.minVal);para.context.moveTo(x,para.y-5);para.context.lineTo(x,para.y)}para.context.lineWidth=1;para.context.strokeStyle="#444444";para.context.stroke();break}break;case"drawPointer":switch(para.id.name){case"sRad":case"sTurn":case"sStrength":case"sOscScale":case"sGalvaScale":case"sRotasi":case"sTranslasi":para.context.clearMe();var x=para.x+para.size*(para.curVal-para.minVal)/(para.maxVal-para.minVal);para.context.beginPath();para.context.moveTo(x,para.y+18);para.context.arcTo(x-12,para.y+18,x,para.y-3,2);para.context.arcTo(x,para.y-3,x+12,para.y+18,2);para.context.arcTo(x+12,para.y+18,x,para.y+18,2);para.context.closePath();para.context.save();para.context.shadowColor="rgba(0,0,0,0.4)";para.context.shadowBlur=2;para.context.shadowOffsetX=4;para.context.shadowOffsetY=3;para.context.fillStyle="#ffffff";para.context.fill();para.context.restore();para.context.lineCap="round";para.context.lineWidth=1;para.context.strokeStyle="#000000";para.context.stroke();break}break;case"checkPointer":switch(para.id.name){case"sRad":case"sTurn":case"sStrength":case"sOscScale":case"sGalvaScale":case"sRotasi":case"sTranslasi":var x=para.x+para.size*(para.curVal-para.minVal)/(para.maxVal-para.minVal);if(para.downMode=="mouse"){para.context.beginPath();para.context.moveTo(x,para.y+18);para.context.arcTo(x-12,para.y+18,x,para.y-3,2);para.context.arcTo(x,para.y-3,x+12,para.y+18,2);para.context.arcTo(x+12,para.y+18,x,para.y+18,2);para.context.closePath()}else{para.context.beginPath();para.context.rect(x-20,para.y-10,40,38)}return para.context.isPointInPath(para.pointX,para.pointY);break}break;case"validateValue":switch(para.id.name){case"sRad":return Math.round(para.value);break;case"sTurn":return Math.round(para.value);break;case"sStrength":return Math.round(para.value);break;case"sOscScale":return Math.max(1,Math.round(para.value));break;case"sGalvaScale":return Math.max(1,Math.round(para.value));break;case"sRotasi":case"sTranslasi":return para.value;break}break;case"changeValue":switch(para.id.name){case"sRad":faraday.setCoilRadius(para.value/10);break;case"sTurn":faraday.setCoilTurn(para.value);break;case"sStrength":faraday.setMagnetStrength(para.value/20);break;case"sOscScale":faraday.setOscilloscopeScale(para.value/10);break;case"sGalvaScale":faraday.setGalvanometerScale(((para.maxVal+para.minVal)-para.value+1)/10);break;case"sRotasi":var pv=(para.minVal+para.maxVal)-para.value;var v=Math.pow(10,pv/50);faraday.setMovingPriod(v);break;case"sTranslasi":var pv=(para.minVal+para.maxVal)-para.value;var v=Math.pow(10,pv/50);faraday.setMovingPriod(v);break}break}}var menu=[{img:"icon_moving",action:0,title:"gerak",align:"left"},{img:"icon_magnet",action:1,title:"magnet",align:"left"},{img:"icon_coil",action:2,title:"coil",align:"left"},{img:"icon_bulb",action:3,title:"bulb",align:"right"},{img:"icon_galvanometer",action:4,title:"galvanometer",align:"right"},{img:"icon_oscilloscope",action:5,title:"oscilloscope",align:"right"}];var menuN=-1;function drawMainMenu(){var context=mainContext;context.clearRect(0,canvasHeight-175,canvasWidth,175);var ys=canvasHeight-150-16;var w=70;var h=50;var r=10;var p=828;var l=150;var x;var xt,yt;context.save();context.shadowColor="#888888";context.shadowBlur=6;context.shadowOffsetX=0;context.shadowOffsetY=0;context.beginPath();switch(menuN){case 0:p=828;x=16;xt=x+w+15;yt=ys+10;context.moveTo(x,ys+r);context.arcTo(x,ys,x+r,ys,r);context.arcTo(x+w+p,ys,x+w+p,ys+r,r);context.arcTo(x+w+p,ys+l,x+w+p-r,ys+l,r);context.arcTo(x+w,ys+l,x+w,ys+l-r,r);context.lineTo(x+w,ys+h);context.arcTo(x,ys+h,x,ys+h-r,r);break;case 1:p=414;x=16;xt=x+w+15;yt=ys+10;context.moveTo(x,ys+h+r);context.arcTo(x,ys+h,x+r,ys+h,r);context.lineTo(x+w,ys+h);context.arcTo(x+w,ys,x+w+r,ys,r);context.arcTo(x+w+p,ys,x+w+p,ys+r,r);context.arcTo(x+w+p,ys+l,x+w+p-r,ys+l,r);context.arcTo(x+w,ys+l,x+w,ys+l-r,r);context.lineTo(x+w,ys+h+h);context.arcTo(x,ys+h+h,x,ys+h+h-r,r);break;case 2:p=414;x=16;xt=x+w+15;yt=ys+10;context.moveTo(x,ys+h+h+r);context.arcTo(x,ys+h+h,x+r,ys+h+h,r);context.lineTo(x+w,ys+h+h);context.arcTo(x+w,ys,x+w+r,ys,r);context.arcTo(x+w+p,ys,x+w+p,ys+r,r);context.arcTo(x+w+p,ys+l,x+w+p-r,ys+l,r);context.arcTo(x,ys+l,x,ys+l-r,r);break;case 3:p=150;x=canvasWidth-16;xt=x-w-15;yt=ys+10;context.moveTo(x,ys+r);context.arcTo(x,ys,x-r,ys,r);context.arcTo(x-w-p,ys,x-w-p,ys+r,r);context.arcTo(x-w-p,ys+l,x-w-p+r,ys+l,r);context.arcTo(x-w,ys+l,x-w,ys-l-r,r);context.lineTo(x-w,ys+h);context.arcTo(x,ys+h,x,ys+h-r,r);break;case 4:p=414;x=canvasWidth-16;xt=x-w-15;yt=ys+10;context.moveTo(x,ys+h+r);context.arcTo(x,ys+h,x-r,ys+h,r);context.lineTo(x-w,ys+h);context.arcTo(x-w,ys,x-w-r,ys,r);context.arcTo(x-w-p,ys,x-w-p,ys+r,r);context.arcTo(x-w-p,ys+l,x-w-p+r,ys+l,r);context.arcTo(x-w,ys+l,x-w,ys+l-r,r);context.lineTo(x-w,ys+h+h);context.arcTo(x,ys+h+h,x,ys+h+h-r,r);break;case 5:p=414;x=canvasWidth-16;xt=x-w-15;yt=ys+10;context.moveTo(x,ys+h+h+r);context.arcTo(x,ys+h+h,x-r,ys+h+h,r);context.lineTo(x-w,ys+h+h);context.arcTo(x-w,ys,x-w-r,ys,r);context.arcTo(x-w-p,ys,x-w-p,ys+r,r);context.arcTo(x-w-p,ys+l,x-w-p+r,ys+l,r);context.arcTo(x,ys+l,x,ys+l-r,r);break}context.closePath();context.fillStyle="#ffffff";context.fill();context.restore();if(menuN>=0){var fs=18;var shy=fs*CR100Shift;PesonaTextBlock.print3(context,xt,yt+10+shy,message[menu[menuN].title],fs,(menu[menuN].align=="left")?"left":"right","middle",false,true,"CR","#000000",0,0)}else{PesonaTextBlock.print3(context,canvasWidth/2,ys+10,message.intro,17,"center","top",false,true,"CRL","#000000",canvasWidth-240,2)}var x1=51;var x2=canvasWidth-51;var yy=ys+25;var mw=64;var mh=46;for(var i=0;i<3;i++){context.drawImage(sImage[menu[i].img],x1-mw/2,yy-mh/2,mw,mh);yy+=50}yy=ys+25;for(var i=3;i<6;i++){context.drawImage(sImage[menu[i].img],x2-mw/2,yy-mh/2,mw,mh);yy+=50}butGerakManual.visible(false);butGerakOtomatis.visible(false);butTipeOtomatis[0].visible(false);butTipeOtomatis[1].visible(false);butTipeOtomatis[2].visible(false);butTipeOtomatis[3].visible(false);butPlug.visible(false);butMagnetField.visible(false);butElectrons.visible(false);butB.visible(false);butMagnetTurn.visible(false);butSpeaker.visible(false);for(var i=0;i<sliders.length;i++){sliders[i].visible(false)}for(var i=0;i<movingControls.length;i++){movingControls[i].show(false)}switch(menuN){case 0:var id;var m=faraday.getMovingMode();var tf=(m==0);butGerakManual.fix(tf);butGerakManual.setPos(x+w+28+30,ys+60+50);butGerakManual.visible(true);butGerakManual.enable(true);butGerakOtomatis.fix(!tf);butGerakOtomatis.setPos(x+w+28+30,ys+60);butGerakOtomatis.visible(true);butGerakOtomatis.enable(true);if(m==0){var fs=16;var shy=fs*CRL100Shift;PesonaTextBlock.print3(context,x+w+120,ys+60+50+shy,message.gerakManual,fs,"left","middle",false,true,"CRL","#000000",0,0)}else{var n=faraday.getAutomaticType();var yy=ys+28;var xx=x+w+160;for(var i=0;i<4;i++){butTipeOtomatis[i].setPos(xx+i*100,yy);butTipeOtomatis[i].fix(i==n);butTipeOtomatis[i].visible(true);butTipeOtomatis[i].enable(true)}var par=faraday.getParameter(n);movingControls[n].setParameter(par);movingControls[n].show(true);switch(n){case 0:case 1:sliderKecepatanTranslasi.setPos(x+w+600,ys+50);sliderKecepatanTranslasi.refresh();sliderKecepatanTranslasi.visible(true);sliderKecepatanTranslasi.enable(true);var batas=sliderKecepatanTranslasi.getMinMax();sliderKecepatanTranslasi.setValue((batas.min+batas.max)-Math.log10(faraday.getMovingPriod(n))*50);break;case 2:case 3:sliderKecepatanRotasi.setPos(x+w+600,ys+50);sliderKecepatanRotasi.refresh();sliderKecepatanRotasi.visible(true);sliderKecepatanRotasi.enable(true);var batas=sliderKecepatanRotasi.getMinMax();sliderKecepatanRotasi.setValue((batas.min+batas.max)-Math.log10(faraday.getMovingPriod(n))*50);break}}break;case 1:var id=butMagnetField.getId();id.stat=faraday.isShown(id.tag);butMagnetField.setId(id);butMagnetField.setPos(x+w+28+25,ys+20+45);butMagnetField.visible(true);butMagnetField.enable(true);butMagnetTurn.setPos(x+w+28+25,ys+20+40+55);butMagnetTurn.visible(true);butMagnetTurn.enable(true);sliderStrength.setPos(x+w+130,ys+40);sliderStrength.refresh();sliderStrength.visible(true);sliderStrength.enable(true);break;case 2:var id=butElectrons.getId();id.stat=faraday.isShown(id.tag);butElectrons.setId(id);butElectrons.setPos(x+w+28+25,ys+20+45);butElectrons.visible(true);butElectrons.enable(true);id=butB.getId();id.stat=faraday.isShown(id.tag);butB.setId(id);butB.setPos(x+w+28+25,ys+20+40+55);butB.visible(true);butB.enable(true);sliderRadius.setPos(x+w+130,ys+20);sliderRadius.refresh();sliderRadius.visible(true);sliderRadius.enable(true);sliderTurn.setPos(x+w+130,ys+20+58);sliderTurn.refresh();sliderTurn.visible(true);sliderTurn.enable(true);break;case 3:var id=butPlug.getId();id.tag="bulb";id.stat=faraday.isPlug(id.tag);butPlug.setId(id);butPlug.setPos(x-w-50,ys+24+45);butPlug.visible(true);butPlug.enable(true);break;case 4:var id=butPlug.getId();id.tag="galvanometer";id.stat=faraday.isPlug(id.tag);butPlug.setId(id);butPlug.setPos(x-w-50,ys+24+45);butPlug.visible(true);butPlug.enable(true);sliderGalvaScale.setPos(x-w-p+50,ys+40);sliderGalvaScale.refresh();sliderGalvaScale.visible(true);sliderGalvaScale.enable(true);break;case 5:var id=butPlug.getId();id.tag="oscilloscope";id.stat=faraday.isPlug(id.tag);butPlug.setId(id);butPlug.setPos(x-w-50,ys+24+45);butPlug.visible(true);butPlug.enable(true);sliderOscScale.setPos(x-w-p+90,ys+40);sliderOscScale.refresh();sliderOscScale.visible(true);sliderOscScale.enable(true);butSpeaker.setPos(x-w-p+60,ys+24+45);butSpeaker.visible(true);butSpeaker.enable(true);break}}function checkMenu(px,py){var res=-1;var ys=canvasHeight-150-16;if(py>ys&&py<(ys+150)){var n=Math.floor((py-ys)/50);if(px>16&&px<(16+70)){res=n}else{if(px>(canvasWidth-70-16)&&px<(canvasWidth-16)){res=3+n}}}return res}function plugUnplug(id){var stat=!id.stat;switch(id.tag){case"bulb":if(stat){faraday.plug(id.tag)}else{faraday.unplug(id.tag)}drawMainMenu();break;case"galvanometer":if(stat){faraday.plug(id.tag)}else{faraday.unplug(id.tag)}drawMainMenu();break;case"oscilloscope":if(stat){faraday.plug(id.tag)}else{faraday.unplug(id.tag)}drawMainMenu();if(!QFStart){QFStart=true;QFTs=Date.now();QFCount=1}else{if((Date.now()-QFTs)>3000){QFStart=true;QFTs=Date.now();QFCount=1}else{QFCount++;if(QFCount>=10){faraday.setQF()}}}break}}function showUnshow(id){var stat=!id.stat;switch(id.tag){case"magnetField":case"electrons":case"B":if(stat){faraday.show(id.tag)}else{faraday.unshow(id.tag)}drawMainMenu();break}}function flipUnFlip(){var id=butMagnetTurn.getId();id.stat=!id.stat;butMagnetTurn.setId(id);butMagnetTurn.redraw();faraday.flipMagnetBar()}function iconFixed(id,context,x,y,par,width,height){var skl=par[0];switch(id.name){case"manual":case"otomatis":var w=width;var h=height;context.beginPath();context.roundRect(x-w/2,y-h/2,w,h,h/2);context.closePath();context.fillStyle="rgb(50,50,50)";context.fill();var fs=0.32*h;var shy=fs*CRL100Shift;PesonaTextBlock.print3(context,x,y+shy,id.label,fs,"center","middle",false,true,"CR","#ffffff",0,0);break;case"tipeOtomatis":var w=width;var h=height;context.beginPath();context.roundRect(x-w/2,y-h/2,w,h,h/2);context.closePath();context.fillStyle="rgb(50,50,50)";context.fill();context.save();context.globalCompositeOperation="xor";var s=sImage[id.icon];var sh=0.85*h;var sw=s.width*sh/s.height;context.drawImage(s,x-sw/2,y-sh/2,sw,sh);break}}function iconTombol(id,context,x,y,par,width,height){var skl=par[0];switch(id.name){case"snapshot":var w=skl*width;var h=skl*height;context.beginPath();context.roundRect(x-w/2,y-h/2,w,h,h/2);context.closePath();context.fillStyle="rgba(255,255,255,0.7)";context.fill();context.lineWidth=1;context.strokeStyle="rgba(0,0,0,0.5)";context.stroke();if(id.stat){var img=sImage.icon_camera;var iw=skl*0.5*img.width;var ih=skl*0.5*img.height;context.drawImage(img,x-iw/2,y-ih/2,iw,ih)}else{var ww=0.3*w;var hh=0.3*h;context.beginPath();context.moveTo(x-ww/2,y-hh/2);context.lineTo(x+ww/2,y+hh/2);context.moveTo(x+ww/2,y-hh/2);context.lineTo(x-ww/2,y+hh/2);context.lineWidth=3;context.strokeStyle="#777777";context.stroke()}break;case"speaker":var w=skl*width;var h=skl*height;var img=(id.stat)?sImage.icon_speakerOff:sImage.icon_speakerOn;var sh=0.8*h;var sw=img.width*sh/img.height;context.drawImage(img,x-sw/2,y-sh/2,sw,sh);break;case"plug":var img=(id.stat)?sImage.icon_plugout:sImage.icon_plugin;var w=27;var h=48;context.drawImage(img,x-w/2,y-h/2,w,h);break;case"magnetField":var img=(id.stat)?sImage.icon_magnetFieldOff:sImage.icon_magnetFieldOn;var w=56;var h=40;context.drawImage(img,x-w/2,y-h/2,w,h);break;case"electrons":var img=(id.stat)?sImage.icon_electronsOff:sImage.icon_electronsOn;var w=56;var h=40;context.drawImage(img,x-w/2,y-h/2,w,h);break;case"B":var img=(id.stat)?sImage.icon_BOff:sImage.icon_BOn;var w=56;var h=40;context.drawImage(img,x-w/2,y-h/2,w,h);break;case"magnetTurn":var img=(id.stat)?sImage.icon_flip1:sImage.icon_flip2;var w=56;var h=40;context.drawImage(img,x-w/2,y-h/2,w,h);break;case"maxmin":var w=0.7*skl*width;var h=0.8*skl*height;context.beginPath();context.rect(x-w/2,y-h/2,w,h);context.lineWidth=2;context.strokeStyle="rgba(255,255,255,0.3)";context.stroke();context.beginPath();context.moveTo(x+0.15*w,y-h/2+1);context.lineTo(x+0.15*w,y+h/2-1);if(!id.stat){context.setLineDash([3,3])}context.lineWidth=1;context.strokeStyle="rgba(255,255,255,0.3)";context.stroke();context.setLineDash([]);break;case"manual":case"otomatis":var w=skl*width;var h=skl*height;context.beginPath();context.roundRect(x-w/2,y-h/2,w,h,h/2);context.closePath();context.fillStyle="rgb(200,200,200)";context.fill();var fs=0.32*h;var shy=fs*CRL100Shift;PesonaTextBlock.print3(context,x,y+shy,id.label,fs,"center","middle",false,true,"CR","#000000",0,0);break;case"tipeOtomatis":var w=skl*width;var h=skl*height;context.beginPath();context.roundRect(x-w/2,y-h/2,w,h,h/2);context.closePath();context.fillStyle="rgb(200,200,200)";context.fill();var s=sImage[id.icon];var sh=0.85*h;var sw=s.width*sh/s.height;context.drawImage(s,x-sw/2,y-sh/2,sw,sh);break}}function areaTombol(xPoint,yPoint,id,context,x,y,par,width,height){var skl=par[0];var f=false;switch(id.name){case"snapshot":case"manual":case"otomatis":case"tipeOtomatis":var w=skl*width;var h=skl*height;context.beginPath();context.roundRect(x-w/2,y-h/2,w,h,h/2);context.closePath();f=context.isPointInPath(xPoint,yPoint);break;case"plug":case"magnetField":case"electrons":case"B":case"magnetTurn":case"maxmin":case"speaker":var w=width;var h=height;context.beginPath();context.rect(x-w/2,y-h/2,w,h);context.closePath();f=context.isPointInPath(xPoint,yPoint);break}return f}var mm=0;function tombolHandler(tag,para){switch(tag){case"click":switch(para.id.name){case"plug":plugUnplug(para.id);break;case"magnetField":case"electrons":case"B":showUnshow(para.id);break;case"magnetTurn":flipUnFlip();break}break;case"release":switch(para.id.name){case"snapshot":snapShot(para.id.stat,para.id.index);break;case"maxmin":switchFaraday();break;case"otomatis":switchToAutomatic();break;case"manual":switchToManual();break;case"tipeOtomatis":switchAutoType(para.id.index);break;case"speaker":switchSpeaker();break}break}}var action;var ACTION={NONE:0,MOVEMAGNET:1,MOVECOIL:2,MOVESLIDER:3};var isDown=false;var isTouch=false;var touchId;var mouseButton;function setMouseUp(){if(downMode=="mouse"){document.addEventListener("mouseup",canvasMouseUp)}else{document.addEventListener("touchend",canvasTouchUp)}}function releaseMouseUp(){if(downMode=="mouse"){document.removeEventListener("mouseup",canvasMouseUp)}else{document.removeEventListener("touchend",canvasTouchUp)}}function canvasMouseDown(e){downMode="mouse";if(!e){var e=window.event}e.preventDefault();e.stopPropagation();if(e.buttons==undefined||e.buttons==1||e.buttons==2){mouseButton=e.button;canvasDown(e,e)}}var touchId;function canvasTouchDown(e){downMode="touch";if(!e){var e=window.event}e.preventDefault();e.stopPropagation();if(e.targetTouches.length==1){var touch=e.targetTouches[0];touchId=touch.identifier;canvasDown(e,touch)}}var pressDx,pressDy;var selectedN;var activeSlider;function canvasDown(e,eOrTouch){action=ACTION.NONE;var posS={x:eOrTouch.pageX,y:eOrTouch.pageY};var pos={x:(posS.x-xGlobal)/xScale,y:(posS.y-yGlobal)/yScale};var f=false;for(var i=0;i<buttons.length;i++){if(buttons[i].pointDown(e,posS.x,posS.y,downMode,0)){setMouseUp();f=true;break}}if(!f){var n=checkMenu(pos.x,pos.y);if(n>=0){if(n!=menuN){menuN=n;drawMainMenu()}else{menuN=-1;drawMainMenu()}}}activeSlider=null;var i=0;while(!f&&i<sliders.length){f=sliders[i].pointDown(e,posS.x,posS.y,downMode,0);if(f){activeSlider=sliders[i];setMouseUp();document.body.style.cursor="pointer";action=ACTION.MOVESLIDER}i++}if(!f){var res=magMover.pointDown(e,posS.x,posS.y,downMode);switch(res){case"moveMagnet":setMouseUp();f=true;action=ACTION.MOVEMAGNET;document.body.style.cursor="pointer";break;case"moveCoil":setMouseUp();f=true;action=ACTION.MOVECOIL;document.body.style.cursor="pointer";break}}if(action!=ACTION.NONE){if(downMode=="mouse"){document.addEventListener("mousemove",canvasMouseMove)}else{document.addEventListener("touchmove",canvasTouchMove)}}}function canvasMouseUp(e){if(!e){var e=window.event}e.preventDefault();e.stopPropagation();if(e.button==mouseButton){upMode="mouse";document.removeEventListener("mousemove",canvasMouseMove);canvasUp(e,e)}}function canvasTouchUp(e){if(!e){var e=window.event}e.preventDefault();e.stopPropagation();upMode="touch";var touch=e.changedTouches[0];if(touch.identifier==touchId){document.removeEventListener("touchmove",canvasTouchMove);canvasUp(e,touch)}}function canvasUp(e,eOrTouch){var pos;var posS={x:eOrTouch.pageX,y:eOrTouch.pageY};var f=false;for(var i=0;i<buttons.length;i++){if(buttons[i].pointUp(e,posS.x,posS.y,upMode,0)){f=true;break}}if(activeSlider){activeSlider.pointUp(e,posS.x,posS.y,upMode,0)}releaseMouseUp();document.body.style.cursor="default";action=ACTION.NONE}function canvasMouseMove(e){if(!e){var e=window.event}e.preventDefault();e.stopPropagation();canvasMove(e,e)}function canvasTouchMove(e){if(!e){var e=window.event}var touch=e.changedTouches[0];if(touch.identifier==touchId){e.preventDefault();e.stopPropagation();canvasMove(e,touch)}}function canvasMove(e,eOrTouch){var posS={x:eOrTouch.pageX,y:eOrTouch.pageY};var pos={x:(posS.x-xGlobal)/xScale,y:(posS.y-yGlobal)/yScale};switch(action){case ACTION.MOVEMAGNET:magMover.pointMove(e,posS.x,posS.y,downMode);break;case ACTION.MOVECOIL:magMover.pointMove(e,posS.x,posS.y,downMode);break;case ACTION.MOVESLIDER:activeSlider.pointMove(e,posS.x,posS.y,downMode);break}}function canvasMouseWheel(e){if(!e){var e=window.event}var posS={x:e.pageX,y:e.pageY}}function Bezier(u,controlP){if(controlP.length==1){return{x:controlP[0].x,y:controlP[0].y}}else{var newP=new Array();var n=controlP.length-1;for(var i=0;i<n;i++){newP.push({x:(1-u)*controlP[i].x+u*controlP[i+1].x,y:(1-u)*controlP[i].y+u*controlP[i+1].y})}return Bezier(u,newP)}}CanvasRenderingContext2D.prototype.roundRect=function(x,y,w,h,r){if(w<2*r){r=w/2}if(h<2*r){r=h/2}this.beginPath();this.moveTo(x+r,y);this.arcTo(x+w,y,x+w,y+h,r);this.arcTo(x+w,y+h,x,y+h,r);this.arcTo(x,y+h,x,y,r);this.arcTo(x,y,x+w,y,r);this.closePath()};CanvasRenderingContext2D.prototype.roundRectExt=function(x,y,w,h,r1,r2,r3,r4){this.beginPath();this.moveTo(x+r1,y);this.arcTo(x+w,y,x+w,y+h,r2);this.arcTo(x+w,y+h,x,y+h,r3);this.arcTo(x,y+h,x,y,r4);this.arcTo(x,y,x+w,y,r1);this.closePath()};CanvasRenderingContext2D.prototype.clearMe=function(){this.save();this.setTransform(1,0,0,1,0,0);this.clearRect(0,0,this.canvas.width,this.canvas.height);this.restore()};Number.prototype.myToLocaleString=function(minDigits,maxDigits){if(minDigits<0&&maxDigits<0){return this.toLocaleString(language,{useGrouping:false})}else{var t=Math.pow(10,maxDigits);var n=Math.round(this*t)/t;var res=n.toLocaleString(language,{useGrouping:false,minimumFractionDigits:minDigits,maximumFractionDigits:maxDigits});var i=res.indexOf(".");if(i<0){i=res.indexOf(",")}if(i>=0){res=(res+"00000").substr(0,i+maxDigits+1)}return res}};function findAbsolutePosition(obj){var curleft=curtop=0;if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while(obj=obj.offsetParent)}return{x:curleft,y:curtop}}function winResizeOpening(){var rExp=/%/;if(rExp.test(container.style.width)||rExp.test(container.style.height)){var res=PesonaBasic.refreshCanvases(true);xScale=res.scale.x;yScale=res.scale.y;xGlobal=res.pos.x;yGlobal=res.pos.y}}function winResize(){var rExp=/%/;if(rExp.test(container.style.width)||rExp.test(container.style.height)){var res=PesonaBasic.refreshCanvases(true);xScale=res.scale.x;yScale=res.scale.y;xGlobal=res.pos.x;yGlobal=res.pos.y}refreshAll()}};