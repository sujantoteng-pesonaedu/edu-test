function FaradayExperiment(by,M,L,o,at,aH,aM){var k=1000-32;var ac=600;var bK="fdrexp_view";var aO="fdrexp_msg";const t=Math.PI/180;const i=180/Math.PI;const bp=2*Math.PI;const al=0.5*Math.PI;const N=1.5*Math.PI;const bu=0.25*Math.PI;var aB,S;var R=false;var ba=window.devicePixelRatio||1;var aT,aF;var G=document.createElement("canvas");var g=PesonaBasic.addCanvas(bK,{canvas:G,isWebgl:true,index:-1,x:M,y:L,width:k,height:ac,borderRadius:5,shadow:{color:"#000000",x:0,y:0,blur:5}},true);G.style.visibility="hidden";G.style.outline="none";G.style.backgroundColor="#000000";var U=document.createElement("canvas");var b=PesonaBasic.addCanvas(aO,{canvas:U,index:-1,x:M,y:L+ac-40,width:k,height:40},false);U.style.visibility="hidden";var bo=PesonaBasic.getStage();var aR=bo.scale.x;var bz=bo.scale.y;var ae;var bv=new Array();var a6=4*Math.PI*1e-7;var aP={strength:1,length:10,margin:0.4};var bl=false;var aJ=aP.length/2+aP.margin+0.5;var j={azimuthal:40*t,polar:78*t,r:39};var c={scene:null,camera:null,renderer:null,raycaster:null};var H={circuit:null,coil:null,magnet:null,magneticField:null,bulb:null,lamp:{shell:null,light:null},electrons:null,galvanometer:null,galvaPointer:null,oscilloscope:null,oscDisplay:{face:null,grid:null,speaker:null},connector:null,cables:null,cable1:null,cable2:null,extension1:null,extension2:null};var bA={screenWidth:0,screenHeight:0,screenScale:1,yScale:1,recMax:300,rec:new Array()};var ax={scale:1};var v={bulb:true,galvanometer:true,oscilloscope:true};var a4={magnetField:false,electrons:false,B:false};const bn={MANUAL:0,AUTO:1};var a3=false;var K=bn.MANUAL;var h;var B;var y="";var X;var bj;var r;var bF=0;var aL;var bw={rLoop:6,turn:1,rCorner:0.3,gap:0.8,coilGap:0.4,wireRad:0.12,fLength1:4.2,fLength2:2.8};var F;var I;var bJ=0;var bc;var bC={coil:false,magnet:false};var br=false;var aX=new PesonaSoundGenerator("faraday1",0,280,0);var aW=new PesonaSoundGenerator("faraday2",1,220,0);var V=0;var av="UGVzb25hIEVkdWthc2k=";var aj;var aT,aF;var aK,n;var D,bP;var a5,aA;var bh,a9;var C,aw;var aE,ah;var aG,a2;var aS={magnet:0,coil:0,ts:{magnet:0,coil:0},prev:{magnet:0,coil:0},omega:{magnet:0,coil:0},omegaPrev:{magnet:0,coil:0}};var bm={magnet:0,coil:0,ts:{magnet:0,coil:0},prev:{magnet:0,coil:0}};var bf={center:0,amp:0,Ttrans:0,Trot:0};var bb={center:0,amp:8,Ttrans:0,Trot:2000};var aq=[{magnet:{center:0,amp:10,Ttrans:2000,Trot:0},coil:{center:0,amp:0,Ttrans:0,Trot:0}},{magnet:{center:5,amp:0,Ttrans:0,Trot:0},coil:{center:0,amp:10,Ttrans:2000,Trot:0}},{magnet:{center:0,amp:0,Ttrans:0,Trot:2000},coil:{center:0,amp:0,Ttrans:0,Trot:0}},{magnet:{center:0,amp:0,Ttrans:0,Trot:0},coil:{center:0,amp:0,Ttrans:0,Trot:2000}}];var bD;var bi=0;var aZ=aQ("ambilParameter",{id:by});if(aZ){bE(aZ)}bM();function bE(bS){if(typeof bS==="object"){if(bS.hasOwnProperty("coil")){if(bS.coil.hasOwnProperty("rad")){bw.rLoop=Math.min(8,Math.max(2,bS.coil.rad))}if(bS.coil.hasOwnProperty("turn")){bw.turn=Math.min(10,Math.max(1,bS.coil.turn))}}if(bS.hasOwnProperty("magnet")){if(bS.magnet.hasOwnProperty("strength")){aP.strength=Math.min(2,Math.max(0.5,bS.magnet.strength))}if(bS.magnet.hasOwnProperty("flipped")){bl=(bS.magnet.flipped&&true)}}if(bS.hasOwnProperty("scale")){if(bS.scale.hasOwnProperty("oscilloscope")){bA.yScale=Math.min(10,Math.max(0.1,bS.scale.oscilloscope))}if(bS.scale.hasOwnProperty("galvanometer")){ax.scale=Math.min(5,Math.max(0.1,bS.scale.galvanometer))}}if(bS.hasOwnProperty("auto")){if(w(bS.auto,aq)){aq=JSON.parse(JSON.stringify(bS.auto))}}}}function az(bS){return Object.prototype.toString.call(bS)==="[object Array]"}function w(bT,bS){if(az(bT)!==az(bS)){return false}if(az(bT)){if(bT.length!==bS.length){return false}for(var bV=0;bV<bT.length;bV++){if(!w(bT[bV],bS[bV])){return false}}return true}if(typeof bT==="object"&&bT!==null){if(typeof bS!=="object"||bS===null){return false}var bU;for(bU in bT){if(bT.hasOwnProperty(bU)){if(!bS.hasOwnProperty(bU)){return false}if(!w(bT[bU],bS[bU])){return false}}}for(bU in bS){if(bS.hasOwnProperty(bU)){if(!bT.hasOwnProperty(bU)){return false}}}return true}return typeof bT===typeof bS}function aa(){var bS={coil:{rad:bw.rLoop,turn:bw.turn},magnet:{strength:aP.strength,flipped:bl},scale:{oscilloscope:bA.yScale,galvanometer:ax.scale},auto:aq};aQ("simpanParameter",bS)}this.getAllParameters=function(){var bS={coil:{rad:bw.rLoop,turn:bw.turn},magnet:{strength:aP.strength,flipped:bl},scale:{oscilloscope:bA.yScale,galvanometer:ax.scale},auto:aq};return bS};this.siap=function(){G.style.visibility="visible";U.style.visibility="visible";X=Date.now();bj=X;bF=X;r=0;a3=true};this.loop=function(){if(a3){e()}ao()};this.redraw=function(){var bS=PesonaBasic.getStage();aR=bS.scale.x;bz=bS.scale.y;if(c.renderer){c.renderer.setViewport(0,0,G.width,G.height)}ao();PesonaBasic.refreshCanvas("frd_oscFace");PesonaBasic.refreshCanvas("frd_oscGridFace");aA.scale(1,bA.screenScale);a9.scale(1,bA.screenScale);ba=window.devicePixelRatio||1};this.getParameter=function(bS){return aq[bS]};this.setQF=function(){R=true};this.pauseSound=function(){aX.pauseSound();aW.pauseSound()};this.continueSound=function(){aX.continueSound();aW.continueSound()};this.isSoundOn=function(){return soundOn};this.toggleSuara=function(bS){br=!br;if(v.oscilloscope){if(br){aX.activate();aW.activate();aX.setMute(false);aW.setMute(false)}else{aX.setMute(true);aW.setMute(true)}}return br};this.getMovingMode=function(){return K};this.getAutomaticType=function(){return bi};this.setToManualMoving=function(){aY()};function aY(){K=bn.MANUAL;bv[0].addEventListener("click",bq);bv[1].addEventListener("click",bq);bm.magnet=0;bm.prev.magnet=0;bm.coil=0;bm.prev.coil=0}this.setToAutomaticMoving=function(){bR()};this.setAutomaticType=function(bS){bi=bS;aV(bi)};function bR(){K=bn.AUTO;bv[0].removeEventListener("click",bq);bv[1].removeEventListener("click",bq);aV(bi);aC(r,false)}function aV(bT){var bS=aq[bT];bf.center=bS.magnet.center;bf.amp=bS.magnet.amp;bf.Ttrans=bS.magnet.Ttrans;bf.Trot=bS.magnet.Trot;bm.magnet=0;bb.center=bS.coil.center;bb.amp=bS.coil.amp;bb.Ttrans=bS.coil.Ttrans;bb.Trot=bS.coil.Trot;bm.coil=0}this.movingRelease=function(){aa()};this.setMovingParameter=function(bS){var bT=bS.type;switch(bS.type){case 0:aq[bT].magnet.center=bS.atr.center.magnet.x;aq[bT].magnet.amp=bS.atr.amp.magnet;aV(bT);break;case 1:aq[bT].magnet.center=bS.atr.center.magnet.x;aq[bT].coil.amp=bS.atr.amp.coil;aV(bT);break;case 2:aq[bT].magnet.center=bS.atr.center.magnet.x;aV(bT);break;case 3:aq[bT].magnet.center=bS.atr.center.magnet.x;aV(bT);break}};this.setMovingPriod=function(bS){switch(bi){case 0:aq[0].magnet.Ttrans=bS;aS.omegaPrev.magnet=aS.omega.magnet;aS.ts.magnet=r;bf.Ttrans=bS;break;case 1:aq[1].coil.Ttrans=bS;aS.omegaPrev.coil=aS.omega.coil;aS.ts.coil=r;bb.Ttrans=bS;break;case 2:aq[2].magnet.Trot=bS;bm.prev.magnet=bm.magnet;bm.ts.magnet=r;bf.Trot=bS;console.log("setRot > ",bi,bb.Trot);break;case 3:aq[3].coil.Trot=bS;bm.prev.coil=bm.coil;bm.ts.coil=r;bb.Trot=bS;break}if(bi>=0&&bi<4){aa()}};this.getMovingPriod=function(bS){res=0;switch(bS){case 0:res=bf.Ttrans;break;case 1:res=bb.Ttrans;break;case 2:res=bf.Trot;break;case 3:res=bb.Trot;break}return res};this.toggleGerak=function(){if(K==bn.AUTO){K=bn.MANUAL}else{if(K==bn.MANUAL){K=bn.AUTO}}if(K==bn.MANUAL){console.log("Mulai manual");bv[0].addEventListener("click",bq);bv[1].addEventListener("click",bq);bm.magnet=0;bm.prev.magnet=0;bm.coil=0;bm.prev.coil=0}else{console.log("kembali auto");bv[0].removeEventListener("click",bq);bv[1].removeEventListener("click",bq);aC(0,false)}};this.afterTimeBreak=function(bS){X+=bS;r+=bS};this.minimize=function(){bt(760);return 760};this.maximize=function(){bt(1000-32);return 1000-32};function aI(bU){y=bU;b.clearMe();var bT=16;var bS=bT*S;PesonaTextBlock.print3(b,k/2,20+bS,bU,bT,"center","middle",false,true,"CRL","#ffff00",0,0)}function bt(bS){k=bS;PesonaBasic.changeCanvasSize(bK,k,ac);if(c.renderer){c.renderer.setViewport(0,0,G.width,G.height)}if(c.camera){switch(c.camera.type){case"PerspectiveCamera":c.camera.aspect=G.width/G.height;break;case"OrthographicCamera":var bT=G.width/G.height;var bU=20;c.camera.left=-bU*bT;c.camera.right=bU*bT;break}c.camera.updateMatrixWorld();c.camera.updateProjectionMatrix()}}this.flipMagnetBar=function(){bB()};this.setCoilTurn=function(bU){var bT=Math.max(1,Math.min(10,Math.floor(bU)));if(bT!=bw.turn){bw.turn=bT;bC.coil=true}if(aH){for(var bS=0;bS<aH.length;bS++){aH[bS].setCoilSize(bw.rLoop,bw.coilGap,bw.turn)}}aa()};this.setCoilRadius=function(bS){ab(bS);aa()};function ab(bU){var bS=Math.max(2,Math.min(8,bU));if(bS!=bw.rLoop){bw.rLoop=bS;bC.coil=true}if(aH){for(var bT=0;bT<aH.length;bT++){aH[bT].setCoilSize(bw.rLoop,bw.coilGap,bw.turn)}}}this.setMagnetStrength=function(bT){var bS=Math.max(0.5,Math.min(2,bT));if(bS!=aP.strength){aP.strength=bS;bC.magnet=true}aa()};this.setOscilloscopeScale=function(bS){bA.yScale=bS;am();H.oscDisplay.grid.material.map.needsUpdate=true;aa()};this.setGalvanometerScale=function(bS){ax.scale=bS;aa()};this.isPlug=function(bS){return v[bS]};this.plug=function(bS){v[bS]=true;ap(v.bulb);bd(v.galvanometer);u(v.oscilloscope);ai();if(bS=="oscilloscope"){if(br){aX.setMute(false);aW.setMute(false)}}};this.unplug=function(bS){v[bS]=false;ap(v.bulb);bd(v.galvanometer);u(v.oscilloscope);ai();if(bS=="oscilloscope"){if(br){aX.setMute(true);aW.setMute(true)}}};function ai(){h=v.bulb||v.galvanometer||v.oscilloscope;var bS=0;if(v.bulb){bS++}if(v.galvanometer){bS++}if(v.oscilloscope){bS++}B=6/bS}this.isShown=function(bS){return a4[bS]};this.show=function(bS){a4[bS]=true;aD(a4.magnetField);bL(a4.electrons);q(a4.B)};this.unshow=function(bS){a4[bS]=false;aD(a4.magnetField);bL(a4.electrons);q(a4.B)};this.setMagnetPos=function(bS){aS.magnet=bS};this.setCoilPos=function(bS){aS.coil=bS};function bM(){bD=JSON.parse(JSON.stringify(aq));aj=atob(av);aB=AdaptiveFontSize.getVerticalCenteringDelta("100px CRL","A")/100;S=AdaptiveFontSize.getVerticalCenteringDelta("100px CRL","A")/100;aT=document.createElement("canvas");aK=PesonaBasic.addCanvas("frd_symbolN",{canvas:aT,index:-1,x:0,y:0,width:128,height:128},false,true);aF=document.createElement("canvas");n=PesonaBasic.addCanvas("frd_symbolS",{canvas:aF,index:-1,x:0,y:0,width:128,height:128},false,true);D=document.createElement("canvas");bP=PesonaBasic.addCanvas("frd_galvaFace",{canvas:D,index:-1,x:0,y:0,width:512,height:256},false,true);a5=document.createElement("canvas");aA=PesonaBasic.addCanvas("frd_oscFace",{canvas:a5,index:-1,x:0,y:0,width:512,height:512},false,true);bh=document.createElement("canvas");a9=PesonaBasic.addCanvas("frd_oscGridFace",{canvas:bh,index:-1,x:0,y:0,width:512,height:512},false,true);C=document.createElement("canvas");aw=PesonaBasic.addCanvas("frd_oscSpeaker",{canvas:C,index:-1,x:0,y:0,width:512,height:512},false,true);aE=document.createElement("canvas");ah=PesonaBasic.addCanvas("frd_p1",{canvas:aE,index:-1,x:0,y:0,width:512,height:512},false,true);aG=document.createElement("canvas");a2=PesonaBasic.addCanvas("frd_p2",{canvas:aG,index:-1,x:0,y:0,width:512,height:512},false,true);F=new coilCurve(bw.rLoop,bw.rCorner,bw.turn,bw.gap,bw.fLength1,bw.fLength2,bw.wireRad,bw.coilGap);f(false);be(0);a1();ai();ap(v.bulb);bd(v.galvanometer);u(v.oscilloscope);aD(a4.magnetField);bL(a4.electrons);q(a4.B);aL=0;d();aQ("siap",null);if(aH){for(var bS=0;bS<aH.length;bS++){aH[bS].setCoilSize(bw.rLoop,bw.coilGap,bw.turn)}}}function be(b3){var bV=b3*1000000;var b5=Math.abs(bV*100);var b1=0.8*Math.pow(Math.min(1,Math.abs(bV)),0.25);var bY;var bX=4*512/b5;var bW=Math.floor(256/bX);var bT=8/bw.rLoop;var bU,b4,b2;const bS=7;const b8=3.5;ah.clearRect(0,0,512,512);a2.clearRect(0,0,512,512);bY="rgba(100,220,100,"+b1+")";if(bV!=0){bU=ah;bU.save();bU.translate(256,256);bU.scale(bT,bT);bU.fillStyle=bY;bU.lineWidth=3;bU.strokeStyle=bY;var bZ=0;if(bV<0){for(var b6=-bW;b6<=bW;b6++){b2=b6*bX;for(var b0=-bW;b0<=bW;b0++){b4=b0*bX;bU.beginPath();bU.arc(b4,b2,b8,0,bp);bU.fill()}}}else{bU.beginPath();for(var b6=-bW;b6<=bW;b6++){b2=b6*bX;for(var b0=-bW;b0<=bW;b0++){b4=b0*bX;bU.moveTo(b4-bS,b2-bS);bU.lineTo(b4+bS,b2+bS);bU.moveTo(b4+bS,b2-bS);bU.lineTo(b4-bS,b2+bS)}}bU.stroke()}bU.restore()}var b7=H.coil.getObjectByName("penampang1");b7.material.map.needsUpdate=true;if(bV!=0){bU=a2;bU.save();bU.translate(256,256);bU.scale(bT,bT);bU.fillStyle=bY;bU.lineWidth=3;bU.strokeStyle=bY;if(bV>=0){for(var b6=-bW;b6<=bW;b6++){b2=b6*bX;for(var b0=-bW;b0<=bW;b0++){b4=b0*bX;bU.beginPath();bU.arc(b4,b2,b8,0,bp);bU.fill()}}}else{bU.beginPath();for(var b6=-bW;b6<=bW;b6++){b2=b6*bX;for(var b0=-bW;b0<=bW;b0++){b4=b0*bX;bU.moveTo(b4-bS,b2-bS);bU.lineTo(b4+bS,b2+bS);bU.moveTo(b4+bS,b2-bS);bU.lineTo(b4-bS,b2+bS)}}bU.stroke()}bU.restore()}var b7=H.coil.getObjectByName("penampang2");b7.material.map.needsUpdate=true}function bB(){bl=!bl;d();aa()}function d(){var bS=H.magnet.getObjectByName("bar");if(bl){bS.rotation.y=Math.PI}else{bS.rotation.y=0}}function ap(bS){H.bulb.visible=bS;var bT=H.cables.getObjectByName("cables_bohlam");bT.visible=bS}function bd(bS){H.galvanometer.visible=bS;var bT=H.cables.getObjectByName("cables_gal");bT.visible=bS}function u(bS){H.oscilloscope.visible=bS;var bT=H.cables.getObjectByName("cables_osc");bT.visible=bS}function aD(bS){H.magneticField.visible=bS}function bL(bS){H.electrons.visible=bS}function q(bT){var bU=H.coil.getObjectByName("penampang1");bU.visible=bT;var bS=H.coil.getObjectByName("penampang2");bS.visible=bT}function ao(){if(ae){ae.update()}c.renderer.render(c.scene,c.camera)}function aC(bT,bS){aS.omega.magnet=(aS.omegaPrev.magnet+(bp*(bT-aS.ts.magnet)/bf.Ttrans)%bp)%360;if(bf.Ttrans!=0){aS.magnet=bf.center+bf.amp*Math.cos(aS.omega.magnet)}else{aS.magnet=bf.center}aS.omega.coil=(aS.omegaPrev.coil+(bp*(bT-aS.ts.coil)/bb.Ttrans)%bp)%360;if(bb.Ttrans!=0){aS.coil=bb.center+bb.amp/2+0.5*bb.amp*Math.cos(aS.omega.coil)}else{aS.coil=bb.center}if(!bS){if(bf.Trot!=0){bm.magnet=(bm.prev.magnet+(bp*(bT-bm.ts.magnet)/bf.Trot)%bp)%bp}else{bm.magnet=0}if(bb.Trot!=0){bm.coil=(bm.prev.coil+(bp*(bT-bm.ts.coil)/bb.Trot)%bp)%bp}else{bm.coil=0}}}function e(){var b4=Date.now()-X;var b0=false;if(K==bn.AUTO){if(bf.Trot>0){var bY=Math.abs(aS.coil-aS.magnet);var b7=bw.coilGap;if(bw.turn==1){}else{if(bw.turn%2==0){var b8=bw.turn/2-1;bY+=b8*b7}else{var b8=bw.turn/2-1;bY+=b8*b7}}for(var b6=0;b6<bw.turn;b6++){if(bY<aJ){var bV=Math.sqrt(aJ*aJ-bY*bY);if(bV>bw.rLoop){aI(o.magnetTerhalang);bm.prev.magnet=bm.magnet;bm.ts.magnet=b4;var bZ=1;var b5=bw.rLoop-4*bw.wireRad;b5*=0.96;var bW=-(Math.atan2(bY,b5)-Math.acos(bZ/Math.sqrt(b5*b5+bY*bY)));if(bm.prev.magnet>al&&bm.prev.magnet<N){bW+=Math.PI}bm.magnet=bW;b0=true}}bY-=b7;if(b0){break}}}if(bb.Trot>0){var bZ=1;var b2=aP.length/2+aP.margin;var b1,bY;var b9=0;var cf=0;var bX=((bw.turn-1)*bw.coilGap+bw.wireRad)/2;var b3=bw.rLoop;var b5=Math.sqrt(bX*bX+b3*b3);b5*=0.99;var cg=Math.asin(bX/b5);var cd=new Array();cd.push({x:0,z:aS.magnet});cd.push({x:-bZ,z:aS.magnet+b2});cd.push({x:bZ,z:aS.magnet+b2});cd.push({x:-bZ,z:aS.magnet-b2});cd.push({x:bZ,z:aS.magnet-b2});for(var cc=0;cc<cd.length;cc++){bY=aS.coil-cd[cc].z;b1=cd[cc].x;p=Math.sqrt(b1*b1+bY*bY);if(p>b5){b9++}else{cf++}}if(!(b9==5||cf==5)){var bZ=1+2*bw.wireRad;var bW=al-Math.asin(bZ/b5)-cg;bm.prev.coil=bm.coil;bm.ts.coil=b4;bm.coil=bW;aI(o.kumparanTerhalang);b0=true}}}if(!b0&&y!=""){aI("")}if(bC.coil){bC.coil=false;a0(bw)}if(bC.magnet){bC.magnet=false;aN()}var ca=b4/1000;var bT=(b4-r)/1000;if(bT==0){return}var ce=true;if(K==bn.AUTO){aC(b4,b0)}else{}H.magnet.rotation.y=bm.magnet;H.magnet.position.z=aS.magnet;l(aS.coil);H.coil.rotation.y=bm.coil;if(ce){var ch=J(aS.magnet-aS.coil,bm.magnet,bm.coil,bT);var bU=(h)?ch.E*5000000:0;be(ch.B);if(r>0){bG(ca,bU);s(ca);aQ("data",{t:ca,B:ch.B,E:(h)?ch.E:0})}bs(b4,2*bU*ax.scale);if(h){aL+=0.6*bU*(b4-r)/B;bx(aL)}if(br){var bS=bU/100;var cb=bS*bS/10;cb*=bA.yScale;if(bS>=0){aX.setVolume(cb);aW.setVolume(0)}else{aX.setVolume(0);aW.setVolume(cb)}}Q(Math.abs(bU)/500);r=b4}}var af=Infinity;function J(cd,b2,cc,cb){var bV,bS,b6;var b4;var b9=aP.length/2;var ca=a6*aP.strength/2;const bZ=1;var b7=1;var b0=b7*b7;var bW=bw.rLoop*bw.rLoop;var bU=b9*Math.sin(b2-cc);var bY=b9*Math.cos(b2-cc);var b3=bU;var bX=cd-((bl)?-bY:bY);var b1=bU;var bT=cd+((bl)?-bY:bY);var b8=Math.sqrt(b3*b3+bX*bX);var b5=Math.sqrt(b1*b1+bT*bT);bV=-ca*bX*(1/Math.sqrt(b8*b8+bW)-1/Math.sqrt(b8*b8+b0));bS=ca*bT*(1/Math.sqrt(b5*b5+bW)-1/Math.sqrt(b5*b5+b0));b6=bV+bS;if(af===Infinity){b4=5e-12}else{b4=-bw.turn*(b6-af)/cb}af=b6;return{B:b6,E:b4}}function l(bS){H.circuit.position.z=bS;H.cable1.position.z=bS;H.cable2.position.z=bS;H.extension1.scale.set(1,bS,1);H.extension2.scale.set(1,bS,1)}function Q(bU){var bT=Math.min(3,bU);var bS=5*bT;H.lamp.shell.material.emissive=new THREE.Color(16777164);H.lamp.shell.material.emissiveIntensity=0.4*bS;H.lamp.light.intensity=0.45*bS}function bG(bS,bT){if(bA.rec.length>=bA.recMax){bA.rec.shift()}bA.rec.push({t:bS,E:bT})}function s(b1){var bT=aA;var bW=bA.screenWidth;var bU=bA.screenHeight;var bX=bA.rec;bT.beginPath();bT.rect(0,0,bW,bU);bT.fillStyle="#003344";bT.fill();var b6=bW;var bS=bU/2;var b0,bY;var b5=bA.rec.length;var b3=250;var b8=true;var b9;bT.beginPath();for(var b7=bX.length-1;b7>=0;b7--){b0=b6-(b1-bX[b7].t)*b3;b9=Math.min(300,Math.max(-300,bX[b7].E*bA.yScale));bY=bS-b9;if(b8){b8=false;bT.moveTo(b0,bY)}else{bT.lineTo(b0,bY)}}bT.lineWidth=4;bT.strokeStyle="rgba(40,200,220,0.6)";bT.stroke();if(br){var b2=at.icon_LED_speakerOn;var ca=50;var b4=b2.width*ca/b2.height;bT.drawImage(b2,b6-bW,bS-bU/2+5,b4,ca)}if(R){var bV=30;var bZ=bV*S;PesonaTextBlock.print3(bT,b6-bW/2,bS+bU/2-27+bZ,aj,bV,"center","middle",false,true,"CRL","rgba(255,255,255,0.4)",0,0)}H.oscDisplay.face.material.map.needsUpdate=true}function bs(bU,bT){var bS=45*t;a=Math.min(bS,Math.max(-bS,-bS*0.1*bT/100));H.galvaPointer.rotation.z=a}var Z=0;function aU(bU,bT){var bS=bu;a=Math.min(bS,Math.max(-bS,-bS*0.1*bT/45));if(a!=ad.aTarget){if((ad.a-a)!=0){ad.amp=ad.a-a;ad.w=bp/(20*ad.amp);ad.ym=a;ad.ts=bU;ad.aTarget=a}}var bV=(Date.now()-X)-ad.ts;ad.a=ad.ym+ad.amp*Math.cos(ad.w*bV)*Math.exp(-bV*0.005);ad.a=Math.min(bS,Math.max(-bS,ad.a));H.galvaPointer.rotation.z=ad.a}var ad={torq:0,w0:0,w:0,alp:0,ts:0,a0:0,a:0};var x={k:1,r:1,I:1};function bO(bV,bT){var bU=bT*1;if(bU!=ad.torq){ad.w0=ad.w;ad.a0=ad.a;var bS=ad.w0*x.r;ad.alp=(bU-x.k*bS)/x.I;ad.ts=bV;ad.torq=bU}var bW=(Date.now()-X)-ad.ts;ad.w=ad.w0+ad.alp*bW;ad.a=ad.w0*bW+0.5*ad.alp*bW*bW;H.galvaPointer.rotation.z=ad.a*0.03}function a1(){var bS=F.L;var bZ=Math.round(0.6*bS);var bU;var bY;var bX=new THREE.SphereBufferGeometry(0.2,8,8);var bV=new THREE.MeshBasicMaterial({color:16777215,transparent:true,opacity:0.4});var bW;for(var bT=0;bT<bZ;bT++){bU=bT/bZ;bY=F.getPoint(bU);bW=new THREE.Mesh(bX,bV);bW.tMark=bU*1000;bW.position.set(bY.x,bY.y,bY.z);H.electrons.add(bW)}}function bx(bW){var bS=bW/F.L;var bU=H.electrons.children;var bT;var bX;for(var bV=0;bV<bU.length;bV++){bT=((bU[bV].tMark+bS)%1000)/1000;if(bT<0){bT+=1}bX=F.getPoint(bT);bU[bV].position.set(bX.x,bX.y,bX.z)}}function T(bU,bS,bW,bT){var bV=bT-al;bU.position.set(bS.x+bW*Math.cos(bV),bS.y,bS.z+bW*Math.sin(bV));bU.rotation.y=-bT}function f(bT){c.scene=new THREE.Scene();c.renderer=new THREE.WebGLRenderer({canvas:G,alpha:true,antialias:true,premultipliedAlpha:true});c.renderer.setViewport(0,0,G.width,G.height);c.renderer.shadowMap.enabled=true;c.renderer.shadowMap.type=THREE.PCFSoftShadowMap;var bX=new THREE.HemisphereLight(16777215,16777215,0.3);c.scene.add(bX);var bW=new THREE.SpotLight(16777215,0.4);bW.position.set(150,450,850);bW.target.position.set(0,0,0);c.scene.add(bW.target);c.scene.add(bW);var bW=new THREE.SpotLight(16777215,0.3);bW.position.set(-150,450,-850);bW.target.position.set(0,0,0);c.scene.add(bW.target);c.scene.add(bW);c.raycaster=new THREE.Raycaster();I=new THREE.Group();I.name="faraday";H.magnet=a8();H.magnet.position.z=15;I.add(H.magnet);H.magneticField=H.magnet.getObjectByName("magneticField");H.circuit=au(bw);I.add(H.circuit);H.coil=H.circuit.getObjectByName("coil");H.electrons=H.circuit.getObjectByName("electrons");H.connector=O(bw);I.add(H.connector);H.bulb=Y();I.add(H.bulb);H.lamp.shell=H.bulb.getObjectByName("shell");H.lamp.light=H.bulb.getObjectByName("light");H.galvanometer=bQ();I.add(H.galvanometer);H.galvaPointer=H.galvanometer.getObjectByName("pointer");H.oscilloscope=ag();I.add(H.oscilloscope);H.oscDisplay.face=H.oscilloscope.getObjectByName("face");H.oscDisplay.grid=H.oscilloscope.getObjectByName("grid");H.oscDisplay.speaker=H.oscilloscope.getObjectByName("speaker");H.magnet.position.y=-7.5;H.circuit.position.y=-7.5;H.bulb.position.y=8.5;H.bulb.position.z=-1;H.connector.position.y=0.5;H.connector.position.z=-6;T(H.galvanometer,{x:0,y:2.5,z:0},22,-15*t);T(H.oscilloscope,{x:0,y:0,z:0},24,-70*t);c.scene.add(I);I.updateMatrixWorld(true);H.cables=m();I.add(H.cables);H.cable1=H.cables.getObjectByName("kabel1");H.cable2=H.cables.getObjectByName("kabel2");H.extension1=H.cable1.getObjectByName("extension");H.extension2=H.cable2.getObjectByName("extension");var bU=(bT==undefined)?false:bT;if(bU){var bS=G.width/G.height;var bV=20;c.camera=new THREE.OrthographicCamera(-bV*bS,bV*bS,bV,-bV,1,1000);c.camera.lookAt(0,0,0);c.camera.updateMatrixWorld()}else{c.camera=new THREE.PerspectiveCamera(50,G.width/G.height,1,1000);c.camera.lookAt(0,0,0);c.camera.updateMatrixWorld()}c.camera.position.set(j.r*Math.sin(j.polar)*Math.cos(al-j.azimuthal),j.r*Math.cos(j.polar),j.r*Math.sin(j.polar)*Math.sin(al-j.azimuthal));c.camera.lookAt(0,0,0);c.camera.updateProjectionMatrix();ae=new THREE.OrbitControls(c.camera,c.renderer.domElement,null);ae.enablePan=false;ae.enableZoom=false;ae.dampingFactor=0.04;ae.enableDamping=true;ae.minAzimuthAngle=-60*t;ae.maxAzimuthAngle=140*t;ae.minPolarAngle=20*t;ae.maxPolarAngle=160*t;ae.enabled=true;bv.push(new THREE.TransformControls(c.camera,c.renderer.domElement));bv[0].enabled=true;bv[0].setMode("translate");bv.push(new THREE.TransformControls(c.camera,c.renderer.domElement));bv[1].enabled=true;bv[1].setMode("translate");bv[0].attach(H.magnet);bv[0].showX=false;bv[0].showY=false;bv[0].showZ=true;bv[1].attach(H.circuit);bv[1].showX=false;bv[1].showY=false;bv[1].showZ=true;bv[0].addEventListener("objectChange",ay);bv[0].addEventListener("dragging-changed",function(bY){if(K==bn.MANUAL){ae.enabled=!bY.value;if(bY.value){document.body.style.cursor="grab"}}});bv[0].addEventListener("mouseUp",function(bY){if(K==bn.MANUAL){ae.enabled=true;document.body.style.cursor="default"}});bv[1].addEventListener("objectChange",bg);bv[1].addEventListener("dragging-changed",function(bY){if(K==bn.MANUAL){ae.enabled=!bY.value;if(bY.value){document.body.style.cursor="grab"}}});bv[1].addEventListener("mouseUp",function(bY){if(K==bn.MANUAL){ae.enabled=true;document.body.style.cursor="default"}});c.scene.add(bv[0]);c.scene.add(bv[1]);if(K==bn.MANUAL){bv[0].addEventListener("click",bq);bv[1].addEventListener("click",bq)}}function bq(bW){if(!ae.enabled){return}var bS=new THREE.Vector2;var bX=PesonaBasic.getAbsolutePosition(bK);bS.x=((bW.data.x-bX.x)/(k*aR))*2-1;bS.y=-((bW.data.y-bX.y)/(ac*bz))*2+1;c.camera.updateProjectionMatrix();c.camera.updateMatrixWorld();c.raycaster.setFromCamera(bS,c.camera);var bU=c.raycaster.intersectObjects(c.scene.children,true);var bV=false;for(var bT=0;bT<bU.length;bT++){if(bU[bT].object.userData){if(bU[bT].object.userData.id){switch(bU[bT].object.userData.id){case"GESERMAGNET":if(bv[0].showZ){bv[0].setAxis("Z");ae.enabled=false}bV=true;break;case"GESERCOIL":if(bv[1].showZ){bv[1].setAxis("Z");ae.enabled=false}bV=true;break}}}if(bV){break}}}function ay(){aS.magnet=Math.max(-20,Math.min(20,H.magnet.position.z));H.magnet.position.z=aS.magnet}function bg(){aS.coil=Math.max(0,Math.min(15,H.circuit.position.z));l(aS.coil)}function a8(){var bX;var b3,b2;var b5=new THREE.Group();b5.name="magnet";var b1=new THREE.Group();b1.name="bar";var bT={width:2,height:1.2,length:aP.length+2*aP.margin};var bS=0.1;var b4=bT.width/2;var bY=bT.height/2;var bW=bT.length/2;var b0=new THREE.Shape();b0.absarc(-b4+bS,bY-bS,bS,al,Math.PI);b0.absarc(-b4+bS,-bY+bS,bS,Math.PI,N);b0.absarc(b4-bS,-bY+bS,bS,N,bp);b0.absarc(b4-bS,bY-bS,bS,0,al);const bV={steps:1,depth:bW,bevelEnabled:true,bevelThickness:0.1,bevelSize:0.1};b3=new THREE.ExtrudeGeometry(b0,bV);b2=new THREE.MeshPhongMaterial({color:16711765,shininess:50,specular:2236962});bX=new THREE.Mesh(b3,b2);bX.position.z=-bW;b1.add(bX);bX.userData={id:"GESERMAGNET"};b3=new THREE.ExtrudeGeometry(b0,bV);b2=new THREE.MeshPhongMaterial({color:17663,shininess:50,specular:2236962});bX=new THREE.Mesh(b3,b2);b1.add(bX);bX.userData={id:"GESERMAGNET"};var bZ=100*S;var bU=aK;bU.clearRect(0,0,128,128);bU.beginPath();bU.rect(0,0,128,128);bU.fillStyle="#0044ff";bU.fill();bU.font="Bold 100px CR";bU.textAlign="center";bU.textBaseline="middle";bU.fillStyle="#ffffff";bU.fillText(o.S,64,64+bZ);var bU=n;bU.clearRect(0,0,128,128);bU.beginPath();bU.rect(0,0,128,128);bU.fillStyle="#ff0055";bU.fill();bU.font="Bold 100px CR";bU.textAlign="center";bU.textBaseline="middle";bU.fillStyle="#ffffff";bU.fillText(o.U,64,64+bZ);b2=new THREE.MeshPhongMaterial({color:16777215,transparent:false,shininess:50,specular:2236962,side:THREE.FrontSide});b2.map=new THREE.CanvasTexture(aT);b2.map.anisotropy=16;b3=new THREE.PlaneGeometry(0.8*bT.width,0.8*bT.width,1);bX=new THREE.Mesh(b3,b2);bX.rotation.x=-al;bX.position.set(0,bY+0.11,0.82*bW);b1.add(bX);b2=new THREE.MeshPhongMaterial({color:16777215,transparent:false,shininess:50,specular:2236962,side:THREE.FrontSide});b2.map=new THREE.CanvasTexture(aF);b2.map.anisotropy=16;b3=new THREE.PlaneGeometry(0.8*bT.width,0.8*bT.width,1);bX=new THREE.Mesh(b3,b2);bX.rotation.x=-al;bX.rotation.z=Math.PI;bX.position.set(0,bY+0.11,-0.82*bW);b1.add(bX);var b6=new THREE.Group();b6.name="magneticField";bX=ar(b6);b1.add(bX);b5.add(b1);return b5}function ar(bT){var bV=a7(true,34816,0.5);bT.add(bV);bV=a7(false,34816,0.25);var bU=Math.round(aP.strength*5);for(var bS=1;bS<bU;bS++){sd=Math.PI*bS/bU;obj=bV.clone();obj.rotation.z=sd;bT.add(obj)}return bT}function W(bY,cq,ck){var cx=new THREE.Group();var b6=a6*aP.strength/(4*Math.PI);var bS=aP.length/2;var cF=-bS;var cz=0;var cv=0;var bZ,bX;var cA=0.1;var cw=0.25;var bZ,bX;var cb,cs,cr;var cf,b9,b5;var b8,b3,ce,cc;var cn=5*aP.length;var co;var cu,cd;var cy,cj;var b4,b2;var cH;var cm;var b0,bV;var bT,cG,b7,b1;var cB=0;var cp=0;var cC;var bW=0.6;var ca=0.6*bW;var cl=new THREE.Shape();cl.moveTo(bW/2,0);cl.lineTo(-bW/2,ca/2);cl.lineTo(-bW/2,-ca/2);cl.lineTo(bW/2,0);var ch=new THREE.ShapeBufferGeometry(cl);var cD=new THREE.MeshBasicMaterial({color:cq,transparent:true,opacity:ck,side:THREE.DoubleSide});var ct=new THREE.Mesh(ch,cD);ct.rotation.y=al;var bU;var cg=Math.round(aP.strength*16);var ci=(bY)?0:1;for(var cE=ci;cE<cg;cE++){co=bp*cE/cg;b0=ak(100,cq,ck);b0.renderOrder=1;cx.add(b0);bT=b0.geometry;console.log(bT.attributes.position.array.length);b7=new Float32Array(100*3);bV=ak(100,cq,ck);b0.renderOrder=1;cx.add(bV);cG=bV.geometry;b1=new Float32Array(100*3);cu=bS+cA*Math.cos(co);cd=cz+cA*Math.sin(co);cC=0;b7[0]=0;b7[1]=cd;b7[2]=-cu;b1[0]=0;b1[1]=cd;b1[2]=cu;cH=false;cm=false;do{bZ=cu-bS;bX=cd-cz;cc=Math.sqrt(bZ*bZ+bX*bX);cf=b6/(cc*cc);theta=Math.atan2(bX,bZ);b9=cf*Math.cos(theta);b5=cf*Math.sin(theta);bZ=cu-cF;bX=cd-cv;cc=Math.sqrt(bZ*bZ+bX*bX);cb=b6/(cc*cc);theta=Math.atan2(bX,bZ);cs=-cb*Math.cos(theta);cr=-cb*Math.sin(theta);b8=b9+cs;b3=b5+cr;ce=Math.sqrt(b8*b8+b3*b3);theta=Math.atan2(b3,b8);bZ=cw*Math.cos(theta);bX=cw*Math.sin(theta);if(cu+bZ<=0){bX=bX*(-cu)/bZ;bZ=-cu;cH=true;if(bY){bU=ct.clone();bU.position.set(0,cd,0);bU.rotation.x=Math.PI;cx.add(bU)}}cu+=bZ;cd+=bX;cC++;b7[3*cC]=0;b7[3*cC+1]=cd;b7[3*cC+2]=-cu;b1[3*cC]=0;b1[3*cC+1]=cd;b1[3*cC+2]=cu;cc=Math.sqrt((cu-bS)*(cu-bS)+(cd-cz)*(cd-cz));cH=cH||cc>=cn;if(bY&&cc>=aP.length/3&&!cm){cm=true;bU=ct.clone();bU.position.set(0,cd,-cu);bU.rotation.x=Math.atan2(bX,bZ);cx.add(bU);bU=ct.clone();bU.position.set(0,cd,cu);bU.rotation.x=Math.atan2(-bX,bZ);cx.add(bU)}}while(!cH);console.log(b1);bT.setPositions(b7);cG.setPositions(b1);bT.setDrawRange(0,cC+1);cG.setDrawRange(0,cC+1);bT.attributes.position.needsUpdate=true;cG.attributes.position.needsUpdate=true}return cx}function a7(bY,cq,ck){var cx=new THREE.Group();var b6=a6*aP.strength/(4*Math.PI);var bS=aP.length/2;var cF=-bS;var cz=0;var cv=0;var bZ,bX;var cA=0.1;var cw=0.25;var bZ,bX;var cb,cs,cr;var cf,b9,b5;var b8,b3,ce,cc;var cn=5*aP.length;var co;var cu,cd;var cy,cj;var b4,b2;var cH;var cm;var b0,bV;var bT,cG,b7,b1;var cB=0;var cp=0;var cC;var bW=0.6;var ca=0.6*bW;var cl=new THREE.Shape();cl.moveTo(bW/2,0);cl.lineTo(-bW/2,ca/2);cl.lineTo(-bW/2,-ca/2);cl.lineTo(bW/2,0);var ch=new THREE.ShapeBufferGeometry(cl);var cD=new THREE.MeshBasicMaterial({color:cq,transparent:true,opacity:ck,side:THREE.DoubleSide});var ct=new THREE.Mesh(ch,cD);ct.rotation.y=al;var bU;var cg=Math.round(aP.strength*16);var ci=(bY)?0:1;for(var cE=ci;cE<cg;cE++){co=bp*cE/cg;b0=ak(100,cq,ck);cx.add(b0);bT=b0.geometry;b7=bT.attributes.position.array;bV=ak(100,cq,ck);cx.add(bV);cG=bV.geometry;b1=cG.attributes.position.array;cu=bS+cA*Math.cos(co);cd=cz+cA*Math.sin(co);cC=0;b7[0]=0;b7[1]=cd;b7[2]=-cu;b1[0]=0;b1[1]=cd;b1[2]=cu;cH=false;cm=false;do{bZ=cu-bS;bX=cd-cz;cc=Math.sqrt(bZ*bZ+bX*bX);cf=b6/(cc*cc);theta=Math.atan2(bX,bZ);b9=cf*Math.cos(theta);b5=cf*Math.sin(theta);bZ=cu-cF;bX=cd-cv;cc=Math.sqrt(bZ*bZ+bX*bX);cb=b6/(cc*cc);theta=Math.atan2(bX,bZ);cs=-cb*Math.cos(theta);cr=-cb*Math.sin(theta);b8=b9+cs;b3=b5+cr;ce=Math.sqrt(b8*b8+b3*b3);theta=Math.atan2(b3,b8);bZ=cw*Math.cos(theta);bX=cw*Math.sin(theta);if(cu+bZ<=0){bX=bX*(-cu)/bZ;bZ=-cu;cH=true;if(bY){bU=ct.clone();bU.position.set(0,cd,0);bU.rotation.x=Math.PI;cx.add(bU)}}cu+=bZ;cd+=bX;cC++;b7[3*cC]=0;b7[3*cC+1]=cd;b7[3*cC+2]=-cu;b1[3*cC]=0;b1[3*cC+1]=cd;b1[3*cC+2]=cu;cc=Math.sqrt((cu-bS)*(cu-bS)+(cd-cz)*(cd-cz));cH=cH||cc>=cn;if(bY&&cc>=aP.length/3&&!cm){cm=true;bU=ct.clone();bU.position.set(0,cd,-cu);bU.rotation.x=Math.atan2(bX,bZ);cx.add(bU);bU=ct.clone();bU.position.set(0,cd,cu);bU.rotation.x=Math.atan2(-bX,bZ);cx.add(bU)}}while(!cH);bT.setDrawRange(0,cC+1);cG.setDrawRange(0,cC+1)}return cx}function bH(bX,bT,bU){var bW=new Float32Array(bX*3);var bY=new THREE.LineGeometry();bY.setPositions(bW);bY.setDrawRange(0,0);const bV=new THREE.LineMaterial({color:new THREE.Color(bT),linewidth:1,transparent:true,opacity:bU,depthWrite:false,blending:THREE.NormalBlending,vertexColors:false});bV.resolution.set(window.innerWidth,window.innerHeight);bV.depthWrite=false;bV.transparent=true;var bS=new THREE.Line2(bY,bV);bS.renderOrder=1;return bS}function ak(bW,bS,bT){var bV=new Float32Array(bW*3);var bX=new THREE.BufferGeometry();bX.setAttribute("position",new THREE.BufferAttribute(bV,3));bX.setDrawRange(0,0);var bU=new THREE.LineBasicMaterial({color:bS,linewidth:1,transparent:true,opacity:bT});return new THREE.Line(bX,bU)}function Y(){var bS=new THREE.Group();bS.name="bulb";var bU=0;var b0=new THREE.Path();b0.moveTo(0.48,0);b0.absarc(0.48,0.15,0.15,-al,0);b0.bezierCurveTo(0.63,0.7038,2,1.7923,2,3.2);b0.absarc(0,3.2,2,0,80*t);var bY=b0.getPoints();geometry=new THREE.LatheGeometry(bY,32);var bX=new THREE.MeshPhongMaterial({color:16777215,transparent:false,opacity:1,emissive:16777164,emissiveIntensity:bU,shininess:100,specular:1118481,side:THREE.FrontSide});var bW=new THREE.Mesh(geometry,bX);bW.name="shell";bS.add(bW);geometry=new THREE.SphereGeometry(2,32,32,0,bp,0,10*t);var bW=new THREE.Mesh(geometry,bX);bW.position.y=3.2;bS.add(bW);var bV=new THREE.PointLight(16777164,1,50,2);bV.name="light";bV.position.y=3.2;bS.add(bV);var bZ=new THREE.Group();b0=new THREE.Path();b0.moveTo(1.6,0);b0.quadraticCurveTo(1.8,0.25,1.8,0.75);b0.lineTo(1.8,1.75);b0.quadraticCurveTo(1.8,2,2,2);b0.lineTo(2,2.75);b0.quadraticCurveTo(1.8,2.75,1.8,3);b0.lineTo(1.4,3.25);bY=b0.getPoints();geometry=new THREE.LatheGeometry(bY,32);bX=new THREE.MeshPhongMaterial({color:16777215,shininess:1,specular:6710886});bW=new THREE.Mesh(geometry,bX);var bT=0.45;bW.scale.set(bT,bT,bT);bZ.add(bW);geometry=new THREE.CylinderGeometry(1.6*bT,1.6*bT,0.3,32);bW=new THREE.Mesh(geometry,bX);bW.position.y=-0.15;bZ.add(bW);geometry=new THREE.CircleGeometry(0.3,8);bX=new THREE.MeshBasicMaterial({color:0});bW=new THREE.Mesh(geometry,bX);bW.name="socket1";bW.rotation.x=al;bW.position.y=-0.28;bW.position.x=0.3;bZ.add(bW);bW=new THREE.Mesh(geometry,bX);bW.name="socket2";bW.rotation.x=al;bW.position.y=-0.28;bW.position.x=-0.3;bZ.add(bW);bZ.position.y=-1.4;bS.add(bZ);return(bS)}function bQ(){var bW={width:12,height:10,depth:1,baseHeight:3.6};var cd=new THREE.Group();cd.name="galvanometer";var ck=new THREE.MeshPhongMaterial({color:2236962,shininess:0,specular:1118481,side:THREE.DoubleSide});var b3=new THREE.BoxGeometry(bW.width,bW.baseHeight,bW.depth/2);b3.faces.splice(4,2);var bS=new THREE.Mesh(b3,ck);bS.position.y=bW.baseHeight/2;cd.add(bS);b3=new THREE.BoxBufferGeometry(bW.width,bW.height,bW.depth/2);bS=new THREE.Mesh(b3,ck);bS.position.y=bW.height/2;bS.position.z=-bW.depth/2;cd.add(bS);var ch=new THREE.Shape();var cf=bW.width;var co=bW.depth;ch.moveTo(-cf/2,co/2);ch.lineTo(-cf/2,0);ch.lineTo(cf/2,0);ch.lineTo(cf/2,co/2);ch.lineTo(cf/5,co/2);var ci=3*co/8;ch.absarc(cf/5-ci,co/2,ci,0,-al,true);ch.lineTo(-cf/5+ci,co/8);ch.absarc(-cf/5+ci,co/2,ci,-al,-Math.PI,true);ch.lineTo(-cf/2,co/2);b3=new THREE.ShapeGeometry(ch);bS=new THREE.Mesh(b3,ck);bS.rotation.x=-al;bS.position.y=bW.baseHeight;bS.position.z=bW.depth/4;cd.add(bS);var bU=0.98*bW.width;var cq=0.98*(bW.height-bW.baseHeight);ck=new THREE.MeshBasicMaterial({color:16777215});ck.map=new THREE.CanvasTexture(D);ck.map.anisotropy=16;b3=new THREE.PlaneGeometry(bU,cq,1);var ca=new THREE.Mesh(b3,ck);ca.position.z=-bW.depth/4+0.01;var cc=(bW.baseHeight+bW.height)/2+(bW.height-bW.baseHeight-cq)/4;ca.position.y=cc;cd.add(ca);ck=new THREE.ShadowMaterial({opacity:0.15});b3=new THREE.PlaneGeometry(bU,cq,1);bS=new THREE.Mesh(b3,ck);bS.receiveShadow=true;bS.position.z=-bW.depth/4+0.02;bS.position.y=cc;cd.add(bS);ck=new THREE.MeshPhongMaterial({color:14737632,transparent:true,opacity:0.1,shininess:60,specular:8947848});b3=new THREE.BoxBufferGeometry(bW.width,bW.height-bW.baseHeight,bW.depth/2);bS=new THREE.Mesh(b3,ck);bS.position.y=(bW.baseHeight+bW.height)/2;cd.add(bS);var b6=new THREE.Group();b6.name="pointer";var ci=0.2*bW.baseHeight;ck=new THREE.MeshPhongMaterial({color:1118481,shininess:10,specular:6710886});b3=new THREE.CylinderGeometry(ci,ci,0.18*bW.depth,32);bS=new THREE.Mesh(b3,ck);bS.rotation.x=al;b6.add(bS);var b1=0.72*bW.height;ck=new THREE.MeshPhongMaterial({color:13369344,shininess:5,specular:3355443});b3=new THREE.BoxBufferGeometry(0.12,b1,0.08);bS=new THREE.Mesh(b3,ck);bS.position.y=0.5*b1;bS.castShadow=true;b6.add(bS);var b5=bW.baseHeight/2;b6.position.y=b5;b6.position.z=-0.02*bW.depth;var cp=bP;var cl=0.5*bU/cq;cp.scale(1,cl);cp.beginPath();cp.rect(0,0,512,256/cl);cp.fillStyle="#d8d8d8";cp.fill();var ce=256/cq;var cj=(cc-b5)*ce;var cg=b1*ce-20;var b0=cg-10;var bZ=cg+22;var bY=cg+12;var bX=cg+5;var b9=256;var b7=(128+cj)/cl;var b8,ci;var b4,cs,b2,cr;var cn;cp.strokeStyle="#222222";for(var cm=0;cm<=60;cm++){b8=(-135+cm*1.5)*t;b4=b9+b0*Math.cos(b8);cs=b7+b0*Math.sin(b8);if(cm%10==0){ci=bZ;co=3}else{if(cm%5==0){ci=bY;co=2}else{ci=bX;co=2}}b2=b9+ci*Math.cos(b8);cr=b7+ci*Math.sin(b8);cp.beginPath();cp.moveTo(b4,cs);cp.lineTo(b2,cr);cp.lineWidth=co;cp.stroke()}cp.beginPath();cp.arc(b9,b7,b0+2.5,-135*t,-45*t);cp.lineWidth=6;cp.stroke();var cb;cb=75*aB;cp.font="bold 75px CR";cp.textAlign="center";cp.textBaseline="middle";cp.fillStyle="#444444";cp.fillText("V",b9,b7-0.65*b0+cb);cb=32*aB;cp.font="32px CRL";cp.fillText(o.galvanometer,b9,b7-0.65*b0+48+cb);cb=48*aB;cp.font="Bold 48px CR";cp.fillText("0",b9,b7-bZ-20+cb);var bV=(b0-30)*Math.cos(al/2);var bT=(b0-30)*Math.sin(al/2);cb=50*aB;cp.font="Bold 50px CR";cp.fillText("+",b9+bV,b7-bT+cb);cp.fillText("âˆ’",b9-bV,b7-bT+cb);ca.material.map.needsUpdate=true;cd.add(b6);bS=bN(8912896);bS.rotation.x=al;bS.position.set(0.7*bW.width/2,bW.baseHeight/2,bW.depth/4);bS.name="socket1";cd.add(bS);bS=bN(13226);bS.rotation.x=al;bS.position.set(-0.7*bW.width/2,bW.baseHeight/2,bW.depth/4);bS.name="socket2";cd.add(bS);return cd}function bN(bS){var bT=new mySocket();var bW=new THREE.Shape();bW.moveTo(0.5,0);bW.lineTo(0.5,0.15);bW.absarc(0.4,0.15,0.1,0,al);bW.lineTo(0.4,0.4);bW.quadraticCurveTo(0.5,0.4,0.45,0.56);bW.lineTo(0.37,1);bW.quadraticCurveTo(0.35,1.1,0.28,1.1);bW.lineTo(0.2,1.1);bW.lineTo(0.2,0.5);bW.lineTo(0,1,0.5);var bU=bW.getPoints(50);geometry=new THREE.LatheGeometry(bU,32);material=new THREE.MeshPhongMaterial({color:bS,shininess:5,specular:2236962});var bV=new THREE.Mesh(geometry,material);bT.add(bV);return bT}function A(bU,bV){var bS=1;var bW=0.4;var b4=bS*2*bU;var b6=2*bS;var b0=1.2*bS;var bZ=new THREE.Group();var b3=new THREE.Shape();b3.moveTo(-b4/2,0);b3.lineTo(-b4/2,b0-bW);b3.absarc(-b4/2+bW,b0-bW,bW,Math.PI,al,true);b3.absarc(b4/2-bW,b0-bW,bW,al,0,true);b3.lineTo(b4/2,0);b3.lineTo(-b4/2,0);var bT={curveSegments:24,steps:1,depth:b6,bevelEnabled:true,bevelThickness:0.1,bevelSize:0.1};var b5=new THREE.ExtrudeGeometry(b3,bT);var b2=new THREE.MeshPhongMaterial({color:4473924,shininess:2,specular:0});var bY=new THREE.Mesh(b5,b2);bY.rotation.y=al;bY.position.x=-b6/2;bZ.add(bY);b2=new THREE.MeshPhongMaterial({color:6710886,shininess:0,specular:1118481});b5=new THREE.TorusGeometry(0.28,0.12,12,12);bY=new THREE.Mesh(b5,b2);bY.position.y=b0/2;bY.position.z=b4/2+0.2;bY.name="socket";bZ.add(bY);var b1=(0.5*(2*bU-1)-0.5)*bS;for(var bX=0;bX<bU;bX++){z=b1-2*bX*bS;bY=bN(bV[bX]);bY.name="socket"+(bX+1).toString();bY.position.set(0,b0,z);bZ.add(bY)}return bZ}function P(bZ,bT){var bW=new cableCurve_splitRing(H.circuit.getObjectByName("brush1").getObjectByName("socket"),H.connector.getObjectByName("socketBox1").getObjectByName("socket"),bT);var bX=new THREE.TubeBufferGeometry(bW,200,0.12,16,false);var bU=new THREE.MeshPhongMaterial({color:4473924,transparent:false,shininess:20,specular:3355443});var bS=new THREE.Group();bS.name="kabel1";var bV=new THREE.Mesh(bX,bU);bS.add(bV);bX=new THREE.CylinderGeometry(0.12,0.12,1,16);bX.applyMatrix4(new THREE.Matrix4().makeTranslation(0,0.5,0));bV=new THREE.Mesh(bX,bU);bV.name="extension";bV.rotation.x=-al;bV.position.x=bW.pos2.x;bV.position.y=bW.pos2.y;bV.position.z=bW.pos2.z;bS.add(bV);bZ.add(bS);bW=new cableCurve_splitRing(H.circuit.getObjectByName("brush2").getObjectByName("socket"),H.connector.getObjectByName("socketBox2").getObjectByName("socket"),bT);bX=new THREE.TubeBufferGeometry(bW,32*Math.round(bW.L),0.12,16,false);var bY=new THREE.Group();bY.name="kabel2";bV=new THREE.Mesh(bX,bU);bY.add(bV);bX=new THREE.CylinderGeometry(0.12,0.12,1,16);bX.applyMatrix4(new THREE.Matrix4().makeTranslation(0,0.5,0));bV=new THREE.Mesh(bX,bU);bV.name="extension";bV.rotation.x=-al;bV.position.x=bW.pos2.x;bV.position.y=bW.pos2.y;bV.position.z=bW.pos2.z;bY.add(bV);bZ.add(bY)}function m(){var bV=new THREE.Group();P(bV,new THREE.Vector3(0,0,0));var bS=new THREE.Group();bS.name="cables_bohlam";path=new cableCurve_bohlam(H.connector.getObjectByName("socketBox1").getObjectByName("socket1"),H.bulb.getObjectByName("socket1"));material=new THREE.MeshPhongMaterial({color:8947848,transparent:false,shininess:20,specular:3355443});geometry=new THREE.TubeBufferGeometry(path,32*Math.round(path.L),0.12,8,false);obj=new THREE.Mesh(geometry,material);bS.add(obj);path=new cableCurve_bohlam(H.connector.getObjectByName("socketBox2").getObjectByName("socket1"),H.bulb.getObjectByName("socket2"));material=new THREE.MeshPhongMaterial({color:8947848,transparent:false,shininess:20,specular:3355443});geometry=new THREE.TubeBufferGeometry(path,32*Math.round(path.L),0.12,8,false);obj=new THREE.Mesh(geometry,material);bS.add(obj);bV.add(bS);var bU=new THREE.Group();bU.name="cables_osc";material=new THREE.MeshPhongMaterial({color:17459,transparent:false,shininess:20,specular:3355443});path=new cableCurve_alat(H.connector.getObjectByName("socketBox1").getObjectByName("socket2"),H.oscilloscope.getObjectByName("socket1"),8.5);geometry=new THREE.TubeBufferGeometry(path,100,0.12,8,false);obj=new THREE.Mesh(geometry,material);bU.add(obj);path=new cableCurve_alat(H.connector.getObjectByName("socketBox2").getObjectByName("socket2"),H.oscilloscope.getObjectByName("socket2"),8);geometry=new THREE.TubeBufferGeometry(path,100,0.12,8,false);obj=new THREE.Mesh(geometry,material);bU.add(obj);bV.add(bU);var bT=new THREE.Group();bT.name="cables_gal";material=new THREE.MeshPhongMaterial({color:6693410,transparent:false,shininess:20,specular:3355443});path=new cableCurve_alat(H.connector.getObjectByName("socketBox1").getObjectByName("socket3"),H.galvanometer.getObjectByName("socket1"),6);geometry=new THREE.TubeBufferGeometry(path,100,0.12,8,false);obj=new THREE.Mesh(geometry,material);bT.add(obj);material=new THREE.MeshPhongMaterial({color:2250120,transparent:false,shininess:20,specular:3355443});path=new cableCurve_alat(H.connector.getObjectByName("socketBox2").getObjectByName("socket3"),H.galvanometer.getObjectByName("socket2"),6);geometry=new THREE.TubeBufferGeometry(path,100,0.12,8,false);obj=new THREE.Mesh(geometry,material);bT.add(obj);bV.add(bT);return bV}function ag(){var b8={width:18,height:15.4,depth:0.3,corner:0.8,scrWidth:17.4,scrHeight:12,scrCorner:0.6};b8.scrHeight=3*b8.scrWidth/4;var b2=new THREE.Group();b2.name="oscilloscope";var bT=new THREE.Shape();var b3=b8.width;var cb=b8.height;var b7=b8.corner;var b9=0.2*b7;bT.absarc(-b3/2+b9,b9,b9,-Math.PI,-al);bT.absarc(b3/2-b9,b9,b9,-al,0);bT.absarc(b3/2-b7,cb-b7,b7,0,al);bT.absarc(-b3/2+b7,cb-b7,b7,al,Math.PI);var b4=new THREE.Shape();var bS=b8.scrWidth;var cc=b8.scrHeight;var b1=b8.scrCorner;var b6=(b3-bS)/2;b4.absarc(bS/2-b1,cb-b6-cc+b1,b1,0,-al,true);b4.absarc(-bS/2+b1,cb-b6-cc+b1,b1,-al,-Math.PI,true);b4.absarc(-bS/2+b1,cb-b6-b1,b1,Math.PI,al,true);b4.absarc(bS/2-b1,cb-b6-b1,b1,al,0,true);bT.holes.push(b4);var cd={curveSegments:24,steps:1,depth:b8.depth,bevelEnabled:true,bevelThickness:0.4,bevelSize:0.4};var bY=new THREE.ExtrudeGeometry(bT,cd);var b5=new THREE.MeshPhongMaterial({color:6710886,shininess:2,specular:0});obj=new THREE.Mesh(bY,b5);b2.add(obj);bT=new THREE.Shape();bT.moveTo(bS/2,cb-b6-cc);bT.lineTo(-bS/2,cb-b6-cc);bT.lineTo(-bS/2,cb-b6);bT.lineTo(bS/2,cb-b6);bT.lineTo(bS/2,cb-b6-cc);cd={curveSegments:24,steps:1,depth:1.5*b8.depth,bevelEnabled:true,bevelThickness:0.1,bevelSize:0.1};bY=new THREE.ExtrudeGeometry(bT,cd);obj=new THREE.Mesh(bY,b5);obj.position.z=-3*b8.depth;b2.add(obj);b5=new THREE.MeshBasicMaterial({color:16777215,transparent:true});b5.map=new THREE.CanvasTexture(C);b5.map.anisotropy=32;bY=new THREE.PlaneGeometry(bS,2,1);obj=new THREE.Mesh(bY,b5);obj.name="speaker";obj.position.z=0.7+0.05;var bU=cb-b6-cc-1;obj.position.y=bU;b2.add(obj);var b0=bS-0.8;var bX=3*b0/4;b5=new THREE.MeshBasicMaterial({color:16777215});b5.map=new THREE.CanvasTexture(a5);b5.map.anisotropy=16;bY=new THREE.PlaneGeometry(b0,bX,1);obj=new THREE.Mesh(bY,b5);obj.name="face";obj.position.z=-b8.depth;var bU=cb-b6-cc/2;obj.position.y=bU;b2.add(obj);b5=new THREE.MeshBasicMaterial({color:16777215,transparent:true,opacity:0.4});b5.map=new THREE.CanvasTexture(bh);b5.map.anisotropy=16;bY=new THREE.PlaneGeometry(b0,bX,1);obj=new THREE.Mesh(bY,b5);obj.name="grid";obj.position.z=-b8.depth+0.02;obj.position.y=bU;b2.add(obj);var bV=aA;var ca=b0/bX;bV.scale(1,ca);var bZ=512;var bW=Math.floor(bZ/ca);bA.screenScale=ca;bA.screenWidth=bZ;bA.screenHeight=bW;a9.scale(1,ca);am();obj=bN(24695);obj.name="socket1";obj.rotation.x=al;obj.position.set(-0.7*b8.width/2,(b8.height-b8.scrHeight)/2,2*b8.depth+0.1);b2.add(obj);obj=bN(24695);obj.name="socket2";obj.rotation.x=al;obj.position.set(0.7*b8.width/2,(b8.height-b8.scrHeight)/2,2*b8.depth+0.1);b2.add(obj);aw.scale(1,bS/2);bI();return b2}function bI(){var bT=1/8.7;var bW=aw;bW.clearRect(0,0,512,512);bW.save();bW.translate(256,256*bT);var bS,bX;bW.fillStyle="#222222";for(var bV=-2;bV<=2;bV++){bX=bV*10;for(var bU=-5;bU<=5;bU++){bS=bU*10;bW.beginPath();bW.arc(bS,bX,2.5,0,bp);bW.fill()}}bW.restore()}function am(){var bT=bA.screenWidth;var bV=bA.screenHeight;var bX=bT/8;var bZ,bY;var bS=a9;bS.clearRect(0,0,512,512);bS.strokeStyle="#ffffff";for(var bW=-3;bW<=3;bW++){bS.beginPath();bZ=bT/2+bW*bX;bS.moveTo(bZ,0);bS.lineTo(bZ,bV);bS.lineWidth=4;bS.strokeStyle="rgba(255,255,255,.2)";bS.stroke()}var b0=bX*bA.yScale;var bU=Math.round(0.5*bV/b0);for(var bW=-bU;bW<=bU;bW++){bS.beginPath();bY=bV/2+bW*b0;bS.moveTo(0,bY);bS.lineTo(bT,bY);bS.lineWidth=(bW==0)?5:4;bS.strokeStyle=(bW==0)?"rgba(255,255,255,.6)":"rgba(255,255,255,.2)";bS.stroke()}}function aN(){var bS=H.magnet.getObjectByName("magneticField");bk(bS);ar(bS)}function a0(b8){F=new coilCurve(b8.rLoop,b8.rCorner,b8.turn,b8.gap,b8.fLength1,b8.fLength2,b8.wireRad,b8.coilGap);var b5=H.circuit.getObjectByName("coil");var b0=H.circuit.getObjectByName("wire");var bT=H.coil.getObjectByName("penampang1");var bS=H.coil.getObjectByName("penampang2");b5.remove(b0);b5.remove(bT);b5.remove(bS);b0.material.dispose();b0.geometry.dispose();b0=null;bT.material.dispose();bT.geometry.dispose();bT=null;bS.material.dispose();bS.geometry.dispose();bS=null;var bZ=b8.rLoop;var bY=b8.rCorner;var b7=b8.gap;var b1=b8.turn;var b4=b8.coilGap;var bX=b8.wireRad;var bV=b8.fLength1;var bU=b8.fLength2;var b6=new coilCurve(bZ,bY,b1,b7,bV,bU,bX,b4);var bW=new THREE.TubeBufferGeometry(b6,32*Math.round(b6.L),bX,8,false);var b2=new THREE.MeshPhongMaterial({color:14518272,transparent:false,opacity:0.7,shininess:50,specular:3355443});var b3=new THREE.Mesh(bW,b2);b3.name="wire";b5.add(b3);b3.userData={id:"GESERCOIL"};var bW=new THREE.CircleGeometry(bZ,32);var b2=new THREE.MeshBasicMaterial({color:16777215,transparent:true,side:THREE.FrontSide});b2.map=new THREE.CanvasTexture(aE);b2.map.anisotropy=16;var b3=new THREE.Mesh(bW,b2);b3.name="penampang1";b3.position.z=0.001;b5.add(b3);var bW=new THREE.CircleGeometry(bZ,32);var b2=new THREE.MeshBasicMaterial({color:16777215,transparent:true,side:THREE.BackSide});b2.map=new THREE.CanvasTexture(aG);b2.map.anisotropy=16;var b3=new THREE.Mesh(bW,b2);b3.name="penampang2";b3.position.z=-0.001;b5.add(b3);var b9=0.9;b3=H.circuit.getObjectByName("splitRing1");b3.position.y=bZ+bV-b9/2;b3=H.circuit.getObjectByName("splitRing2");b3.position.y=bZ+bU-b9/2;b3=H.circuit.getObjectByName("brush1");b3.position.y=bZ+bV-b9/2;b3=H.circuit.getObjectByName("brush2");b3.position.y=bZ+bU-b9/2;bk(H.electrons);a1();H.cables.remove(H.cable1);H.cables.remove(H.cable2);H.cables.remove(H.extension1);H.cables.remove(H.extension2);bk(H.cable1);bk(H.cable2);bk(H.extension1);bk(H.extension2);H.cable1=null;H.cable2=null;H.extension1=null;H.extension2=null;P(H.cables,new THREE.Vector3(0,0,-aS.coil));H.cable1=H.cables.getObjectByName("kabel1");H.cable2=H.cables.getObjectByName("kabel2");H.extension1=H.cable1.getObjectByName("extension");H.extension2=H.cable2.getObjectByName("extension");l(aS.coil);q(a4.B)}function bk(bS){var bT=bS.children;while(bT.length>0){if(bT[0].material){bT[0].material.dispose()}if(bT[0].geometry){bT[0].geometry.dispose()}bS.remove(bT[0])}}function au(cd){var bV=new THREE.Group();bV.name="circuit";var b4=cd.rLoop;var b3=cd.rCorner;var cc=cd.gap;var b5=cd.turn;var b8=cd.coilGap;var b0=cd.wireRad;var bX=cd.fLength1;var bW=cd.fLength2;var cb=new coilCurve(b4,b3,b5,cc,bX,bW,b0,b8);var ca=new THREE.Group();ca.name="coil";var bZ=new THREE.TubeBufferGeometry(cb,32*Math.round(cb.L),b0,8,false);var b6=new THREE.MeshPhongMaterial({color:14518272,transparent:false,opacity:0.7,shininess:50,specular:3355443});var b7=new THREE.Mesh(bZ,b6);b7.name="wire";ca.add(b7);b7.userData={id:"GESERCOIL"};var bZ=new THREE.CircleGeometry(b4,32);var b6=new THREE.MeshBasicMaterial({color:16777215,transparent:true,side:THREE.FrontSide});b6.map=new THREE.CanvasTexture(aE);b6.map.anisotropy=16;var b7=new THREE.Mesh(bZ,b6);b7.name="penampang1";b7.name="penampang1";b7.position.z=0.01;ca.add(b7);var bZ=new THREE.CircleGeometry(b4,32);var b6=new THREE.MeshBasicMaterial({color:16777215,transparent:true,side:THREE.BackSide});b6.map=new THREE.CanvasTexture(aG);b6.map.anisotropy=16;var b7=new THREE.Mesh(bZ,b6);b7.name="penampang2";b7.position.z=-0.001;ca.add(b7);var bU=b3+cc/2;var bT=bU+0.15-0.1;var ce=0.9;var bY=new THREE.Group();bY.name="splitRing";var cf={steps:1,depth:ce,bevelEnabled:true,bevelThickness:0.06,bevelSize:0.06};var b1=new THREE.Shape();var bS;b1.moveTo(bT,0);for(var b9=0;b9<360;b9+=3){bS=b9*t;b1.lineTo(bT*Math.cos(bS),bT*Math.sin(bS))}var b2=new THREE.Path();b2.moveTo(bU,0);for(var b9=360;b9>0;b9-=3){bS=b9*t;b2.lineTo(bU*Math.cos(bS),bU*Math.sin(bS))}b1.holes.push(b2);b6=new THREE.MeshPhongMaterial({color:14526976,transparent:false,shininess:50,specular:7829367});bZ=new THREE.ExtrudeGeometry(b1,cf);b7=new THREE.Mesh(bZ,b6);b7.name="splitRing1";b7.rotation.x=-al;b7.position.y=b4+bX-ce/2;bY.add(b7);b7.userData={id:"GESERCOIL"};b7=new THREE.Mesh(bZ,b6);b7.name="splitRing2";b7.rotation.x=-al;b7.position.y=b4+bW-ce/2;bY.add(b7);b7.userData={id:"GESERCOIL"};ca.add(bY);b7=new THREE.Group();b7.name="electrons";ca.add(b7);bV.add(ca);b7=an(bT,ce,{x:0,y:b4+bX,z:0},0);b7.name="brush1";bV.add(b7);b7=an(bT,ce,{x:0,y:b4+bW,z:0},Math.PI);b7.name="brush2";bV.add(b7);return bV}function O(bU){var bS=new THREE.Group();bS.name="connector";var bT=A(3,[11184810,2276215,2258875]);bT.name="socketBox1";bT.position.x=4;bS.add(bT);bT=A(3,[11184810,2276215,2258875]);bT.name="socketBox2";bT.position.x=-4;bS.add(bT);return bS}function an(b0,bV,b2,bT){var bZ=new THREE.Group();var bY=0.8*b0;var bS=1.5*bY;var bX=1*bV;var b5=new THREE.Shape();var b3=Math.asin(0.5*bY/b0);b5.moveTo(b0*Math.cos(b3)+bS,b0*Math.sin(-b3));var b4=3*t;for(sd=-b3;sd<b3;sd+=b4){b5.lineTo(b0*Math.cos(sd),b0*Math.sin(sd))}b5.lineTo(b0*Math.cos(b3),b0*Math.sin(b3));b5.lineTo(b0*Math.cos(b3)+bS,b0*Math.sin(b3));var bW=new THREE.MeshPhongMaterial({color:4473924,shininess:5,specular:2236962});var b1=new THREE.ExtrudeGeometry(b5,{steps:1,depth:bX,bevelEnabled:false});var bU=new THREE.Mesh(b1,bW);bU.rotation.x=-al;bZ.add(bU);bW=new THREE.MeshPhongMaterial({color:11184810,shininess:0,specular:1118481});b1=new THREE.TorusGeometry(0.28,0.12,12,12);bU=new THREE.Mesh(b1,bW);bU.name="socket";bU.rotation.y=al;bU.position.y=bX/2;bU.position.x=b0+bS-0.12;bZ.add(bU);bU.visible=false;bZ.rotation.y=bT;bZ.position.set(b2.x,b2.y-bX/2,b2.z);return bZ}function E(bU,bT){if(!bT){j.azimuthal=ae.getAzimuthalAngle();j.polar=ae.getPolarAngle()}ae.dispose();var bV=(bU==undefined)?false:bU;if(bV){var bS=k/ac;var bW=14;c.camera=new THREE.OrthographicCamera(-bW*bS,bW*bS,bW,-bW,1,1000);c.camera.lookAt(0,0,0);c.camera.updateMatrixWorld()}else{c.camera=new THREE.PerspectiveCamera(50,k/ac,1,1000);c.camera.lookAt(0,0,0);c.camera.updateMatrixWorld()}c.camera.position.set(j.r*Math.sin(j.polar)*Math.cos(al-j.azimuthal),j.r*Math.cos(j.polar),j.r*Math.sin(j.polar)*Math.sin(al-j.azimuthal));c.camera.lookAt(0,0,0);c.camera.updateProjectionMatrix();ae=new THREE.OrbitControls(c.camera,c.renderer.domElement,orbitHandler);ae.enablePan=false;ae.enableZoom=true;ae.dampingFactor=0.04;ae.enableDamping=true;ae.maxPolarAngle=120*t;ae.minAzimuthAngle=10*t;ae.maxAzimuthAngle=150*t;ae.enabled=true}function aQ(bT,bS){if(aM!=null){return aM.apply(this,[bT,bS])}else{return null}}};