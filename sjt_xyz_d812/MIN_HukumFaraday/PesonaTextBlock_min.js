var PesonaTextBlock=new function(){const c="\u2002";this.print=function(f,p,o,g,q,j,l,m,n,h,i,e){return a(f,p,o,g,q,j,l,m,true,n,h,i,e,true,false)};this.print2=function(f,p,o,g,q,j,l,m,n,h,i,e){return a(f,p,o,g,q,j,l,m,true,n,h,i,e,false,false)};this.print3=function(f,p,o,g,r,j,l,m,q,n,h,i,e){return a(f,p,o,g,r,j,l,m,q,n,h,i,e,false,false)};this.print4=function(f,p,o,g,q,j,l,m,n,h,i,e){return a(f,p,o,g,q,j,l,m,true,n,h,i,e,false,true)};function a(ay,aa,Z,ae,o,al,aj,s,T,f,O,v,am,I,ah){am=am||0;var W=new Array();const aw={NONE:0,EQUAL:1,POSITION:2,GOEQUAL:3};var ar=(f==undefined)?"serif":f;if(I){var K=AdaptiveFontSize.fix(o+"px "+ar);var B=AdaptiveFontSize.fix(0.7*o+"px "+ar)}else{var K=o+"px "+ar;var B=0.7*o+"px "+ar}var z=false;var r=false;var U=O;var Y=false;var H=aw.NONE;var h=false;var ad=false;ay.textBaseline=aj;var S,p,F;var D=new Array();var ab=new Array();var J=new Array();var N=aa;p=Z;var M=/~(.*?)~/gi;var ai,E,ax;var C=ae.split("|");var V=new Array();var X;var A,ap,ak;var Q;var R=new Array();for(var aq=0;aq<C.length;aq++){C[aq]=C[aq].replace(/\u203A/g,c.repeat(5));if(C[aq]=="^"){p+=0.6*o}else{Q=J.push({yStart:p,yEnd:0})-1;ai=0;if(ai<0){ay.font=K;ay.fillStyle=U;ay.strokeStyle=U;switch(al){case"left":case"justified":ay.textAlign="left";break;case"right":ay.textAlign="right";break;case"center":ay.textAlign="center";break}if(ah){d(C[aq],ay,aa,p,o,ab)}if(s){ay.strokeText(C[aq],aa,p)}else{if(T){ay.fillText(C[aq],aa,p)}}}else{ay.textAlign="left";A=0;V=new Array();while((E=M.exec(C[aq]))){ap=E.index;if(ap>=A){V.push({txt:C[aq].substr(A,ap-A),color:U,bold:r,italic:z,small:Y,up:h,aligned:H,extraSpace:0,tab:ad});ad=false;H=aw.NONE;ax=E[1];X=ax.split(" ");for(var ao=0;ao<X.length;ao++){switch(X[ao]){case"tab":ad=true;break;case"i":z=true;break;case"b":r=true;break;case"!i":z=false;break;case"!b":r=false;break;case"s":Y=true;break;case"!s":Y=false;break;case"u":h=true;break;case"!u":h=false;break;case"=":H=aw.EQUAL;break;case"@":H=aw.POSITION;break;case"==":H=aw.GOEQUAL;break;default:if(X[ao].substr(0,1)=="#"){if(X[ao].trim()=="#"){if(W.length>0){U=W.pop()}}else{W.push(U);U=X[ao]}}break}}A=E.index+E[0].length}}ap=C[aq].length;if(ap>A){V.push({txt:C[aq].substr(A,ap-A),color:U,bold:r,italic:z,small:Y,up:h,aligned:H,extraSpace:0,tab:ad});ad=false}var ac=0;var e;R.length=0;var av;var ac=0;var P=true;for(var an=0;an<V.length;an++){ax=(V[an].small||V[an].up)?B:K;if(V[an].italic){ax="italic "+ax}if(V[an].bold){ax="bold "+ax}ay.font=ax;var u="";var t=V[an].txt.split(" ");for(var ag=0;ag<t.length;ag++){if(ag==0){e=ay.measureText(t[ag]).width}else{e=ay.measureText(t[ag]+" ").width}if((ac+e)>v&&v>0){V[an].txt=u;if(P){av=R.push({width:0,seg:new Array()})-1}if(V[an].txt!=""){R[av].seg.push(V[an])}R[av].width=ac;u="";for(var at=ag;at<t.length;at++){if(at==ag){u=t[at]}else{u+=" "+t[at]}}var g=JSON.parse(JSON.stringify(V[an]));g.txt=u;V.splice(an+1,0,g);ac=0;P=true;break}else{ac+=e;if(ag==0){u+=t[ag]}else{u+=" "+t[ag]}}}if(R.length==0){av=R.push({width:0,seg:new Array()})-1;R[av].seg.push(V[an]);R[av].width=ac;P=false}else{if(P){av=R.push({width:0,seg:new Array()})-1;P=false}else{R[av].seg.push(V[an]);R[av].width=ac}}}ay.textAlign="left";var af;for(var ag=0;ag<R.length;ag++){switch(al){case"left":case"justified":S=aa;break;case"right":S=aa-R[ag].width;break;case"center":S=aa-R[ag].width/2;break}if(al=="justified"&&v>0&&ag<R.length-1){var m=v-R[ag].width;var L="";for(var an=0;an<R[ag].seg.length;an++){L+=R[ag].seg[an].txt}L=L.trim();var G=L.split(" ");m=m/(G.length-1);for(var an=0;an<R[ag].seg.length;an++){G=R[ag].seg[an].txt.split(" ");if(G.length>1){R[ag].seg[an].extraSpace=m}}}for(var an=0;an<R[ag].seg.length;an++){dy=1.25*o;bseg=R[ag].seg[an];if(bseg.txt=="^"){dy=0.5*o}else{if(bseg.tab){bseg.txt="----- "+bseg.txt}ax=(bseg.small||bseg.up)?B:K;F=0;if(bseg.small){F=0.2*o}if(bseg.up){F=-0.2*o}if(bseg.italic){ax="italic "+ax}if(bseg.bold){ax="bold "+ax}ay.font=ax;switch(bseg.aligned){case aw.EQUAL:N=S;break;case aw.POSITION:D.push({x:S,y:p+F});break;case aw.GOEQUAL:S=N;break}if(bseg.txt!=""){if(s){ay.strokeStyle=bseg.color;ay.strokeText(bseg.txt,S,p+F)}else{if(T){if(ah){d(bseg.txt,ay,S,p+F,o,ab,bseg.extraSpace)}ay.fillStyle=bseg.color;if(al=="justified"){var L=bseg.txt.split(" ");var t;for(var au=0;au<L.length;au++){if(L[au]!=""||au==0){t=L[au]+" ";ay.fillText(t,S,p+F);if(t!=" "){S+=ay.measureText(t).width+bseg.extraSpace}}}}else{ay.fillText(bseg.txt,S,p+F);S+=ay.measureText(bseg.txt).width}}}}}}p+=dy+am}}J[Q].yEnd=p}}return{x:N,y:p,xEnd:S,markPos:D,paragraphPos:J,wordPos:ab}}function d(y,j,q,A,F,o,e){var C=y.split(" ");var t=q;var u,h;var D,z,v,g;var l,m;var r,p;var E;for(var B=0;B<C.length;B++){D=true;z=0;v="";while(D){if(C[B].substr(z,1)==c){v+=c}else{D=false}z++}g=j.measureText(v).width;h=j.measureText(C[B]).width;l="";for(k=0;k<C[B].length;k++){E=C[B][k];if(b(E)){l+=E}else{if(E!=c){break}}}m="";for(k=C[B].length-1;k>=0;k--){E=C[B][k];if(b(E)){m+=E}else{break}}r=j.measureText(l).width;p=j.measureText(m).width;o.push({word:C[B].trim(),x:t+g,y:A,width:h-g,height:F,bersih:{x:t+g+r,y:A,width:h-g-r-p,height:F}});u=j.measureText(C[B]+" ").width;t+=u+e}}function b(e){return/[.,'?!“”"‘’]/.test(e)}};