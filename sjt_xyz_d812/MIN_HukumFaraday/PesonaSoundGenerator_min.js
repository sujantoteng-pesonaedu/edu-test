function PesonaSoundGenerator(q,h,p,d){var r;var n;var i;var o;var u=h&3;var l=p;var v=Math.min(1,Math.max(0,d));var m=["sine","square","triangle","sawtooth"];var b=false;var j=true;var e=false;s();this.activate=function(){c()};this.isAudioSupported=function(){return(r!=null)};this.setMute=function(x){j=x;if(j){t()}else{a()}};this.isMute=function(){return j};this.soundIsOn=function(){return e};function s(){if(!window.AudioContext){if(window.webkitAudioContext){window.AudioContext=window.webkitAudioContext}}r=new AudioContext();n=r.createStereoPanner();n.pan.setValueAtTime(0,r.currentTime);n.connect(r.destination);i=r.createGain();o=r.createOscillator();o.type=m[u];o.loop=true;if(i){i.gain.setValueAtTime(v,r.currentTime)}if(o){o.frequency.setValueAtTime(l,r.currentTime)}}var w=false;var g=false;function c(){if(r&&!w){r.resume();w=true;k()}}function f(){if(r&&!g){r.resume();g=true;k()}}function k(){var x=r.createBuffer(1,1,22050);var y=r.createBufferSource();y.buffer=x;y.connect(r.destination);y.start(0);y=null;x=null}this.setWaveForm=function(x){u=x&3;if(o){o.type=m[u]}};this.setFrequency=function(x){if(o){o.frequency.setTargetAtTime(x,r.currentTime,0.01)}l=x};this.getFrequency=function(){return l};this.setVolume=function(x){v=Math.abs(x);if(i){i.gain.setTargetAtTime(v,r.currentTime,0.01)}};this.getVolume=function(){return v};this.playSound=function(){if(!j){a()}};this.stopSound=function(){if(!j){t()}};this.pauseSound=function(){if(r&&w){r.suspend()}};this.continueSound=function(){if(r&&w){r.resume()}};function a(){if(r){if(!b){o.start();b=true}try{n.connect(r.destination);i.connect(n);o.connect(i);e=true}catch(x){}}}function t(){if(r){try{o.disconnect(i);i.disconnect(n);n.disconnect(r.destination);e=false}catch(x){}}}};