function Molecule3D(){var bs;var S;var af=new Array({name:"PE3D_min.js"},{name:"AdaptiveFontSize_min.js"});var an=af.length;var az;var al=new Array();var aI=al.length;var M=new Array(aI);var cb="en";var m;this.setLanguage=function(cl){cb=cl};var aY=false;this.resetStorage=function(cl){aY=cl};var bW=true;this.showLoading=function(cl){bW=cl};var bc=true;this.setGradasiBola=function(cl){bc=cl};var bs;var S;this.start=function(cn,cm){bs=cn;S=cm;switch(cb){case"id":m={title:"Geometri Molekul Berdasarkan Teori VSEPR",loadingLibrary:"Sebentar... sedang memuat library ",loadingImage:"Sebentar... sedang memuat gambar/audio ",domainPE:"Domain pasangan elektron (PE):",domainPEB:"Domain pasangan elektron bebas (PEB):",domainPEI:"Domain pasangan elektron terikat (PEI):",geomElektron:"Geometri domain elektron:",geomMolekul:"Geometri molekul:",tampilPEB:"Tampilkan PEB",linear:"Linear|(Linear)",trigonalPlanar:"Segitiga datar|(Trigonal-planar)",bent:"Sudut|(Bent)",tetrahedral:"Tetrahedral|(Tetrahedral)",trigonalPyramidal:"Piramida segitiga|(Trigonal-pyramidal)",bipyramidal:"Bipiramida|(Bipyramidal)",trigonalBipyramidal:"Bipiramida segitiga|(Trigonal-bipyramidal)",seesaw:"Jungkat-jangkit|(Seesaw)",tShaped:"Bentuk T|(T-shaped)",octahedral:"Oktahedral|(Octahedral)",squarePyramidal:"Piramida segiempat|(Square-pyramidal)",squarePlanar:"Segi empat datar|(Square-planar)"};break;case"en":default:m={title:"Molecular Geometry Based on VSEPR Theory",loadingLibrary:"A moment... loading library ",loadingImage:"A moment... loading image/audio ",domainPE:"Electron pair domain:",domainPEB:"Lone pair domain:",domainPEI:"Bonden pair domain:",geomElektron:"Electron domain geometry:",geomMolekul:"Molecular geometry:",linear:"Linear",trigonalPlanar:"Trigonal-planar",bent:"Bent",tetrahedral:"Tetrahedral",trigonalPyramidal:"Trigonal-pyramidal",bipyramidal:"Bipyramidal",trigonalBipyramidal:"Trigonal-bipyramidal",seesaw:"Seesaw",tShaped:"T-shaped",octahedral:"Octahedral",squarePyramidal:"Square-pyramidal",squarePlanar:"Square-planar"};break;case"zh":case"zh-cn":case"zh-sg":m={title:"VSEPR 分子的几何结构",loadingLibrary:"稍等... 函式库装载中 ",loadingImage:"稍等... 图桉档装载中 ",domainPE:"原子总电子对数目:",domainPEB:"未键结电子对数目:",domainPEI:"键结电子对数目:",geomElektron:"电子排列:",geomMolekul:"分子几何结构:",linear:"直线型|(Linear)",trigonalPlanar:"平面三角型|(Trigonal-planar)",bent:"角型|(Bent)",tetrahedral:"四面体|(Tetrahedral)",trigonalPyramidal:"三角锥|(Trigonal-pyramidal)",bipyramidal:"双角锥|(Bipyramidal)",trigonalBipyramidal:"双三角锥|(Trigonal-bipyramidal)",seesaw:"跷跷板形|(Seesaw)",tShaped:"T 字型|(T-shaped)",octahedral:"八面体|(Octahedral)",squarePyramidal:"四角锥|(Square-pyramidal)",squarePlanar:"平面四方型|(Square-planar)"};break;case"zh-tw":case"zh-hk":m={title:"VSEPR 分子的幾何結構",loadingLibrary:"稍等... 函式庫裝載中 ",loadingImage:"稍等... 圖案檔裝載中 ",domainPE:"原子總電子對數目:",domainPEB:"未鍵結電子對數目:",domainPEI:"鍵結電子對數目:",geomElektron:"電子排列:",geomMolekul:"分子幾何結構:",linear:"直線型|(Linear)",trigonalPlanar:"平面三角型|(Trigonal-planar)",bent:"角型|(Bent)",tetrahedral:"四面體|(Tetrahedral)",trigonalPyramidal:"三角錐",bipyramidal:"雙角錐|(Bipyramidal)",trigonalBipyramidal:"雙三角錐|(Trigonal-bipyramidal)",seesaw:"蹺蹺板形|(Seesaw)",tShaped:"T 字型|(T-shaped)",octahedral:"八面體|(Octahedral)",squarePyramidal:"四角錐",squarePlanar:"平面四方型"};break}if(bW){bZ()}if(af.length==0){bi()}else{for(var cl=0;cl<af.length;cl++){ci(m.loadingLibrary+(cl+1)+"/"+af.length);bN(af[cl].name)}}};function bN(cl){var cn=document.createElement("script");cn.type="text/javascript";cn.src=cl;cn.onreadystatechange=P;cn.onload=P;var cm=document.getElementsByTagName("head").item(0);cm.appendChild(cn)}function P(){an--;if(an==0){bi()}}var av;var a1;function bZ(){var cl=document.createElement("style");cl.type="text/css";cl.innerHTML=".modalDialog { position: fixed; font-family: Arial, Helvetica, sans-serif; top: 0; right: 0; bottom: 0; left: 0; z-index: 99999; opacity:1; -webkit-transition: opacity 400ms ease-in; -moz-transition: opacity 400ms ease-in; transition: opacity 400ms ease-in;} .modalDialog > div { display: table; color:#000000;  width: 60vmin; height: 12vmin; position: absolute; top:0;  bottom:0; left:0; right:0; margin:auto; padding: 0px 2vmin 0px 2vmin; border-radius: 2vmin; border:2px solid #303030; background: #ffffff; text-align:center; box-shadow: 0.3vmin 0.3vmin 0.3vmin rgba(0,0,0,0.5);}";document.body.appendChild(cl);av=document.createElement("div");av.id="openModal";av.className="modalDialog";var cm=document.createElement("div");av.appendChild(cm);a1=document.createElement("p");a1.style.fontSize="2.5vmin";a1.style.display="table-cell";a1.style.verticalAlign="middle";a1.textContent="?";cm.appendChild(a1);document.body.appendChild(av)}function ci(cl){if(typeof a1=="object"){a1.textContent=cl}}function R(){if(av){document.body.removeChild(av)}}var bU="AE_????????????????";const aG=Math.PI/2;const V=3*Math.PI/2;const bn=900;const aH=768;var b0;var a5;var a7=1;var bO=1;var w,r;var by;var cj,bf;var s,ca;var be,bv;var bQ=340;var aw=340;var T=340;var C=340;var aa=142;var a6=true;function bi(){container=document.getElementById(bs);w=document.createElement("canvas");w.unselectable="on";w.style.zIndex="0";container.appendChild(w);r=w.getContext("2d");w.style.backgroundColor="#000000";s=document.createElement("canvas");s.unselectable="on";s.style.pointerEvents="none";s.style.zIndex="1";container.appendChild(s);ca=s.getContext("2d");be=document.createElement("canvas");be.unselectable="on";be.style.pointerEvents="none";be.style.zIndex="2";container.appendChild(be);bv=be.getContext("2d");by=document.createElement("canvas");by.unselectable="on";by.style.pointerEvents="none";by.width=bQ;by.height=aw;buffContext=by.getContext("2d");cj=document.createElement("canvas");cj.unselectable="on";cj.style.pointerEvents="none";cj.width=T;cj.height=C;bf=cj.getContext("2d");canvasList=[{canvas:w,x:0,y:0,width:bn,height:aH},{canvas:s,x:0,y:aH-aa,width:bn,height:aa},{canvas:be,x:0,y:aH-aa,width:bn,height:aa}];E(canvasList);if(aI==0){aW()}else{az=aI;for(var cl=0;cl<aI;cl++){ci(m.loadingImage+(cl+1)+"/"+aI);switch(al[cl].type){case"image":M[al[cl].index]=new Image();M[al[cl].index].addEventListener("load",aC,false);M[al[cl].index].src="images/"+al[cl].name;break;case"audio":M[al[cl].index]=new Audio();M[al[cl].index].addEventListener("loadeddata",aC,false);M[al[cl].index].src="audios/"+al[cl].name;M[al[cl].index].type="audio/mpeg";break}}}}function aC(){az--;if(az==0){aW()}}var cg=0;var N=0;var aA=0;var k=false;var b7=false;var aD=2;var Z=0;var f=bn/2;var c=aH/2+20;const B=Math.PI/180;function aW(){R();a6=false;try{var cl=r.globalCompositeOperation;r.globalCompositeOperation="screen";a6=(r.globalCompositeOperation=="screen");r.globalCompositeOperation=cl}catch(cm){}window.addEventListener("resize",bT,false);container.addEventListener("touchstart",H,false);w.addEventListener("mousedown",aU,true);w.addEventListener("touchstart",bK,true);aF();t();b6();ak(aD,Z);ai();e();bl();k=true;bx()}function bo(cl){}function H(cm){if(!cm){var cm=window.event}var co=cm.targetTouches[0];var cl=(co.pageX-b0.x)/a7;var cn=(co.pageY-b0.y)/bO;if(cl>=0&&cl<bn&&cn>=0&&cn<aH){cm.preventDefault();cm.stopPropagation()}}function b1(cl,cn){try{if(typeof(Storage)!=="undefined"){localStorage.setItem(cl,cn)}}catch(cm){}}window.requestAnimFrame=(function(cl){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(cm){window.setTimeout(cm,1000/60)}})();window.cancelRequestAnimFrame=(function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout})();var ah=0;var g;function bx(){if(k){aV()}if(!b7&&!(b5||bI)&&(cg!=0||N!=0||aA!=0)){sxRot=cg;syRot=N;szRot=aA;cg=0;N=0;aA=0;var cn=Math.max(sxRot,syRot,szRot);var co=Math.abs(Math.min(sxRot,syRot,szRot));tMax=Math.min(1500,1000*(co>cn?co:cn));ah=new Date().getTime();b7=true}if(b7){var cl=new Date().getTime()-ah;if(cl>tMax){cg=0;N=0;aA=0;b7=false}else{var cm=Math.sin(aG*cl/tMax);cg=sxRot-cm*sxRot;N=syRot-cm*syRot;aA=szRot-cm*szRot;aV()}}cg=ab(cg);N=ab(N);aA=ab(aA);g=requestAnimFrame(bx)}function ab(cl){cl=cl/2;if(Math.abs(cl)<0.0001){cl=0}return cl}function ai(){var cl=r;var cm=40;cl.beginPath();cl.rect(0,0,bn,cm);cl.fillStyle="#404040";cl.fill();cl.font=AdaptiveFontSize.fix("18pt serif");cl.textBaseline="middle";cl.textAlign="center";cl.fillStyle="#ffffff";cl.fillText(m.title,bn/2,cm/2)}var b3;var aL;function e(){var cl=r;var cm=bn/2;var cu=65;var cs=35;var cp=35;cl.clearRect(0,cu-4,bn,cp*3+20);b3=new Array();aL=new Array();var cn=aD-2;var ct;var cr,cq;cq=cu;cl.font=AdaptiveFontSize.fix("16pt serif");cl.textBaseline="middle";cl.textAlign="center";for(var co=0;co<5;co++){cr=cm+cs*co;cl.beginPath();if(co==cn){cl.rect(cr,cq,cs-1,cp);cl.moveTo(cr,cq);cl.lineTo(cr+cs-1,cq);cl.lineTo(cr+cs-1,cq+cp);cl.lineTo(cr+cs/2,cq+cp+8);cl.lineTo(cr,cq+cp);cl.closePath();cl.fillStyle="#ffb000"}else{cl.rect(cr,cq,cs-1,cp);cl.fillStyle="#606060"}cl.fill();cl.fillStyle=(co==cn)?"#000000":"#909090";cl.fillText(co+2,cr+cs/2,cq+cp/2);b3.push({x1:cr,y1:cq,x2:cr+cs,y2:cq+cp,peb:aq[co].length})}cq=cu+cp+13;var cv=(cn+0.5)*cs-cs*aq[cn].length/2;for(var co=0;co<aq[cn].length;co++){ct=aq[cn][co].PEB;cr=cm+cs*co+cv;if(ct==(Z)){cl.beginPath();cl.rect(cr,cq,cs-1,cp+1);cl.fillStyle="#5080a0";cl.fill();cl.beginPath();cl.rect(cr,cq+cp,cs-1,cp);cl.fillStyle="#c0c0c0";cl.fill()}else{cl.beginPath();cl.rect(cr,cq,cs-1,2*cp);cl.fillStyle="#606060";cl.fill()}cl.fillStyle=(ct==(Z))?"#000000":"#909090";cl.fillText(ct,cr+cs/2,cq+cp/2);cl.fillText(aD-ct,cr+cs/2,cq+cp+cp/2);aL.push({x1:cr,y1:cq,x2:cr+cs,y2:cq+2*cp,peb:ct})}var cq=cu+cp/2;cl.font=AdaptiveFontSize.fix("16pt serif");cl.textBaseline="middle";cl.textAlign="right";cl.fillStyle="#909090";cl.fillText(m.domainPE,cm-20,cq);cq=cu+cp/2+cp+13;cl.fillText(m.domainPEB,cm-20+cv,cq);cq+=cp;cl.fillText(m.domainPEI,cm-20+cv,cq)}var ac=new Array();function bD(cn,cl,cp,co,cm){cn.clearRect(cl-12,cp-12,24,24);if(co){cn.lineWidth=2;cn.strokeStyle="#ffffff";cn.beginPath();cn.moveTo(cl-10+4,cp-1);cn.lineTo(cl-10+8,cp+5);cn.lineTo(cl-10+16,cp-6);cn.stroke()}cn.beginPath();cn.rect(cl-10,cp-10,20,20);cn.fillStyle="rgba(255,200,0,0.8)";if(co){cn.fill()}cn.lineWidth=1.5;cn.strokeStyle="#ffffff";cn.stroke();ac[cm]={x1:cl-10,y1:cp-10,x2:cl+10,y2:cp+10,value:co}}function bl(){var cn=ca;var cp=20;var cl;cn.clearRect(0,0,bn,aa);cn.textBaseline="middle";cn.textAlign="left";y=cp;cn.font=AdaptiveFontSize.fix("16pt serif");cl=cn.measureText(m.geomElektron).width;cn.fillStyle="#909090";xs=bn/4-cl/2;x=xs;cn.fillText(m.geomElektron,x,y);x-=20;bD(cn,x,y,o,0);if(o){cn.textBaseline="alphabetic";cn.textAlign="left";var cr=bP.split("|");x+=75;y+=38;cn.font=AdaptiveFontSize.fix("16pt serif");cn.fillStyle="#0088ff";cn.fillText(cr[0],x,y);if(cr.length>1){y+=22;cn.font=AdaptiveFontSize.fix("14pt serif");cn.fillStyle="#0066aa";cn.fillText(cr[1],x,y)}geomelectPosY=y+60}cf=xs;cd=cp+56;cn.textBaseline="middle";cn.textAlign="left";y=cp;cn.font=AdaptiveFontSize.fix("16pt serif");cl=cn.measureText(m.geomMolekul).width;cn.fillStyle="#909090";xs=2.5*bn/4-cl/2;x=xs;cn.fillText(m.geomMolekul,x,y);x-=20;bD(cn,x,y,n,1);if(n){cn.textBaseline="alphabetic";cn.textAlign="left";var cr=bL.split("|");x+=75;y+=38;cn.font=AdaptiveFontSize.fix("16pt serif");cn.fillStyle="#0088ff";cn.fillText(cr[0],x,y);if(cr.length>1){y+=22;cn.font=AdaptiveFontSize.fix("14pt serif");cn.fillStyle="#0066aa";cn.fillText(cr[1],x,y)}}geomMolPosX=xs;bm=cp+56;xs=bn-130;x=xs;y=cp;bD(cn,x,y,b8,2);x+=33;y+=13;cn.beginPath();cn.moveTo(x-4,y);cn.bezierCurveTo(x-25,y-34,x+25,y-34,x+4,y);cn.closePath();cn.fillStyle="#202020";cn.fill();cn.beginPath();cn.moveTo(x-4,y);cn.bezierCurveTo(x-25,y-34,x+25,y-34,x+4,y);cn.lineWidth=1.5;cn.strokeStyle="#b0b0b0";cn.stroke();cn.beginPath();cn.arc(x-3,y-17,2,0,2*Math.PI,false);cn.arc(x+3,y-17,2,0,2*Math.PI,false);cn.fillStyle="#909090";cn.fill();xs=bn-130;x=xs;y=cp+40;bD(cn,x,y,aO,3);var co=25*B;x+=22;cn.beginPath();cn.moveTo(x,y);cn.arc(x,y,20,-co,co,false);cn.fillStyle="#202020";cn.fill();cn.beginPath();cn.arc(x,y,20,-co,co,false);cn.lineWidth=1;cn.strokeStyle="#b0b0b0";cn.stroke();var cm=Math.sin(co);var cq=Math.cos(co);cn.beginPath();cn.moveTo(x,y);cn.lineTo(x+28*cq,y-28*cm);cn.moveTo(x,y);cn.lineTo(x+28*cq,y+28*cm);cn.lineWidth=1.5;cn.strokeStyle="#b0b0b0";cn.stroke();if(a6){xs=bn-130;x=xs;y=cp+80;bD(cn,x,y,ap,4);x+=20;bp(cn,x,y-5,12,10,3);cn.fillStyle="#bb0000";cn.fill();bp(cn,x+17,y-5,12,10,3);cn.fillStyle="#005588";cn.fill()}}function bp(co,cn,cq,cp,cm,cl){co.beginPath();co.moveTo(cn+cl,cq);co.lineTo(cn+cp-cl,cq);co.arcTo(cn+cp,cq,cn+cp,cq+cl,cl);co.lineTo(cn+cp,cq+cm-cl);co.arcTo(cn+cp,cq+cm,cn+cp-cl,cq+cm,cl);co.lineTo(cn+cl,cq+cm);co.arcTo(cn,cq+cm,cn,cq+cm-cl,cl);co.lineTo(cn,cq+cl);co.arcTo(cn,cq,cn+cl,cq,cl);co.closePath()}var o=true;var n=true;var b8=true;var aO=false;var ap=false;var cf,bb,cd,bm;function aV(){ba.CalcRotateMatrix(cg,N,aA,O);converter3D_BC1.CalcRotateMatrix(cg,N,aA,O);aS.CalcRotateMatrix(cg,N,aA,O);if(ap){bB(converter3D_BC1,r,f,c,1);bB(aS,buffContext,bQ/2,aw/2,2);r.globalCompositeOperation="screen";r.drawImage(by,0,0,bQ,aw,f-bQ/2,c-aw/2,bQ,aw);r.globalCompositeOperation="source-over"}else{bB(ba,r,f,c,0)}bX(ba,bv,cf,cd);I(ba,bv,geomMolPosX,bm);k=false}function ax(){ai();e();bl();k=true}function bM(cn,cl,cq,co,cm){cn.beginPath();cn.arc(cl,cq,Math.round(co),0,2*Math.PI,false);if(bc){var cp=cn.createRadialGradient(Math.round(cl-0.45*co),Math.round(cq-0.45*co),Math.round(0.2*co),Math.round(cl-0.2*co),Math.round(cq-0.2*co),Math.round(co));cp.addColorStop(0,"rgb("+cm.r+","+cm.g+","+cm.b+")");cp.addColorStop(0.9,"rgb("+Math.round(0.5*cm.r)+","+Math.round(0.5*cm.g)+","+Math.round(0.5*cm.b)+")");cp.addColorStop(1,"rgb("+Math.round(0.45*cm.r)+","+Math.round(0.45*cm.g)+","+Math.round(0.45*cm.b)+")");cn.fillStyle=cp}else{cn.fillStyle="rgb("+cm.r+","+cm.g+","+cm.b+")"}cn.fill()}function bE(cn,cl,cp,co,cm){cn.beginPath();cn.arc(cl,cp,co,0,2*Math.PI,false);cn.fillStyle=cm;cn.fill()}var ba,aS;var O=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];function aF(){ba=new PesonaEdu3D(30,70,190,120);converter3D_BC1=new PesonaEdu3D(30-2,70,190,120);aS=new PesonaEdu3D(30+2,70,190,120)}var J;var X=40;var bR=140;var bu=0.4*bR;var bt=bR-bu;var at=16;var bj=16;var aM=48;var aE=40;var A=0.57*bR;var cc=60*B;var br=Math.PI/2;var b9=109.5*B;var bG=120*B;var aj=Math.PI;var D=240*Math.PI;var i;var aq;var bq;var Q;var Y,F;var bC,ch;var b4,u;var bA,bY;var b2,b;var aJ;var aQ,j;var aX,L;var a0,v;var bJ;var ad,bF;const aZ={PUSAT:0,TERIKAT:1,BEBAS:2,BINGKAI:3,STICK:4,APIT:5};var U={r:255,g:0,b:100};var a3={r:255,g:255,b:255};var ar={r:50,g:150,b:200};var K={r:255,g:200,b:0};var au={r:255,g:255,b:255};var aK;var G;var a8;var ce;var a9;var bk=40;var bg;function t(){bg=new Array();var cl=bk;bg[0]={sides:[]};bg[1]={sides:[[1,2,3],[3,2,1]]};bg[2]={sides:[[1,2,3],[1,3,4],[1,4,2],[2,4,3]]};bg[3]={sides:[[1,2,3],[1,3,4],[1,4,2],[2,5,3],[3,5,4],[2,4,5]]};bg[4]={sides:[[1,2,3],[1,3,4],[1,4,5],[1,5,2],[2,6,3],[3,6,4],[4,6,5],[2,5,6]]}}function b6(){aq=new Array();aq[0]=new Array();aq[0][0]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:bR,z:0},type:aZ.TERIKAT},{pos:{x:0,y:-bR,z:0},type:aZ.TERIKAT}],PEB:0,geomElektron:m.linear,geomMolekul:m.linear,geom:0,apit:[{p1:1,p2:2,label:"180°"},{p1:1,p2:2,label:"180°"}]};aq[1]=new Array();aq[1][0]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.TERIKAT},{pos:aB(bR,120,90),type:aZ.TERIKAT},{pos:aB(bR,120,270),type:aZ.TERIKAT}],PEB:0,geomElektron:m.trigonalPlanar,geomMolekul:m.trigonalPlanar,geom:1,apit:[{p1:1,p2:2,label:"120°"},{p1:2,p2:3,label:"120°"},{p1:3,p2:1,label:"120°"}]};aq[1][1]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.BEBAS},{pos:aB(bR,130,90),type:aZ.TERIKAT},{pos:aB(bR,130,270),type:aZ.TERIKAT}],PEB:1,geomElektron:m.trigonalPlanar,geomMolekul:m.bent,geom:1,apit:[{p1:2,p2:3,label:"< 120°"}]};aq[2]=new Array();aq[2][0]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.TERIKAT},{pos:aB(bR,109.5,60),type:aZ.TERIKAT},{pos:aB(bR,-109.5,0),type:aZ.TERIKAT},{pos:aB(bR,109.5,-60),type:aZ.TERIKAT}],PEB:0,geomElektron:m.tetrahedral,geomMolekul:m.tetrahedral,geom:2,apit:[{p1:1,p2:2,label:"109.5°"},{p1:1,p2:3,label:"109.5°"},{p1:1,p2:4,label:"109.5°"},{p1:2,p2:3,label:"109.5°"},{p1:3,p2:4,label:"109.5°"},{p1:4,p2:2,label:"109.5°"}]};aq[2][1]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.BEBAS},{pos:aB(bR,115,60),type:aZ.TERIKAT},{pos:aB(bR,-115,0),type:aZ.TERIKAT},{pos:aB(bR,115,-60),type:aZ.TERIKAT}],PEB:1,geomElektron:m.tetrahedral,geomMolekul:m.trigonalPyramidal,geom:2,apit:[{p1:2,p2:3,label:"< 109.5°"},{p1:3,p2:4,label:"< 109.5°"},{p1:4,p2:2,label:"< 109.5°"}]};aq[2][2]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.BEBAS},{pos:aB(bR,112,55),type:aZ.TERIKAT},{pos:aB(bR,-120,0),type:aZ.BEBAS},{pos:aB(bR,112,-55),type:aZ.TERIKAT}],PEB:2,geomElektron:m.tetrahedral,geomMolekul:m.bent,geom:2,apit:[{p1:4,p2:2,label:"< 109.5°"}]};aq[3]=new Array();aq[3][0]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.TERIKAT},{pos:aB(bR,90,60),type:aZ.TERIKAT},{pos:aB(bR,-90,0),type:aZ.TERIKAT},{pos:aB(bR,90,-60),type:aZ.TERIKAT},{pos:{x:0,y:0,z:-bR},type:aZ.TERIKAT}],PEB:0,geomElektron:m.trigonalBipyramidal,geomMolekul:m.trigonalBipyramidal,geom:3,apit:[{p1:1,p2:2,label:"90°"},{p1:1,p2:3,label:"90°"},{p1:1,p2:4,label:"90°"},{p1:5,p2:2,label:"90°"},{p1:5,p2:3,label:"90°"},{p1:5,p2:4,label:"90°"},{p1:2,p2:3,label:"120°"},{p1:3,p2:4,label:"120°"},{p1:4,p2:2,label:"120°"}]};aq[3][1]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:aB(bR,-3,60),type:aZ.TERIKAT},{pos:aB(bR,90,60),type:aZ.BEBAS},{pos:aB(bR,-90,3),type:aZ.TERIKAT},{pos:aB(bR,90,-63),type:aZ.TERIKAT},{pos:aB(bR,183,60),type:aZ.TERIKAT}],PEB:1,geomElektron:m.trigonalBipyramidal,geomMolekul:m.seesaw,geom:3,apit:[{p1:1,p2:3,label:"< 90°"},{p1:1,p2:4,label:"< 90°"},{p1:5,p2:3,label:"< 90°"},{p1:5,p2:4,label:"< 90°"},{p1:4,p2:3,label:"< 120°"}]};aq[3][2]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:aB(bR,-6,0),type:aZ.TERIKAT},{pos:aB(bR,90,65),type:aZ.BEBAS},{pos:aB(bR,-90,0),type:aZ.TERIKAT},{pos:aB(bR,90,-65),type:aZ.BEBAS},{pos:aB(bR,186,0),type:aZ.TERIKAT}],PEB:2,geomElektron:m.trigonalBipyramidal,geomMolekul:m.tShaped,geom:3,apit:[{p1:1,p2:3,label:"< 90°"},{p1:5,p2:3,label:"< 90°"}]};aq[3][3]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.TERIKAT},{pos:aB(bR,90,60),type:aZ.BEBAS},{pos:aB(bR,-90,0),type:aZ.BEBAS},{pos:aB(bR,90,-60),type:aZ.BEBAS},{pos:{x:0,y:0,z:-bR},type:aZ.TERIKAT}],PEB:3,geomElektron:m.trigonalBipyramidal,geomMolekul:m.linear,geom:3,apit:[{p1:1,p2:5,label:"180°"},{p1:1,p2:5,label:"180°"},{p1:1,p2:5,label:"180°"}]};aq[4]=new Array();aq[4][0]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.TERIKAT},{pos:aB(bR,90,0),type:aZ.TERIKAT},{pos:aB(bR,90,90),type:aZ.TERIKAT},{pos:aB(bR,90,180),type:aZ.TERIKAT},{pos:aB(bR,90,270),type:aZ.TERIKAT},{pos:{x:0,y:0,z:-bR},type:aZ.TERIKAT}],PEB:0,geomElektron:m.octahedral,geomMolekul:m.octahedral,geom:4,apit:[{p1:1,p2:2,label:"90°"},{p1:1,p2:3,label:"90°"},{p1:1,p2:4,label:"90°"},{p1:1,p2:5,label:"90°"},{p1:6,p2:2,label:"90°"},{p1:6,p2:3,label:"90°"},{p1:6,p2:4,label:"90°"},{p1:6,p2:5,label:"90°"},{p1:2,p2:3,label:"90°"},{p1:3,p2:4,label:"90°"},{p1:4,p2:5,label:"90°"},{p1:5,p2:2,label:"90°"}]};aq[4][1]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.BEBAS},{pos:aB(bR,105,0),type:aZ.TERIKAT},{pos:aB(bR,105,90),type:aZ.TERIKAT},{pos:aB(bR,105,180),type:aZ.TERIKAT},{pos:aB(bR,105,270),type:aZ.TERIKAT},{pos:{x:0,y:0,z:-bR},type:aZ.TERIKAT}],PEB:1,geomElektron:m.octahedral,geomMolekul:m.squarePyramidal,geom:4,apit:[{p1:6,p2:2,label:"< 90°"},{p1:6,p2:3,label:"< 90°"},{p1:6,p2:4,label:"< 90°"},{p1:6,p2:5,label:"< 90°"},{p1:2,p2:3,label:"< 90°"},{p1:3,p2:4,label:"< 90°"},{p1:4,p2:5,label:"< 90°"},{p1:5,p2:2,label:"< 90°"}]};aq[4][2]={atom:[{pos:{x:0,y:0,z:0},type:aZ.PUSAT},{pos:{x:0,y:0,z:bR},type:aZ.BEBAS},{pos:aB(bR,90,0),type:aZ.TERIKAT},{pos:aB(bR,90,90),type:aZ.TERIKAT},{pos:aB(bR,90,180),type:aZ.TERIKAT},{pos:aB(bR,90,270),type:aZ.TERIKAT},{pos:{x:0,y:0,z:-bR},type:aZ.BEBAS}],PEB:2,geomElektron:m.octahedral,geomMolekul:m.squarePlanar,geom:4,apit:[{p1:2,p2:3,label:"90°"},{p1:3,p2:4,label:"90°"},{p1:4,p2:5,label:"90°"},{p1:5,p2:2,label:"90°"}]};aK=new Array();G=new Array();a8=new Array();ce=new Array();a9=new Array();var cn={r:1,g:1,b:1};var cm={r:1,g:0,b:0};var cl={r:0,g:1,b:1};aK[0]=ay(U,cn);aK[1]=ay(U,cm);aK[2]=ay(U,cl);G[0]=ay(a3,cn);G[1]=ay(a3,cm);G[2]=ay(a3,cl);a8[0]=ay(ar,cn);a8[1]=ay(ar,cm);a8[2]=ay(ar,cl);ce[0]=ay(K,cn);ce[1]=ay(K,cm);ce[2]=ay(K,cl);a9[0]=ay(au,cn);a9[1]=ay(au,cm);a9[2]=ay(au,cl)}function ay(cl,cm){return{r:Math.round(cl.r*cm.r),g:Math.round(cl.g*cm.g),b:Math.round(cl.b*cm.b)}}function aP(cr,cq){var cw,cu,cs,cp;cw=cr.x;cu=cr.y;cs=cr.z;cp=Math.sqrt(cw*cw+cu*cu+cs*cs);var cm=cw/cp;var cv=cu/cp;var co=cs/cp;cw=cq.x;cu=cq.y;cs=cq.z;cp=Math.sqrt(cw*cw+cu*cu+cs*cs);var cl=cw/cp;var ct=cu/cp;var cn=cs/cp;return Math.acos(cm*cl+cv*ct+co*cn)}var ag;var bP,bL;function ak(cy,cl){var cJ,cO,cB,cz;var cN=cy-2;var cR=Math.min(cl,aq[cN].length);var ct=aq[cN][cR];bq=new Array();for(var cP=0;cP<ct.atom.length;cP++){Ma=ct.atom[cP];bq.push({pos:{x:Ma.pos.x,y:Ma.pos.y,z:Ma.pos.z},type:Ma.type})}if(ct.geom!=null){ag=ct.geom}else{ag=-1}bP=ct.geomElektron;bL=ct.geomMolekul;Y=new Array();F=new Array();bC=new Array();b4=new Array();ch=new Array();u=new Array();aJ=new Array();bA=new Array();b2=new Array();bY=new Array();b=new Array();stickAR=new Array();for(var cP=0;cP<bq.length;cP++){Y.push(bq[cP].pos);F.push({x:0,y:0,z:0});bC.push({x:0,y:0,z:0});b4.push({x:0,y:0,z:0});bA.push({x:0,y:0,z:0});b2.push({x:0,y:0,z:0});aJ.push({x:0,y:0,z:0});ch.push({x:0,y:0,z:0});u.push({x:0,y:0,z:0});bY.push({x:0,y:0,z:0});b.push({x:0,y:0,z:0});stickAR.push({x:0,y:0,z:0});switch(bq[cP].type){case aZ.TERIKAT:cO=ba.distanceBetween(bq[0].pos,bq[cP].pos);cJ=aM-Math.sqrt(aM*aM-at*at);cB=aM-cJ;cJ=aE-Math.sqrt(aE*aE-at*at);cz=cO-aE+cJ;bC[cP]=h(bq[0].pos,bq[cP].pos,cB);b4[cP]=h(bq[0].pos,bq[cP].pos,cB+(cz-cB)/2);bA[cP]=h(bq[0].pos,bq[cP].pos,cB+(cz-cB)/2);b2[cP]=h(bq[0].pos,bq[cP].pos,cz);aJ[cP]=h(bq[0].pos,bq[cP].pos,A);break;case aZ.BEBAS:cO=ba.distanceBetween(bq[0].pos,bq[cP].pos)-20;cJ=aM-Math.sqrt(aM*aM-bj*bj);cB=aM-cJ;bC[cP]=h(bq[0].pos,bq[cP].pos,cB);b4[cP]=h(bq[0].pos,bq[cP].pos,bR+aE-20);var cM={x:(bq[0].pos.x+bq[cP].pos.x)/2+10,y:(bq[0].pos.y+bq[cP].pos.y)/2+10,z:(bq[0].pos.z+bq[cP].pos.z)/2+10};var cs,cq,co,cQ;var cJ;cs=bq[0].pos.x-bq[cP].pos.x;cq=bq[0].pos.y-bq[cP].pos.y;co=bq[0].pos.z-bq[cP].pos.z;cQ=Math.sqrt(cs*cs+cq*cq+co*co);var cF={x:-cs/cQ,y:-cq/cQ,z:-co/cQ};cs=bq[0].pos.x-cM.x;cq=bq[0].pos.y-cM.y;co=bq[0].pos.z-cM.z;cQ=Math.sqrt(cs*cs+cq*cq+co*co);var cH={x:-cs/cQ,y:-cq/cQ,z:-co/cQ};cs=bq[0].pos.x-bq[cP].pos.x;cq=bq[0].pos.y-bq[cP].pos.y;co=bq[0].pos.z-bq[cP].pos.z;cQ=Math.sqrt(cs*cs+cq*cq+co*co);var cG={x:cs/cQ,y:cq/cQ,z:co/cQ};var cE={x:cH.y*cG.z-cH.z*cG.y,y:cH.z*cG.x-cH.x*cG.z,z:cH.x*cG.y-cH.y*cG.x};cQ=Math.sqrt(cE.x*cE.x+cE.y*cE.y+cE.z*cE.z);cE.x/=cQ;cE.y/=cQ;cE.z/=cQ;var cD={x:cE.y*cG.z-cE.z*cG.y,y:cE.z*cG.x-cE.x*cG.z,z:cE.x*cG.y-cE.y*cG.x};cQ=Math.sqrt(cD.x*cD.x+cD.y*cD.y+cD.z*cD.z);cD.x/=cQ;cD.y/=cQ;cD.z/=cQ;cJ=cO+aE/5;var cA={x:0,y:0,z:0};cA.x=bq[0].pos.x+cF.x*cJ;cA.y=bq[0].pos.y+cF.y*cJ;cA.z=bq[0].pos.z+cF.z*cJ;var cL=[{x:0,y:0,z:0},{x:0,y:0,z:0}];bA[cP].x=cA.x+cD.x*0.3*aE;bA[cP].y=cA.y+cD.y*0.3*aE;bA[cP].z=cA.z+cD.z*0.3*aE;b2[cP].x=cA.x-cD.x*0.3*aE;b2[cP].y=cA.y-cD.y*0.3*aE;b2[cP].z=cA.z-cD.z*0.3*aE;break;default:break}}var cu=0.25;a0=new Array();v=new Array();ct=aq[cN][0];for(var cP=0;cP<bq.length;cP++){a0.push({x:ct.atom[cP].pos.x*cu,y:ct.atom[cP].pos.y*cu,z:ct.atom[cP].pos.z*cu});v.push({x:0,y:0,z:0})}bJ=new Array();ct=aq[cN][cR];for(var cP=0;cP<bq.length;cP++){bJ.push({x:ct.atom[cP].pos.x*cu,y:ct.atom[cP].pos.y*cu,z:ct.atom[cP].pos.z*cu})}Q=new Array;ad=new Array();bF=new Array();var cI,cK,cx,cw,cT,cS;var cC={x:0,y:0,z:0};var cp={x:0,y:0,z:0};var cn={x:0,y:0,z:0};var cm={x:0,y:0,z:0};var cV={x:0,y:0,z:0};var cU={x:0,y:0,z:0};var cr=at*Math.cos(aG);var cv=at*Math.sin(aG);if(ct.apit!=null){for(var cP=0;cP<ct.apit.length;cP++){Ma=ct.apit[cP];cm.x=(ct.atom[Ma.p1].pos.x+ct.atom[Ma.p2].pos.x)/2;cm.y=(ct.atom[Ma.p1].pos.y+ct.atom[Ma.p2].pos.y)/2;cm.z=(ct.atom[Ma.p1].pos.z+ct.atom[Ma.p2].pos.z)/2;if(cm.x==0&&cm.y==0&&cm.z==0){cm=aB(bR,90,cP*360/ct.apit.length)}cn.x=ct.atom[Ma.p1].pos.x;cn.y=ct.atom[Ma.p1].pos.y;cn.z=ct.atom[Ma.p1].pos.z;cs=(cn.x-cp.x);cq=(cn.y-cp.y);co=(cn.z-cp.z);cK=((cm.x-cp.x)*cs+(cm.y-cp.y)*cq+(cm.z-cp.z)*co)/(cs*cs+cq*cq+co*co);cC.x=cp.x+cK*(cn.x-cp.x);cC.y=cp.y+cK*(cn.y-cp.y);cC.z=cp.z+cK*(cn.z-cp.z);cs=cm.x-cC.x;cq=cm.y-cC.y;co=cm.z-cC.z;cQ=Math.sqrt(cs*cs+cq*cq+co*co);cT={x:cs/cQ,y:cq/cQ,z:co/cQ};cs=ct.atom[Ma.p1].pos.x;cq=ct.atom[Ma.p1].pos.y;co=ct.atom[Ma.p1].pos.z;cQ=Math.sqrt(cs*cs+cq*cq+co*co);cx={x:cs/cQ,y:cq/cQ,z:co/cQ};cV.x=aJ[Ma.p1].x+cr*cx.x+cv*cT.x;cV.y=aJ[Ma.p1].y+cr*cx.y+cv*cT.y;cV.z=aJ[Ma.p1].z+cr*cx.z+cv*cT.z;cn.x=ct.atom[Ma.p2].pos.x;cn.y=ct.atom[Ma.p2].pos.y;cn.z=ct.atom[Ma.p2].pos.z;cs=(cn.x-cp.x);cq=(cn.y-cp.y);co=(cn.z-cp.z);cK=((cm.x-cp.x)*cs+(cm.y-cp.y)*cq+(cm.z-cp.z)*co)/(cs*cs+cq*cq+co*co);cC.x=cp.x+cK*(cn.x-cp.x);cC.y=cp.y+cK*(cn.y-cp.y);cC.z=cp.z+cK*(cn.z-cp.z);cs=cm.x-cC.x;cq=cm.y-cC.y;co=cm.z-cC.z;cQ=Math.sqrt(cs*cs+cq*cq+co*co);cT={x:cs/cQ,y:cq/cQ,z:co/cQ};cs=ct.atom[Ma.p2].pos.x;cq=ct.atom[Ma.p2].pos.y;co=ct.atom[Ma.p2].pos.z;cQ=Math.sqrt(cs*cs+cq*cq+co*co);cx={x:cs/cQ,y:cq/cQ,z:co/cQ};cU.x=aJ[Ma.p2].x+cr*cx.x+cv*cT.x;cU.y=aJ[Ma.p2].y+cr*cx.y+cv*cT.y;cU.z=aJ[Ma.p2].z+cr*cx.z+cv*cT.z;ad.push({x:cV.x,y:cV.y,z:cV.z});bF.push({x:0,y:0,z:0});ad.push({x:cU.x,y:cU.y,z:cU.z});bF.push({x:0,y:0,z:0});cs=cm.x;cq=cm.y;co=cm.z;cQ=Math.sqrt(cs*cs+cq*cq+co*co);cK={x:cs/cQ,y:cq/cQ,z:co/cQ};ad.push({x:0.75*bR*cK.x,y:0.75*bR*cK.y,z:0.75*bR*cK.z});bF.push({x:0,y:0,z:0});cI=aP(cV,cU);Q.push({p1:ad.length-3,p2:ad.length-2,pm:ad.length-1,ang:cI,label:Ma.label})}}}function aB(co,cm,cn){var cl=cm*B;var cp=cn*B;return{x:co*Math.sin(cl)*Math.cos(cp),y:co*Math.sin(cl)*Math.sin(cp),z:co*Math.cos(cl)}}function h(cl,co,cm){var cn=ba.vectorBetween(cl,co);return{x:cl.x+cm*cn.Ax,y:cl.y+cm*cn.Ay,z:cl.z+cm*cn.Az}}Array.prototype.insert=function(cl,cm){this.splice(cl,0,cm)};function I(cw,cn,cq,co){var cA=90;cn.clearRect(cq-cA/2,co-cA/2,cA,cA);if(n&&ag>=0){var cz;var cm;var cs=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}];cw.RotateByMatrix(bJ,v,O);var cy=cw.Convert(v[0].x,v[0].y,v[0].z);var cv=bg[ag];var cp=cv.sides;var cl,cr;var cB;var cx;cn.lineCap="round";cn.lineJoin="round";cn.lineWidth=0.5;cn.strokeStyle="#505050";cn.fillStyle="rgba(255,255,255,0.1)";for(var cu=0;cu<cp.length;cu++){cl=cp[cu];cs[0].x=v[cl[0]].x;cs[0].y=v[cl[0]].y;cs[0].z=v[cl[0]].z;cs[1].x=v[cl[1]].x;cs[1].y=v[cl[1]].y;cs[1].z=v[cl[1]].z;cs[2].x=v[cl[2]].x;cs[2].y=v[cl[2]].y;cs[2].z=v[cl[2]].z;cm=cw.Visible2(cs);if(!cm.appear){cx=true;for(var ct=0;ct<cl.length;ct++){cr=cl[ct];if(bq[cr].type==aZ.BEBAS){cx=false;break}}if(cx){cn.beginPath();for(var ct=0;ct<cl.length;ct++){cr=cl[ct];cz=cw.Convert(v[cr].x,v[cr].y,v[cr].z);if(ct==0){cn.moveTo(cq+cz.x,co+cz.y)}else{cn.lineTo(cq+cz.x,co+cz.y)}}vr=Math.round(255*(cm.angle)/180);cn.fillStyle="rgba("+vr+","+vr+","+vr+",0.15)";cn.fill();cn.closePath();cn.stroke()}}}cn.fillStyle="#ffffff";for(var cu=1;cu<v.length;cu++){if(bq[cu].type==aZ.TERIKAT){cz=cw.Convert(v[cu].x,v[cu].y,v[cu].z);if(cz.s<cy.s){cn.beginPath();cn.arc(cq+cz.x,co+cz.y,3,0,2*Math.PI,false);cn.fill()}}}cn.lineWidth=1;cn.strokeStyle="#880000";for(var cu=1;cu<v.length;cu++){cn.beginPath();cn.moveTo(cq+cy.x,co+cy.y);cz=cw.Convert(v[cu].x,v[cu].y,v[cu].z);cn.lineTo(cq+cz.x,co+cz.y);if(bq[cu].type==aZ.BEBAS){}else{cn.lineWidth=2;cn.strokeStyle="#ffffff";cn.stroke()}}cn.beginPath();cn.arc(cq+cy.x,co+cy.y,4,2*Math.PI,false);cn.fillStyle="#bb0000";cn.fill();cn.lineWidth=0.5;cn.strokeStyle="#909090";for(var cu=0;cu<cp.length;cu++){cl=cp[cu];cs[0].x=v[cl[0]].x;cs[0].y=v[cl[0]].y;cs[0].z=v[cl[0]].z;cs[1].x=v[cl[1]].x;cs[1].y=v[cl[1]].y;cs[1].z=v[cl[1]].z;cs[2].x=v[cl[2]].x;cs[2].y=v[cl[2]].y;cs[2].z=v[cl[2]].z;cm=cw.Visible2(cs);if(cm.appear){cx=true;for(var ct=0;ct<cl.length;ct++){cr=cl[ct];if(bq[cr].type==aZ.BEBAS){cx=false;break}}if(cx){cn.beginPath();for(var ct=0;ct<cl.length;ct++){cr=cl[ct];cz=cw.Convert(v[cr].x,v[cr].y,v[cr].z);if(ct==0){cn.moveTo(cq+cz.x,co+cz.y)}else{cn.lineTo(cq+cz.x,co+cz.y)}}cn.closePath();vr=Math.round(255*(cm.angle)/180);cn.fillStyle="rgba("+vr+","+vr+","+vr+",0.5)";cn.fill();cn.stroke()}}}cn.fillStyle="#ffffff";for(var cu=1;cu<v.length;cu++){if(bq[cu].type==aZ.TERIKAT){cz=cw.Convert(v[cu].x,v[cu].y,v[cu].z);if(cz.s>=cy.s){cn.beginPath();cn.arc(cq+cz.x,co+cz.y,3,0,2*Math.PI,false);cn.fill()}}}}}function bX(cw,cn,cq,co){var cz=90;cn.clearRect(cq-cz/2,co-cz/2,cz,cz);if(o&&ag>=0){var cy;var cm,cA;var cs=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}];cw.RotateByMatrix(a0,v,O);var cv=bg[ag];var cp=cv.sides;var cl,cr;cn.lineCap="round";cn.lineJoin="round";cn.lineWidth=1;cn.strokeStyle="#303030";for(var cu=0;cu<cp.length;cu++){cl=cp[cu];cs[0].x=v[cl[0]].x;cs[0].y=v[cl[0]].y;cs[0].z=v[cl[0]].z;cs[1].x=v[cl[1]].x;cs[1].y=v[cl[1]].y;cs[1].z=v[cl[1]].z;cs[2].x=v[cl[2]].x;cs[2].y=v[cl[2]].y;cs[2].z=v[cl[2]].z;cm=cw.Visible2(cs);if(!cm.appear){cn.beginPath();for(var ct=0;ct<cl.length;ct++){cr=cl[ct];cy=cw.Convert(v[cr].x,v[cr].y,v[cr].z);if(ct==0){cn.moveTo(cq+cy.x,co+cy.y)}else{cn.lineTo(cq+cy.x,co+cy.y)}}cn.closePath();cn.stroke()}}var cx=cw.Convert(v[0].x,v[0].y,v[0].z);cn.beginPath();for(var cu=1;cu<v.length;cu++){cn.moveTo(cq+cx.x,co+cx.y);cy=cw.Convert(v[cu].x,v[cu].y,v[cu].z);cn.lineTo(cq+cy.x,co+cy.y)}cn.lineWidth=1;cn.strokeStyle="#880000";cn.stroke();cn.beginPath();cn.arc(cq+cx.x,co+cx.y,4,2*Math.PI,false);cn.fillStyle="#880000";cn.fill();cn.lineWidth=1;cn.strokeStyle="#b0b0b0";for(var cu=0;cu<cp.length;cu++){cl=cp[cu];cs[0].x=v[cl[0]].x;cs[0].y=v[cl[0]].y;cs[0].z=v[cl[0]].z;cs[1].x=v[cl[1]].x;cs[1].y=v[cl[1]].y;cs[1].z=v[cl[1]].z;cs[2].x=v[cl[2]].x;cs[2].y=v[cl[2]].y;cs[2].z=v[cl[2]].z;cm=cw.Visible2(cs);if(cm.appear){cn.beginPath();for(var ct=0;ct<cl.length;ct++){cr=cl[ct];cy=cw.Convert(v[cr].x,v[cr].y,v[cr].z);if(ct==0){cn.moveTo(cq+cy.x,co+cy.y)}else{cn.lineTo(cq+cy.x,co+cy.y)}}cn.closePath();cA=Math.round(255*(cm.angle)/180);cn.fillStyle="rgba("+cA+","+cA+","+cA+",0.6)";cn.fill();cn.stroke()}}}}function bB(cK,co,cr,cq,ct){co.clearRect(cr-bQ/2,cq-aw/2,bQ,aw);var cJ,cC,cs,cx;var cI;var cn,cm;var cz;cK.RotateByMatrix(Y,F,O);cK.RotateByMatrix(bC,ch,O);cK.RotateByMatrix(b4,u,O);cK.RotateByMatrix(bA,bY,O);cK.RotateByMatrix(b2,b,O);cK.RotateByMatrix(aJ,stickAR,O);cK.RotateByMatrix(ad,bF,O);cC=cK.Convert(F[0].x,F[0].y,F[0].z);var cv=new Array();for(var cG=0;cG<F.length;cG++){cv.push({index:cG,pos:{x:F[cG].x,y:F[cG].y,z:F[cG].z},type:bq[cG].type})}for(var cG=0;cG<F.length;cG++){if(bq[cG].type==aZ.TERIKAT){cv.push({index:cG,pos:{x:ch[cG].x,y:ch[cG].y,z:ch[cG].z},type:aZ.STICK})}}for(var cG=0;cG<Q.length;cG++){cv.push({index:cG,pos:{x:bF[Q[cG].pm].x,y:bF[Q[cG].pm].y,z:bF[Q[cG].pm].z},type:aZ.APIT,p1:Q[cG].p1,p2:Q[cG].p2,ang:Q[cG].ang,pm:Q[cG].pm,label:Q[cG].label})}var cO=cK.sortVerticesPos(cv);var cE,cD,cN,cu;var cp;var cy,cw,cM,cL;var cH;var cA;var cG=0;while(cG<cO.length){cE=cO[cG].index;cN=cv[cE].index;if(cv[cE].type==aZ.STICK){if(cG<cO.length-1){for(var cF=cG+1;cF<cO.length;cF++){cE=cO[cF].index;cu=cv[cE].index;if(cN==cu&&cv[cE].type==aZ.TERIKAT){cJ=cK.Convert(F[cu].x,F[cu].y,F[cu].z);if((cJ.s/cC.s)<1.1){cx=cK.Convert(ch[cu].x,ch[cu].y,ch[cu].z);cp=z(cK,cr,cq,bY[cu],b[cu],b[cu],at);cA=bz(F[cu],bY[cu],aE);cs=cK.Convert(cA.x,cA.y,cA.z);cy=cs.x-cx.x;cw=cs.y-cx.y;cM=Math.sqrt(cy*cy+cw*cw);cs=cK.Convert(cp.x,cp.y,cp.z);cy=cs.x-cx.x;cw=cs.y-cx.y;cL=Math.sqrt(cy*cy+cw*cw);cH=(cM<=cL);if(cH){cO.splice(cF+1,0,{index:cO[cG].index,depth:cO[cG].depth});cO.splice(cG,1);cG--;break}}}}}}cG++}var cG=0;var cB;while(cG<cO.length){cE=cO[cG].index;cN=cv[cE].index;if(cv[cE].type==aZ.STICK||cv[cE].type==aZ.BEBAS){cB=(cv[cE].type==aZ.STICK)?at:bj;if(cG<cO.length-1){for(var cF=cG+1;cF<cO.length;cF++){cE=cO[cF].index;if(cv[cE].type==aZ.PUSAT){cu=cv[cE].index;cA=bz(F[cu],F[cN],aM);cp=z(cK,cr,cq,ch[cN],u[cN],ch[cN],cB);cs=cK.Convert(cA.x,cA.y,cA.z);cy=cs.x-cC.x;cw=cs.y-cC.y;cM=Math.sqrt(cy*cy+cw*cw);cs=cK.Convert(cp.x,cp.y,cp.z);cy=cs.x-cC.x;cw=cs.y-cC.y;cL=Math.sqrt(cy*cy+cw*cw);cJ=cK.Convert(F[cu].x,F[cu].y,F[cu].z);if(cJ.s<=cC.s){cH=(cM<=cL);if(!cH){cO.splice(cF+1,0,{index:cO[cG].index,depth:cO[cG].depth});cO.splice(cG,1);cG--;break}}}}}}cG++}var cl;for(var cG=0;cG<cO.length;cG++){cE=cO[cG].index;cD=cv[cE].index;switch(cv[cE].type){case aZ.PUSAT:cJ=cK.Convert(F[0].x,F[0].y,F[0].z);bM(co,cr+cJ.x,cq+cJ.y,aM*cJ.s,aK[ct]);break;case aZ.TERIKAT:cJ=cK.Convert(F[cD].x,F[cD].y,F[cD].z);bM(co,cr+cJ.x,cq+cJ.y,aE*cJ.s,G[ct]);break;case aZ.STICK:ck(cK,co,cr,cq,ch[cD],u[cD],aK[ct]);ck(cK,co,cr,cq,bY[cD],b[cD],G[ct]);break;case aZ.BEBAS:if(b8){a4(cK,bf,T/2,C/2,co,cr,cq,ch[cD],u[cD],bY[cD],b[cD],bj,aE,a8[ct])}break;case aZ.APIT:if(aO){bh(cK,co,cr,cq,cv[cE],ce[ct],a9[ct])}}}for(var cG=0;cG<bF.length;cG++){cs=cK.Convert(bF[cG].x,bF[cG].y,bF[cG].z)}}function bh(cF,cq,cv,cu,cx,cE,cD){var cw,cm,cn;var ct={x:0,y:0,z:0};var cs={x:0,y:0,z:0};var cr={x:0,y:0,z:0};var cy={x:0,y:0,z:0};var cA=20;var cG;var cz,cH;var cl,cp;var cB;var co=cF.GetScale(0,0,0);cm=cF.GetScale(cx.pos.x,cx.pos.y,cx.pos.z);cG=cx.ang;if(cG>0.8*Math.PI){cB=1.04}else{cB=1}if((cm/co)>cB){cn=Math.min(1,20*((cm/co)-cB));cr.x=bF[cx.pm].x;cr.y=bF[cx.pm].y;cr.z=bF[cx.pm].z;cs.x=bF[cx.p1].x;cs.y=bF[cx.p1].y;cs.z=bF[cx.p1].z;dx=(cs.x-ct.x);dy=(cs.y-ct.y);dz=(cs.z-ct.z);q=((cr.x-ct.x)*dx+(cr.y-ct.y)*dy+(cr.z-ct.z)*dz)/(dx*dx+dy*dy+dz*dz);cy.x=ct.x+q*(cs.x-ct.x);cy.y=ct.y+q*(cs.y-ct.y);cy.z=ct.z+q*(cs.z-ct.z);dx=cr.x-cy.x;dy=cr.y-cy.y;dz=cr.z-cy.z;d=Math.sqrt(dx*dx+dy*dy+dz*dz);v1={x:dx/d,y:dy/d,z:dz/d};dx=(cs.x-ct.x);dy=(cs.y-ct.y);dz=(cs.z-ct.z);d=Math.sqrt(dx*dx+dy*dy+dz*dz);u1={x:dx/d,y:dy/d,z:dz/d};cz=2*A*Math.sin(0.5*cG/cA);cH=0.5*(Math.PI-cG/cA);cH=2*(aG-cH);cp=cz*Math.cos(cH);cl=cz*Math.sin(cH);cq.beginPath();cy.x=cs.x;cy.y=cs.y;cy.z=cs.z;cw=cF.Convert(cy.x,cy.y,cy.z);cq.moveTo(cv+cw.x,cu+cw.y);for(var cC=0;cC<=cA;cC++){cp=cz*Math.cos(aG+cC*cH);cl=cz*Math.sin(aG+cC*cH);cy.x+=cp*u1.x+cl*v1.x;cy.y+=cp*u1.y+cl*v1.y;cy.z+=cp*u1.z+cl*v1.z;cw=cF.Convert(cy.x,cy.y,cy.z);cq.lineTo(cv+cw.x,cu+cw.y)}cq.lineWidth=2;cq.strokeStyle="rgba("+cE.r+","+cE.g+","+cE.b+","+cn+")";cq.stroke();cq.font=AdaptiveFontSize.fix("14pt serif");cq.textBaseline="middle";cq.textAlign="center";cq.fillStyle="rgba("+cD.r+","+cD.g+","+cD.b+","+cn+")";cw=cF.Convert(bF[cx.pm].x,bF[cx.pm].y,bF[cx.pm].z);cq.fillText(cx.label,cv+cw.x,cu+cw.y)}}function bz(cr,cs,cn){var cp=cs.x-cr.x;var co=cs.y-cr.y;var cm=cs.z-cr.z;d=Math.sqrt(cp*cp+co*co+cm*cm);var cq={x:cp/d,y:co/d,z:cm/d};var cl={x:0,y:0,z:0};cl.x=cr.x+cn*cq.x;cl.y=cr.y+cn*cq.y;cl.z=cr.z+cn*cq.z;return cl}function z(cK,cr,cq,cF,cE,cI,cL){var co={x:(cF.x+cE.x)/2+10,y:(cF.y+cE.y)/2+10,z:(cF.z+cE.z)/2+10};var cy,cx,cw,cJ;cy=cF.x-co.x;cx=cF.y-co.y;cw=cF.z-co.z;cJ=Math.sqrt(cy*cy+cx*cx+cw*cw);var cA={x:-cy/cJ,y:-cx/cJ,z:-cw/cJ};cy=cF.x-cE.x;cx=cF.y-cE.y;cw=cF.z-cE.z;cJ=Math.sqrt(cy*cy+cx*cx+cw*cw);var cz={x:cy/cJ,y:cx/cJ,z:cw/cJ};var cv={x:cA.y*cz.z-cA.z*cz.y,y:cA.z*cz.x-cA.x*cz.z,z:cA.x*cz.y-cA.y*cz.x};cJ=Math.sqrt(cv.x*cv.x+cv.y*cv.y+cv.z*cv.z);cv.x/=cJ;cv.y/=cJ;cv.z/=cJ;var cu={x:cv.y*cz.z-cv.z*cz.y,y:cv.z*cz.x-cv.x*cz.z,z:cv.x*cz.y-cv.y*cz.x};cJ=Math.sqrt(cu.x*cu.x+cu.y*cu.y+cu.z*cu.z);cu.x/=cJ;cu.y/=cJ;cu.z/=cJ;var cC,cn,cm;var cs;var cD=8;var cG;var ct={x:0,y:0,z:0};var cl;var cp=-9999;var cH={x:0,y:0,z:0};for(var cB=0;cB<360;cB+=cD){cC=cB*B;cn=Math.cos(cC);cm=Math.sin(cC);ct.x=cI.x+cL*cn*cv.x+cL*cm*cu.x;ct.y=cI.y+cL*cn*cv.y+cL*cm*cu.y;ct.z=cI.z+cL*cn*cv.z+cL*cm*cu.z;cs=cK.Convert(ct.x,ct.y,ct.z);cl=cK.GetScale(ct.x,ct.y,ct.z);if(cl>cp){cp=cl;cH.x=ct.x;cH.y=ct.y;cH.z=ct.z}}return cH}function ck(cK,co,cq,cp,cH,cG,cF){var cn={x:(cH.x+cG.x)/2+10,y:(cH.y+cG.y)/2+10,z:(cH.z+cG.z)/2+10};var cx,cw,cv,cJ;cx=cH.x-cn.x;cw=cH.y-cn.y;cv=cH.z-cn.z;cJ=Math.sqrt(cx*cx+cw*cw+cv*cv);var cz={x:-cx/cJ,y:-cw/cJ,z:-cv/cJ};cx=cH.x-cG.x;cw=cH.y-cG.y;cv=cH.z-cG.z;cJ=Math.sqrt(cx*cx+cw*cw+cv*cv);var cy={x:cx/cJ,y:cw/cJ,z:cv/cJ};var cu={x:cz.y*cy.z-cz.z*cy.y,y:cz.z*cy.x-cz.x*cy.z,z:cz.x*cy.y-cz.y*cy.x};cJ=Math.sqrt(cu.x*cu.x+cu.y*cu.y+cu.z*cu.z);cu.x/=cJ;cu.y/=cJ;cu.z/=cJ;var ct={x:cu.y*cy.z-cu.z*cy.y,y:cu.z*cy.x-cu.x*cy.z,z:cu.x*cy.y-cu.y*cy.x};cJ=Math.sqrt(ct.x*ct.x+ct.y*ct.y+ct.z*ct.z);ct.x/=cJ;ct.y/=cJ;ct.z/=cJ;var cB,cm,cl;var cr;co.lineWidth=1;co.lineCap="round";co.strokeStyle="#000000";var cD=8;var cI;var cE,cL;var cs=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}];var cC;for(var cA=0;cA<360;cA+=cD){cB=cA*B;cI=((cA+cD+3)%360)*B;cm=Math.cos(cB);cl=Math.sin(cB);cE=Math.cos(cI);cL=Math.sin(cI);cs[0].x=cH.x+at*cm*cu.x+at*cl*ct.x;cs[0].y=cH.y+at*cm*cu.y+at*cl*ct.y;cs[0].z=cH.z+at*cm*cu.z+at*cl*ct.z;cs[1].x=cH.x+at*cE*cu.x+at*cL*ct.x;cs[1].y=cH.y+at*cE*cu.y+at*cL*ct.y;cs[1].z=cH.z+at*cE*cu.z+at*cL*ct.z;cs[2].x=cG.x+at*cE*cu.x+at*cL*ct.x;cs[2].y=cG.y+at*cE*cu.y+at*cL*ct.y;cs[2].z=cG.z+at*cE*cu.z+at*cL*ct.z;cs[3].x=cG.x+at*cm*cu.x+at*cl*ct.x;cs[3].y=cG.y+at*cm*cu.y+at*cl*ct.y;cs[3].z=cG.z+at*cm*cu.z+at*cl*ct.z;cC=cK.Visible2(cs);if(cC.appear){co.beginPath();cr=cK.Convert(cs[0].x,cs[0].y,cs[0].z);co.moveTo(cq+cr.x,cp+cr.y);cr=cK.Convert(cs[1].x,cs[1].y,cs[1].z);co.lineTo(cq+cr.x,cp+cr.y);cr=cK.Convert(cs[2].x,cs[2].y,cs[2].z);co.lineTo(cq+cr.x,cp+cr.y);cr=cK.Convert(cs[3].x,cs[3].y,cs[3].z);co.lineTo(cq+cr.x,cp+cr.y);co.closePath();vr=(cC.angle)/180;co.fillStyle="rgb("+Math.round(vr*cF.r)+","+Math.round(vr*cF.g)+","+Math.round(vr*cF.b)+")";co.fill()}}}function a4(cO,c8,cI,cH,cv,cT,cG,cu,ct,c3,c2,cW,cw,cJ){c8.clearRect(0,0,T,C);var cr=cO.distanceBetween(cu,ct);var cA=cW;var cz=0.2*cw;var cC=cw-cz;var c0={x:(cu.x+ct.x)/2+10,y:(cu.y+ct.y)/2+10,z:(cu.z+ct.z)/2+10};var cp,cn,cl,c5;var cY;cp=cu.x-ct.x;cn=cu.y-ct.y;cl=cu.z-ct.z;c5=Math.sqrt(cp*cp+cn*cn+cl*cl);var cR={x:-cp/c5,y:-cn/c5,z:-cl/c5};cp=cu.x-c0.x;cn=cu.y-c0.y;cl=cu.z-c0.z;c5=Math.sqrt(cp*cp+cn*cn+cl*cl);var cU={x:-cp/c5,y:-cn/c5,z:-cl/c5};cp=cu.x-ct.x;cn=cu.y-ct.y;cl=cu.z-ct.z;c5=Math.sqrt(cp*cp+cn*cn+cl*cl);var cS={x:cp/c5,y:cn/c5,z:cl/c5};var cP={x:cU.y*cS.z-cU.z*cS.y,y:cU.z*cS.x-cU.x*cS.z,z:cU.x*cS.y-cU.y*cS.x};c5=Math.sqrt(cP.x*cP.x+cP.y*cP.y+cP.z*cP.z);cP.x/=c5;cP.y/=c5;cP.z/=c5;var cN={x:cP.y*cS.z-cP.z*cS.y,y:cP.z*cS.x-cP.x*cS.z,z:cP.x*cS.y-cP.y*cS.x};c5=Math.sqrt(cN.x*cN.x+cN.y*cN.y+cN.z*cN.z);cN.x/=c5;cN.y/=c5;cN.z/=c5;cY=cw/5;var co=cO.Convert(c3.x,c3.y,c3.z);var cm=cO.Convert(c2.x,c2.y,c2.z);if(co.s<cm.s){bM(cv,cT+co.x,cG+co.y,cY*co.s,{r:255,g:255,b:255});bM(cv,cT+cm.x,cG+cm.y,cY*cm.s,{r:255,g:255,b:255})}else{bM(cv,cT+cm.x,cG+cm.y,cY*cm.s,{r:255,g:255,b:255});bM(cv,cT+co.x,cG+co.y,cY*co.s,{r:255,g:255,b:255})}var cX,cq,cx;var cM;var cs=8;var cD;var cF,cE;var cK=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}];var c1;var c4,cL,cQ;var cZ={x:0,y:0,z:0};var cB={x:0,y:0,z:0};var cy=4;var c7;c7=-(cw-cA)/((cr-cC)*(cr-cC));for(var c6=0;c6<=cr;c6+=cy){c4=c6;if(c6<=(cr-cC)){cY=cA+c7*Math.pow((c4-(cr-cC)),2)+(cw-cA)}else{cY=cz+Math.sqrt(cC*cC-Math.pow(c4-(cr-cC),2))}cZ.x=cu.x+cR.x*c4;cZ.y=cu.y+cR.y*c4;cZ.z=cu.z+cR.z*c4;c4=Math.min((c6+cy+1),cr);if(c4<=(cr-cC)){cQ=cA+c7*Math.pow((c4-(cr-cC)),2)+(cw-cA)}else{cQ=cz+Math.sqrt(cC*cC-Math.pow(c4-(cr-cC),2))}cB.x=cu.x+cR.x*c4;cB.y=cu.y+cR.y*c4;cB.z=cu.z+cR.z*c4;for(var cV=0;cV<360;cV+=cs){cX=cV*Math.PI/180;cD=((cV+cs+1)%360)*Math.PI/180;cq=Math.cos(cX);cx=Math.sin(cX);cF=Math.cos(cD);cE=Math.sin(cD);cK[0].x=cZ.x+cY*cq*cP.x+cY*cx*cN.x;cK[0].y=cZ.y+cY*cq*cP.y+cY*cx*cN.y;cK[0].z=cZ.z+cY*cq*cP.z+cY*cx*cN.z;cK[1].x=cZ.x+cY*cF*cP.x+cY*cE*cN.x;cK[1].y=cZ.y+cY*cF*cP.y+cY*cE*cN.y;cK[1].z=cZ.z+cY*cF*cP.z+cY*cE*cN.z;cK[2].x=cB.x+cQ*cF*cP.x+cQ*cE*cN.x;cK[2].y=cB.y+cQ*cF*cP.y+cQ*cE*cN.y;cK[2].z=cB.z+cQ*cF*cP.z+cQ*cE*cN.z;cK[3].x=cB.x+cQ*cq*cP.x+cQ*cx*cN.x;cK[3].y=cB.y+cQ*cq*cP.y+cQ*cx*cN.y;cK[3].z=cB.z+cQ*cq*cP.z+cQ*cx*cN.z;c1=cO.Visible2(cK);if(c1.appear){c8.beginPath();cM=cO.Convert(cK[0].x,cK[0].y,cK[0].z);c8.moveTo(cI+cM.x,cH+cM.y);cM=cO.Convert(cK[1].x,cK[1].y,cK[1].z);c8.lineTo(cI+cM.x,cH+cM.y);cM=cO.Convert(cK[2].x,cK[2].y,cK[2].z);c8.lineTo(cI+cM.x,cH+cM.y);cM=cO.Convert(cK[3].x,cK[3].y,cK[3].z);c8.lineTo(cI+cM.x,cH+cM.y);c8.closePath();vr=0+1*(c1.angle)/180;c8.fillStyle="rgba("+Math.round(vr*cJ.r)+","+Math.round(vr*cJ.g)+","+Math.round(vr*cJ.b)+",1)";c8.fill()}}}for(var cV=0;cV<360;cV+=cs){cX=cV*Math.PI/180;cD=((cV+cs+2)%360)*Math.PI/180;cq=Math.cos(cX);cx=Math.sin(cX);cF=Math.cos(cD);cE=Math.sin(cD);cK[0].x=cB.x+cQ*cq*cP.x+cQ*cx*cN.x;cK[0].y=cB.y+cQ*cq*cP.y+cQ*cx*cN.y;cK[0].z=cB.z+cQ*cq*cP.z+cQ*cx*cN.z;cK[1].x=cB.x+cQ*cF*cP.x+cQ*cE*cN.x;cK[1].y=cB.y+cQ*cF*cP.y+cQ*cE*cN.y;cK[1].z=cB.z+cQ*cF*cP.z+cQ*cE*cN.z;cK[2].x=ct.x;cK[2].y=ct.y;cK[2].z=ct.z;c1=cO.Visible2(cK);if(c1.appear){c8.beginPath();cM=cO.Convert(cK[0].x,cK[0].y,cK[0].z);c8.moveTo(cI+cM.x,cH+cM.y);cM=cO.Convert(cK[1].x,cK[1].y,cK[1].z);c8.lineTo(cI+cM.x,cH+cM.y);cM=cO.Convert(cK[2].x,cK[2].y,cK[2].z);c8.lineTo(cI+cM.x,cH+cM.y);c8.closePath();vr=0+1*(c1.angle)/180;c8.fillStyle="rgb("+Math.round(vr*cJ.r)+","+Math.round(vr*cJ.g)+","+Math.round(vr*cJ.b)+",1)";c8.fill()}}cv.globalAlpha=0.7;cv.drawImage(c8.canvas,0,0,T,C,cT-T/2,cG-C/2,T,C);cv.globalAlpha=1}CanvasRenderingContext2D.prototype.clearMe=function(){this.clearRect(0,0,this.canvas.width/a7,this.canvas.height/bO)};CanvasRenderingContext2D.prototype.drawShape=function(cm,cl,cn){this.drawImage(M[cm.source],cm.x,cm.y,cm.width,cm.height,cl-cm.ofsX,cn-cm.ofsY,cm.width,cm.height)};var b5=false;var bI=false;var am;function aU(cl){if(!cl){var cl=window.event}if(bI){cl.preventDefault();cl.stopPropagation()}else{downMode="mouse";bw(cl,cl.pageX,cl.pageY)}}function bK(cl){if(!cl){var cl=window.event}if(b5||bI){cl.preventDefault();cl.stopPropagation()}else{downMode="touch";var cm=cl.targetTouches[0];am=cm.identifier;bw(cl,cm.pageX,cm.pageY)}}var aT,aR;var aN;var ao={NONE:0,ROTATE:1,SELECTMENU:2};function bw(co,cm,cl){var ct=(cm-b0.x)/a7;var cr=(cl-b0.y)/bO;aT=ct;aR=cr;var cs,cq;aN=ao.NONE;for(var cn=0;cn<b3.length;cn++){if(ct>=b3[cn].x1&&ct<b3[cn].x2&&cr>b3[cn].y1&&cr<b3[cn].y2){if((cn+2)!=aD){aD=cn+2;Z=0;ak(aD,Z);e();bl();k=true}aN=ao.SELECTMENU;break}}if(aN==ao.NONE){for(var cn=0;cn<aL.length;cn++){if(ct>=aL[cn].x1&&ct<aL[cn].x2&&cr>aL[cn].y1&&cr<aL[cn].y2){if(aL[cn].peb!=Z){Z=aL[cn].peb;ak(aD,Z);e();bl();k=true}aN=ao.SELECTMENU;break}}}if(aN==ao.NONE){cs=(cm-a5.x)/a7;cq=(cl-a5.y)/bO;var cp=(downMode=="touch")?10:0;for(var cn=0;cn<ac.length;cn++){if(cs>=ac[cn].x1-cp&&cs<ac[cn].x2+cp&&cq>ac[cn].y1-cp&&cq<ac[cn].y2+cp){switch(cn){case 0:o=!o;bl();k=true;break;case 1:n=!n;bl();k=true;break;case 2:b8=!b8;bl();k=true;break;case 3:aO=!aO;bl();k=true;break;case 4:ap=!ap;bl();k=true;break}aN=ao.SELECTMENU;break}}}if(aN==ao.NONE){if(cr>(c-aw/2-50)&&cr<(c+aw/2+50)){b7=false;document.body.style.cursor="pointer";if(downMode=="mouse"){b5=true;document.addEventListener("mouseup",W);document.addEventListener("mousemove",a2)}else{bI=true;document.addEventListener("touchend",l);document.addEventListener("touchmove",bV)}}}}function W(cl){if(!cl){var cl=window.event}cl.preventDefault();cl.stopPropagation();document.body.style.cursor="default";document.removeEventListener("mouseup",W);document.removeEventListener("mousemove",a2);a(cl,(cl.pageX-b0.x)/a7,(cl.pageY-b0.y)/bO);b5=false;aN=ao.PUSAT}function l(cl){if(!cl){var cl=window.event}var cm=cl.changedTouches[0];if(cm.identifier==am){cl.preventDefault();cl.stopPropagation();document.body.style.cursor="default";document.removeEventListener("touchend",l);document.removeEventListener("touchmove",bV);a(cl,(cm.pageX-b0.x)/a7,(cm.pageY-b0.y)/bO);bI=false;aN=ao.PUSAT}}function a(cm,cn,cl){document.body.style.cursor="default"}function a2(cl){if(!cl){var cl=window.event}cl.preventDefault();cl.stopPropagation();bH((cl.pageX-b0.x)/a7,(cl.pageY-b0.y)/bO)}function bV(cl){if(!cl){var cl=window.event}var cm=cl.changedTouches[0];if(cm.identifier==am){cl.preventDefault();cl.stopPropagation();bH((cm.pageX-b0.x)/a7,(cm.pageY-b0.y)/bO)}}function bH(co,cn){var cm=(co-aT)*0.6;var cl=(cn-aR)*0.6;aT=co;aR=cn;cg=0;N=cl;aA=cm;k=true}function bd(co,cn){var cm,cl;cl=1;for(cm=cn+1;cm<=co;cm++){cl=cl*cm}for(cm=1;cm<=co-cn;cm++){cl=Math.floor(cl/cm)}return cl}function ae(co,cp,cn){var cm,cl;cl=bd(cp,co);for(cm=1;cm<=co;cm++){cl=cl*cn}for(cm=1;cm<=cp-co;cm++){cl=cl*(1-cn)}return cl}function p(cn,cr,cp){var co,cm,cl,cq;cl=0;cq=0;for(co=0;co<=cr;co++){cm=ae(co,cr,cn);cl=cl+cp[co].x*cm;cq=cq+cp[co].y*cm}return{x:cl,y:cq}}function bS(cl){var cm=curtop=0;if(cl.offsetParent){do{cm+=cl.offsetLeft;curtop+=cl.offsetTop}while(cl=cl.offsetParent)}return{x:cm,y:curtop}}function E(co){var cn=container.offsetWidth;var cr=container.offsetHeight;var cm,cq;var cl,cs;switch(S){case"":case"default":a7=1;bO=1;cm=bn*a7;cq=aH*bO;cl=(cn-cm)/2;cs=(cr-cq)/2;break;case"auto":a7=Math.min(cn/bn,cr/aH);bO=a7;cm=bn*a7;cq=aH*bO;cl=(cn-cm)/2;cs=(cr-cq)/2;break;case"fit":a7=cn/bn;bO=cr/aH;cm=bn*a7;cq=aH*bO;cl=(cn-cm)/2;cs=(cr-cq)/2;break;case"fitwidth":a7=cn/bn;bO=a7;cm=bn*a7;cq=aH*bO;cl=(cn-cm)/2;cs=(cr-cq)/2;break;case"fitheight":bO=cr/aH;a7=bO;cm=bn*a7;cq=aH*bO;cl=(cn-cm)/2;cs=(cr-cq)/2;break}for(var cp=0;cp<co.length;cp++){co[cp].canvas.width=co[cp].width*a7;co[cp].canvas.height=co[cp].height*bO;co[cp].canvas.getContext("2d").scale(a7,bO);co[cp].canvas.style.position="absolute";co[cp].canvas.style.left=cl+co[cp].x*a7+"px";co[cp].canvas.style.top=cs+co[cp].y*bO+"px"}b0=bS(w);a5=bS(s)}function bT(){var cl=/%/;if(cl.test(container.style.width)||cl.test(container.style.height)){E(canvasList)}b0=bS(w);a5=bS(s);ax()}(function(){function cl(cn,co){co=co||{bubbles:false,cancelable:false,detail:undefined};var cm=document.createEvent("CustomEvent");cm.initCustomEvent(cn,co.bubbles,co.cancelable,co.detail);return cm}cl.prototype=window.Event.prototype;window.CustomEvent=cl})()};