var PesonaBasic=new function(){var i=new Array();var d;var c;var l,k;var j,h;var n,e;var f=0;this.setStageMode=function(q,r,p,s){return m(q,r,p,s)};this.getStage=function(){return{scale:{x:n,y:e},pos:{x:j,y:h},size:{width:l,height:k}}};this.addCanvas=function(u,r,q,p,s){if(q===undefined){q=false}if(p===undefined){p=false}if(s===undefined){s=false}var t=i.push({id:u,attribute:r,canPoint:q,container:null,notAppend:p,willReadFrequently:s})-1;if(r.canvas){r.canvas.setAttribute("id",u)}if(r.div){r.div.setAttribute("id",u)}if(r.container){if(!p){if(r.canvas){r.container.appendChild(r.canvas)}else{if(r.div){r.container.appendChild(r.div)}}}i[t].container=r.container}else{if(!p){if(r.canvas){c.appendChild(r.canvas)}else{if(r.div){c.appendChild(r.div)}}}i[t].container=c}return o(i[t],q,s)};this.removeCanvas=function(r,p){var q=a(r);if(q>=0){if(i[q].attribute.canvas){i[q].container.removeChild(i[q].attribute.canvas)}else{if(i[q].attribute.div){i[q].container.removeChild(i[q].attribute.div)}}if(p){i.splice(q,1)}}};this.append=function(q){var p=a(q);if(p>=0){if(i[p].attribute.canvas){i[p].container.appendChild(i[p].attribute.canvas)}else{if(i[p].attribute.div){i[p].container.appendChild(i[p].attribute.div)}}i[p].notAppend=false;o(i[p],i[p].canPoint,i[p].willReadFrequently)}};this.refreshCanvases=function(){var q=b();for(var p=0;p<i.length;p++){o(i[p],i[p].canPoint,i[p].willReadFrequently)}return q};this.hide=function(q){var p=a(q);if(p>=0){i[p].attribute.visibility="hidden";i[p].attribute.canvas.style.visibility="hidden"}};this.show=function(q){var p=a(q);if(p>=0){i[p].attribute.visibility="visible";i[p].attribute.canvas.style.visibility="visible"}};function a(r){var p=-1;for(var q=0;q<i.length;q++){if(i[q].id==r){p=q;break}}return p}this.changeCanvasPos=function(s,p,r){var q=a(s);if(q>=0){i[q].attribute.x=p;i[q].attribute.y=r;o(i[q],i[q].canPoint,i[q].willReadFrequently)}};this.getAbsolutePosition=function(r){var p;var q=a(r);if(q>=0){p=g(i[q].attribute.canvas)}return p};this.getRealPosition=function(q){var p=a(q);if(p>=0){res=g(i[p].attribute.canvas);res.x=(res.x-j)/n;res.y=(res.y-h)/e}return res};this.getLastIndex=function(){return f};function m(q,r,p,s){d=s;c=q;l=r;k=p;return b()}function b(){var r=c.offsetWidth;var t=c.offsetHeight;var q,s;var p,u;switch(d){case"":case"default":n=1;e=1;q=l*n;s=k*e;p=(r-q)/2;u=(t-s)/2;break;case"auto":n=Math.min(r/l,t/k);e=n;q=l*n;s=k*e;p=(r-q)/2;u=(t-s)/2;break;case"fit":n=r/l;e=t/k;q=l*n;s=k*e;p=(r-q)/2;u=(t-s)/2;break;case"fitwidth":n=r/l;e=n;q=l*n;s=k*e;p=(r-q)/2;u=(t-s)/2;break;case"fitheight":e=t/k;n=e;q=l*n;s=k*e;p=(r-q)/2;u=(t-s)/2;break}j=p;h=u;return{scale:{x:n,y:e},pos:{x:j,y:h}}}function o(r,q,u){var v=r.attribute;if(v.index<0){v.index=f}f=Math.max(f,v.index)+1;if(v.canvas){const t=window.devicePixelRatio||1;if(q){v.canvas.style.pointerEvents="auto"}else{v.canvas.style.pointerEvents="none"}v.canvas.unselectable="on";if(r.notAppend){v.canvas.width=v.width*t;v.canvas.height=v.height*t}else{v.canvas.width=v.width*n*t;v.canvas.height=v.height*e*t;if(v.isWebgl==null&&!v.notAppend){v.canvas.getContext("2d").scale(n*t,e*t)}}v.canvas.style.position="absolute";if(v.relative){if(v.relative){v.canvas.style.left=v.x*n+"px";v.canvas.style.top=v.y*e+"px"}}else{v.canvas.style.left=j+v.x*n+"px";v.canvas.style.top=h+v.y*e+"px"}v.canvas.style.width=v.width*n+"px";v.canvas.style.height=v.height*e+"px";if(v.visibility){v.canvas.style.visibility=v.visibility}if(v.backgroundColor){v.canvas.style.backgroundColor=v.backgroundColor}if(v.borderRadius){if(Array.isArray(v.borderRadius)){var p="";for(var s=0;s<v.borderRadius.length;s++){p+=v.borderRadius[s]*n+"px "}v.canvas.style.borderRadius=p}else{v.canvas.style.borderRadius=v.borderRadius*n+"px"}}if(v.border){v.canvas.style.border=v.border}if(v.shadow){v.canvas.style.boxShadow=v.shadow.x*n+"px "+v.shadow.y*e+"px "+v.shadow.blur*n+"px "+v.shadow.color}v.canvas.style.zIndex=v.index;if(v.isWebgl==null){return v.canvas.getContext("2d",{willReadFrequently:u})}else{return v.canvas.getContext("webgl")}}else{if(v.div){v.div.style.width=v.width*n+"px";v.div.style.height=v.height*e+"px";v.div.style.position="absolute";v.div.style.left=j+v.x*n+"px";v.div.style.top=h+v.y*e+"px";if(v.borderRadius){v.div.style.borderRadius=v.borderRadius*n+"px"}v.div.style.zIndex=v.index;return}}}function g(p){var q=curtop=0;if(p.offsetParent){do{q+=p.offsetLeft;curtop+=p.offsetTop}while(p=p.offsetParent)}return{x:q,y:curtop}}};